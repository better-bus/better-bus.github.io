import{$ as ht,$a as hn,A as e0,Aa as At,B as Ie,Ba as Ea,C as ya,Ca as Bt,D as Fn,Da as Ca,E as t0,Ea as Zt,F as r0,Fa as Wr,G as n0,Ga as Dn,Ha as u0,I as G,Ia as h0,J as ci,Ja as Me,K as Lr,Ka as yt,L as li,La as di,M as An,Ma as qt,N as Ns,Na as Ze,O as Sa,Oa as d0,P as a0,Pa as pi,Q as Ke,Qa as p0,R as fi,S as i0,Sa as m0,T as s0,Ta as mi,U as un,Ua as ra,V as Kt,Va as x0,W as tt,Wa as g0,X as rt,Xa as _0,Y as ea,Ya as xi,Z as ui,Za as gi,_ as ut,_a as _i,a as Ae,aa as We,ab as Lt,b as Qe,ba as M,bb as v0,c as oi,ca as L,cb as w0,d as Kn,da as dt,db as y0,e as ur,ea as Cr,eb as S0,f as Zo,fa as Ur,fb as na,g as Cn,ga as gt,gb as k0,h as fn,ha as o0,hb as vi,i as Tn,ia as Se,ib as E0,j as Os,ja as c0,jb as C0,k as Zn,ka as Q,kb as Dt,l as qn,la as ka,lb as dn,m as bn,ma as Is,mb as Tr,n as qo,na as ta,nb as br,o as Je,oa as Ms,ob as jr,p as Jn,pa as Y,pb as $r,q as Ps,qa as vt,qb as Fr,r as ce,ra as Ve,rb as Yr,s as Jo,sa as hi,sb as wi,t as Qn,ta as l0,tb as yi,u as Qo,ua as f0,ub as Si,v as pe,va as it,vb as ki,w as me,wa as st,wb as T0,x as Mr,xa as ot,xb as b0,y as gr,ya as Qr,yb as Kr,z as Br,za as _r,zb as Ar}from"./chunk-4LWO4URV.js";var nu=e=>["/plans",e,"name"],au=e=>["/plans",e,"seating"];function iu(e,r){e&1&&(M(0,"p"),Y(1),L()),e&2&&(G(),vt(r))}function su(e,r){e&1&&(M(0,"div"),Y(1),L()),e&2&&(G(),Ve("Bus #: ",r.number))}function ou(e,r){if(e&1&&(M(0,"div"),Y(1),L()),e&2){let t=Q();G(),Ve("",t.plan().stops.length," stops")}}function cu(e,r){e&1&&(M(0,"div"),Y(1),L()),e&2&&(G(),Ve("",r.length," students"))}function lu(e,r){if(e&1&&(M(0,"button",0),dt(1,"i",2),Y(2," Seats "),L()),e&2){let t=Q();We("routerLink",Ca(1,au,t.plan().id))}}var Ei=class e{plan=qt.required();static \u0275fac=function(t){return new(t||e)};static \u0275cmp=Ke({type:e,selectors:[["app-transportation-plan-card"]],inputs:{plan:[1,"plan"]},decls:12,vars:12,consts:[[3,"routerLink"],[1,"actions"],[1,"fas","fa-chair"]],template:function(t,n){if(t&1&&(M(0,"article",0)(1,"h2"),Y(2),L(),tt(3,iu,2,1,"p"),tt(4,su,2,1,"div"),tt(5,ou,2,1,"div"),tt(6,cu,2,1,"div"),M(7,"div"),Y(8),Zt(9,"date"),L(),M(10,"div",1),tt(11,lu,3,3,"button",0),L()()),t&2){let a,i,s;We("routerLink",Ca(10,nu,n.plan().id)),G(2),vt(n.plan().name||"(Untitled Plan)"),G(),rt((a=n.plan().description)?3:-1,a),G(),rt((i=n.plan().bus)?4:-1,i),G(),rt(n.plan().stops.length?5:-1),G(),rt((s=n.plan().students)?6:-1,s),G(2),Ve("Last Updated: ",Wr(9,8,n.plan().updatedAt)),G(3),rt(n.plan().seatAssignments.length?-1:11)}},dependencies:[Lt,ra],styles:["article[_ngcontent-%COMP%]{cursor:pointer}article[_ngcontent-%COMP%]:hover{background:#f9f9f9}.actions[_ngcontent-%COMP%]{display:flex;flex-direction:row;gap:.5rem}"]})};var fu=(e,r)=>r.id;function uu(e,r){if(e&1&&dt(0,"app-transportation-plan-card",1),e&2){let t=r.$implicit;We("plan",t)}}function hu(e,r){e&1&&(M(0,"div"),Y(1,"No transportation plans found."),L())}var Ci=class e{plans=qt.required();static \u0275fac=function(t){return new(t||e)};static \u0275cmp=Ke({type:e,selectors:[["app-transportation-plan-list"]],inputs:{plans:[1,"plans"]},decls:4,vars:1,consts:[[1,"plan-list"],[3,"plan"]],template:function(t,n){t&1&&(M(0,"div",0),ut(1,uu,1,1,"app-transportation-plan-card",1,fu,!1,hu,2,0,"div"),L()),t&2&&(G(),ht(n.plans()))},dependencies:[Ei],encapsulation:2})};var Ti=class e{planService=ce(Dt);router=ce(hn);plans=Me(()=>[...this.planService.plans()].sort((r,t)=>(r.name||"").localeCompare(t.name||"")));createNewPlan(){let r=this.planService.createNewPlan({});this.planService.addPlan(r),this.router.navigate([`/plans/${r.id}/school`])}static \u0275fac=function(t){return new(t||e)};static \u0275cmp=Ke({type:e,selectors:[["app-transportation-plan-page"]],decls:6,vars:1,consts:[[1,"transportation-plan-page"],[3,"click"],[3,"plans"]],template:function(t,n){t&1&&(M(0,"div",0)(1,"h1"),Y(2,"Transportation Plans"),L(),M(3,"button",1),Se("click",function(){return n.createNewPlan()}),Y(4,"Create New Plan"),L(),dt(5,"app-transportation-plan-list",2),L()),t&2&&(G(5),We("plans",n.plans()))},dependencies:[Ci],encapsulation:2})};var du=e=>[e],pu=(e,r)=>r.path;function mu(e,r){if(e&1&&(M(0,"a",2),Y(1),Zt(2,"titlecase"),L()),e&2){let t=r.$implicit;We("routerLink",Ca(4,du,t.path)),G(),vt(Wr(2,2,(t.data==null?null:t.data.displayName)??t.path))}}var bi=class e{planService=ce(Dt);route=ce(xi);childPages=Bs.children.filter(r=>r.component);plan=Me(()=>{let r=this.route.snapshot.paramMap.get("id");return this.planService.plans().find(t=>t.id===r)});static \u0275fac=function(t){return new(t||e)};static \u0275cmp=Ke({type:e,selectors:[["app-transportation-plan-wizard"]],decls:6,vars:0,consts:[[1,"wizard"],[1,"wizard-nav","screen-only"],["routerLinkActive","active",1,"nav-btn",3,"routerLink"]],template:function(t,n){t&1&&(M(0,"div",0)(1,"nav",1),ut(2,mu,3,6,"a",2,pu),L(),M(4,"article"),dt(5,"router-outlet"),L()()),t&2&&(G(2),ht(n.childPages))},dependencies:[Lt,v0,gi,mi],encapsulation:2})};var F0="schools",Fi=class e{persistence=ce(vi);loaded=!1;schools=Ie([]);constructor(){this.load(),yt(()=>{let r=this.schools();this.loaded&&this.persistence.saveData(F0,r)})}async load(){this.loaded=!1;let r=await this.persistence.getData(F0);this.schools.set(r??[]),await new Promise(t=>setTimeout(t)),this.loaded=!0}addSchool(r){this.schools.update(t=>[...t,Qe(Ae({},r),{id:na()})])}updateSchool(r){this.schools.update(t=>t.map(n=>n.id===r.id?r:n))}deleteSchool(r){this.schools.update(t=>t.filter(n=>n.id!==r))}static \u0275fac=function(t){return new(t||e)};static \u0275prov=Je({token:e,factory:e.\u0275fac,providedIn:"root"})};var xu=()=>["../stops"],gu=(e,r)=>r.id;function _u(e,r){if(e&1){let t=gt();M(0,"button",5),Se("click",function(){pe(t);let a=Q();return me(a.startAdd())}),Y(1,"Add School"),L()}}function vu(e,r){if(e&1){let t=gt();M(0,"form",6),Se("ngSubmit",function(){pe(t);let a=Q();return me(a.saveSchool())}),M(1,"div")(2,"label"),Y(3,"Name:"),L(),M(4,"input",7),ot("ngModelChange",function(a){pe(t);let i=Q();return st(i.name,a)||(i.name=a),me(a)}),Se("input",function(){pe(t);let a=Q();return me(a.saveSchool())}),L()(),M(5,"div")(6,"label"),Y(7,"Abbreviation:"),L(),M(8,"input",8),ot("ngModelChange",function(a){pe(t);let i=Q();return st(i.abbreviation,a)||(i.abbreviation=a),me(a)}),Se("input",function(){pe(t);let a=Q();return me(a.saveSchool())}),L()(),M(9,"div")(10,"label"),Y(11,"Address:"),L(),M(12,"input",9),ot("ngModelChange",function(a){pe(t);let i=Q();return st(i.address,a)||(i.address=a),me(a)}),Se("input",function(){pe(t);let a=Q();return me(a.saveSchool())}),L()(),M(13,"div")(14,"label"),Y(15,"Location (lat,lng):"),L(),M(16,"input",10),ot("ngModelChange",function(a){pe(t);let i=Q();return st(i.location,a)||(i.location=a),me(a)}),Se("input",function(){pe(t);let a=Q();return me(a.saveSchool())}),L()(),M(17,"div")(18,"label"),Y(19,"Type:"),L(),M(20,"select",11),ot("ngModelChange",function(a){pe(t);let i=Q();return st(i.type,a)||(i.type=a),me(a)}),Se("input",function(){pe(t);let a=Q();return me(a.saveSchool())}),M(21,"option",12),Y(22,"Preschool"),L(),M(23,"option",13),Y(24,"Elementary"),L(),M(25,"option",14),Y(26,"Middle"),L(),M(27,"option",15),Y(28,"High"),L(),M(29,"option",16),Y(30,"K-8"),L(),M(31,"option",17),Y(32,"K-12"),L()()(),M(33,"div")(34,"label"),Y(35,"Grades (comma separated):"),L(),M(36,"input",18),ot("ngModelChange",function(a){pe(t);let i=Q();return st(i.grades,a)||(i.grades=a),me(a)}),Se("input",function(){pe(t);let a=Q();return me(a.saveSchool())}),L()(),M(37,"button",19),Y(38,"Save"),L(),M(39,"button",5),Se("click",function(){pe(t);let a=Q();return me(a.cancelEdit())}),Y(40,"Cancel"),L()()}if(e&2){let t=Q();G(4),it("ngModel",t.name),G(4),it("ngModel",t.abbreviation),G(4),it("ngModel",t.address),G(4),it("ngModel",t.location),G(4),it("ngModel",t.type),G(16),it("ngModel",t.grades)}}function wu(e,r){if(e&1){let t=gt();M(0,"li",2)(1,"input",20),Se("change",function(a){let i=pe(t).$implicit,s=Q();return me(s.toggleSchoolSelection(i.id,a.target.checked))}),L(),M(2,"span",21)(3,"strong"),Y(4),L(),Y(5),dt(6,"br"),Y(7),dt(8,"br"),Y(9),L(),M(10,"button",5),Se("click",function(){let a=pe(t).$implicit,i=Q();return me(i.editSchool(a))}),Y(11,"Edit"),L(),M(12,"button",5),Se("click",function(){let a=pe(t).$implicit,i=Q();return me(i.deleteSchool(a.id))}),Y(13,"Remove"),L()()}if(e&2){let t=r.$implicit,n=Q();G(),We("checked",n.selectedSchoolIds().includes(t.id)),G(3),vt(t.name),G(),Ve(" (",t.type,")"),G(2),Ve(" ",t.address),G(2),Ve(" Grades: ",t.grades.join(", ")," ")}}function yu(e){return e?.split(",").map(r=>r.trim()).filter(r=>r.length>0)??[]}var Ai=class e{schoolsService=ce(Fi);planService=ce(Dt);schools=this.schoolsService.schools;name=Ze("");abbreviation=Ze("");address=Ze("");location=Ze("");type=Ze("Elementary");grades=Ze("");selectedSchoolIds=Ze([]);editingSchool=Ze(null);constructor(){yt(()=>{let r=this.planService.currentPlan();r&&this.selectedSchoolIds.set(r.schools.map(t=>t.id))})}startAdd(){this.editingSchool.set({id:"",name:"",abbreviation:"",address:"",location:[0,0],type:"Elementary",grades:[]}),this.name.set(""),this.abbreviation.set(""),this.address.set(""),this.location.set(""),this.type.set("Elementary"),this.grades.set("")}editSchool(r){this.editingSchool.set(r),this.name.set(r.name),this.abbreviation.set(r.abbreviation??""),this.address.set(r.address),this.location.set(r.location?`${r.location[0]},${r.location[1]}`:""),this.type.set(r.type),this.grades.set(r.grades?r.grades.join(","):"")}cancelEdit(){this.editingSchool.set(null),this.name.set(""),this.abbreviation.set(""),this.address.set(""),this.location.set(""),this.type.set("Elementary"),this.grades.set("")}saveSchool(){let r=this.location(),t=[0,0];if(r){let i=r.split(",").map(s=>parseFloat(s.trim()));i.length===2&&!isNaN(i[0])&&!isNaN(i[1])&&(t=[i[0],i[1]])}let n=yu(this.grades()),a={id:this.editingSchool()?.id??"",name:this.name(),abbreviation:this.abbreviation(),address:this.address(),location:t,type:this.type(),grades:n};!a.name||!a.address||!a.location||n.length===0||(!a.id||a.id===""?this.schoolsService.addSchool(a):this.schoolsService.updateSchool(a),this.cancelEdit())}deleteSchool(r){this.schoolsService.deleteSchool(r),this.selectedSchoolIds.set(this.selectedSchoolIds().filter(t=>t!==r)),this.updatePlanSchools(),this.editingSchool()&&this.editingSchool().id===r&&this.cancelEdit()}toggleSchoolSelection(r,t){let n=this.selectedSchoolIds(),a;t?a=n.includes(r)?n:[...n,r]:a=n.filter(i=>i!==r),this.selectedSchoolIds.set(a),this.updatePlanSchools()}updatePlanSchools(){let r=this.planService.currentPlan();if(!r)return;let n=this.schools().filter(i=>this.selectedSchoolIds().includes(i.id)),a=Qe(Ae({},r),{schools:n});this.planService.updatePlan(a)}static \u0275fac=function(t){return new(t||e)};static \u0275cmp=Ke({type:e,selectors:[["app-school-step"]],inputs:{name:[1,"name"],abbreviation:[1,"abbreviation"],address:[1,"address"],location:[1,"location"],type:[1,"type"],grades:[1,"grades"],selectedSchoolIds:[1,"selectedSchoolIds"],editingSchool:[1,"editingSchool"]},outputs:{name:"nameChange",abbreviation:"abbreviationChange",address:"addressChange",location:"locationChange",type:"typeChange",grades:"gradesChange",selectedSchoolIds:"selectedSchoolIdsChange",editingSchool:"editingSchoolChange"},decls:10,vars:4,consts:[["type","button"],[2,"margin-bottom","1rem"],[2,"display","flex","align-items","center"],[2,"margin-top","2rem"],[3,"routerLink"],["type","button",3,"click"],[2,"margin-bottom","1rem",3,"ngSubmit"],["name","name","required","",3,"ngModelChange","input","ngModel"],["name","abbreviation",3,"ngModelChange","input","ngModel"],["name","address","required","",3,"ngModelChange","input","ngModel"],["name","location","required","",3,"ngModelChange","input","ngModel"],["name","type",3,"ngModelChange","input","ngModel"],["value","Preschool"],["value","Elementary"],["value","Middle"],["value","High"],["value","K-8"],["value","K-12"],["name","grades","required","",3,"ngModelChange","input","ngModel"],["type","submit"],["type","checkbox",3,"change","checked"],[2,"flex","1","margin-left","0.5rem"]],template:function(t,n){t&1&&(M(0,"h2"),Y(1,"Schools"),L(),tt(2,_u,2,0,"button",0),tt(3,vu,41,6,"form",1),M(4,"ul"),ut(5,wu,14,5,"li",2,gu),L(),M(7,"div",3)(8,"button",4),Y(9,"Next"),L()()),t&2&&(G(2),rt(n.editingSchool()?-1:2),G(),rt(n.editingSchool()?3:-1),G(2),ht(n.schools()),G(3),We("routerLink",Bt(3,xu)))},dependencies:[Ar,Yr,Si,ki,Tr,yi,br,jr,Kr,Fr,$r,S0,Lt],styles:["h2[_ngcontent-%COMP%], form[_ngcontent-%COMP%]{margin-bottom:1rem}ul[_ngcontent-%COMP%]{list-style:none;padding:0}li[_ngcontent-%COMP%]{margin-bottom:.5rem}button[_ngcontent-%COMP%]{margin-right:.5rem}label[_ngcontent-%COMP%]{display:inline-block;width:120px}input[_ngcontent-%COMP%], select[_ngcontent-%COMP%]{margin-bottom:.5rem}"]})};var A0="buses",aa=class e{persistence=ce(vi);loaded=!1;buses=Ie([]);constructor(){this.load(),yt(()=>{let r=this.buses();this.loaded&&this.persistence.saveData(A0,r)})}async load(){this.loaded=!1;let r=await this.persistence.getData(A0);this.buses.set(r??[]),await new Promise(t=>setTimeout(t)),this.loaded=!0}addBus(r){this.buses.update(t=>[...t,Qe(Ae({},r),{number:r.number??na()})])}updateBus(r){this.buses.update(t=>t.map(n=>n.number===r.number?r:n))}deleteBus(r){this.buses.update(t=>t.filter(n=>n.number!==r))}static \u0275fac=function(t){return new(t||e)};static \u0275prov=Je({token:e,factory:e.\u0275fac,providedIn:"root"})};var Su=()=>["../schools"],ku=(e,r)=>r.number;function Eu(e,r){e&1&&(M(0,"span"),Y(1,"\u2014 Short rear bench"),L())}function Cu(e,r){if(e&1){let t=gt();M(0,"div",2)(1,"div",6)(2,"input",7),Se("change",function(){let a=pe(t).$implicit,i=Q();return me(i.selectBusForPlan(a))}),L(),M(3,"span"),Y(4),tt(5,Eu,2,0,"span"),Y(6,") "),L(),M(7,"button",0),Se("click",function(){let a=pe(t).$implicit,i=Q();return me(i.editBus(a))}),Y(8,"Edit"),L()()()}if(e&2){let t,n=r.$implicit,a=Q();G(2),We("checked",((t=a.planService.currentPlan())==null||t.bus==null?null:t.bus.number)===n.number),G(2),hi(" Bus #",n.number," (",n.rows," rows "),G(),rt(n.shortRearBench?5:-1)}}function Tu(e,r){e&1&&(M(0,"li"),Y(1,"No buses found. Please create a bus."),L())}function bu(e,r){if(e&1){let t=gt();M(0,"form",8),Se("submit",function(){pe(t);let a=Q();return me(a.saveBus())}),M(1,"label"),Y(2,"Number: "),M(3,"input",9),ot("ngModelChange",function(a){pe(t);let i=Q();return st(i.busNumber,a)||(i.busNumber=a),me(a)}),L()(),M(4,"label"),Y(5,"Rows: "),M(6,"input",10),ot("ngModelChange",function(a){pe(t);let i=Q();return st(i.busRows,a)||(i.busRows=a),me(a)}),L()(),M(7,"div",11)(8,"input",12),ot("ngModelChange",function(a){pe(t);let i=Q();return st(i.busShortRearBench,a)||(i.busShortRearBench=a),me(a)}),L(),M(9,"label",13),Y(10,"Last row has short bench"),L()(),M(11,"div",14)(12,"button",15),Y(13,"Save"),L(),M(14,"button",16),Se("click",function(){pe(t);let a=Q();return me(a.cancelBusForm())}),Y(15,"Cancel"),L()()()}if(e&2){let t=Q();G(3),it("ngModel",t.busNumber),G(3),it("ngModel",t.busRows),G(2),it("ngModel",t.busShortRearBench)}}var Di=class e{busService=ce(aa);planService=ce(Dt);showBusForm=Ze(!1);selectedBus=Ze(null);busNumber=Ze(null);busRows=Ze(10);busShortRearBench=Ze(!1);selectBus(r){this.selectedBus.set(r),this.populateEditForm(r),this.showBusForm.set(!0)}startNewBus(){this.selectedBus.set(null),this.populateEditForm(),this.showBusForm.set(!0)}saveBus(){let r={number:this.busNumber()??"",rows:this.busRows(),shortRearBench:this.busShortRearBench()};if(this.selectedBus()){this.busService.updateBus(r);let t=this.planService.currentPlan();t&&t.bus&&t.bus.number===r.number&&this.planService.updatePlan(Qe(Ae({},t),{bus:r}))}else this.busService.addBus(r);this.showBusForm.set(!1),this.selectedBus.set(null),this.populateEditForm()}cancelBusForm(){this.showBusForm.set(!1),this.selectedBus.set(null),this.populateEditForm()}selectBusForPlan(r){let t=this.planService.currentPlan();t&&this.planService.updatePlan(Qe(Ae({},t),{bus:r})),this.selectedBus.set(null),this.showBusForm.set(!1)}editBus(r){this.selectedBus.set(r),this.populateEditForm(r),this.showBusForm.set(!0)}populateEditForm(r){this.busNumber.set(r?.number??null),this.busRows.set(r?.rows??10),this.busShortRearBench.set(r?.shortRearBench??!1)}static \u0275fac=function(t){return new(t||e)};static \u0275cmp=Ke({type:e,selectors:[["app-bus-step"]],inputs:{showBusForm:[1,"showBusForm"],selectedBus:[1,"selectedBus"],busNumber:[1,"busNumber"],busRows:[1,"busRows"],busShortRearBench:[1,"busShortRearBench"]},outputs:{showBusForm:"showBusFormChange",selectedBus:"selectedBusChange",busNumber:"busNumberChange",busRows:"busRowsChange",busShortRearBench:"busShortRearBenchChange"},decls:13,vars:4,consts:[[3,"click"],[1,"bus-list"],[1,"bus-list-item",2,"justify-content","space-between"],[1,"bus-form"],[1,"wizard-next-btn"],[3,"routerLink"],[2,"display","flex","align-items","center","gap",".5rem"],["type","radio",3,"change","checked"],[1,"bus-form",3,"submit"],["name","busNumber","required","",3,"ngModelChange","ngModel"],["name","busRows","type","number","required","",3,"ngModelChange","ngModel"],[1,"bus-checkbox-row"],["type","checkbox","name","busShortRearBench","id","busShortRearBench",3,"ngModelChange","ngModel"],["for","busShortRearBench"],[1,"bus-form-buttons"],["type","submit"],["type","button",3,"click"]],template:function(t,n){t&1&&(M(0,"div")(1,"h3"),Y(2,"Select a Bus"),L(),M(3,"button",0),Se("click",function(){return n.startNewBus()}),Y(4,"New Bus"),L(),M(5,"div",1),ut(6,Cu,9,4,"div",2,ku,!1,Tu,2,0,"li"),L(),tt(9,bu,16,3,"form",3),M(10,"div",4)(11,"button",5),Y(12,"Next"),L()()()),t&2&&(G(6),ht(n.busService.buses()),G(3),rt(n.showBusForm()?9:-1),G(2),We("routerLink",Bt(3,Su)))},dependencies:[Ar,Yr,Tr,wi,dn,br,jr,Kr,Fr,$r,Lt],styles:[".bus-checkbox-row[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:flex-start;gap:.5rem}.bus-list[_ngcontent-%COMP%]{margin-top:1rem}.bus-form-buttons[_ngcontent-%COMP%]{display:flex;gap:.5rem;margin-top:.5rem}"]})};var Fu=()=>["../routes"],Au=(e,r)=>r.id;function Du(e,r){if(e&1){let t=gt();M(0,"label",9)(1,"input",15),Se("change",function(a){let i=pe(t).$implicit,s=Q(2);return s.toggleSideForm(i,a.target.checked),me(s.saveStop())}),L(),Y(2),Zt(3,"titlecase"),L()}if(e&2){let t=r.$implicit,n=Q(2);G(),We("checked",n.sideOfStreet().includes(t)),G(),Ve(" ",Wr(3,2,t)," ")}}function Ru(e,r){if(e&1){let t=gt();M(0,"form",2),Se("ngSubmit",function(){pe(t);let a=Q();return me(a.saveStop())}),M(1,"div")(2,"label"),Y(3,"ID:"),L(),M(4,"input",3),ot("ngModelChange",function(a){pe(t);let i=Q();return st(i.id,a)||(i.id=a),me(a)}),Se("input",function(){pe(t);let a=Q();return me(a.saveStop())}),L()(),M(5,"div")(6,"label"),Y(7,"Address:"),L(),M(8,"input",4),ot("ngModelChange",function(a){pe(t);let i=Q();return st(i.address,a)||(i.address=a),me(a)}),Se("input",function(){pe(t);let a=Q();return me(a.saveStop())}),L()(),M(9,"div")(10,"label"),Y(11,"Nickname (optional):"),L(),M(12,"input",5),ot("ngModelChange",function(a){pe(t);let i=Q();return st(i.name,a)||(i.name=a),me(a)}),Se("input",function(){pe(t);let a=Q();return me(a.saveStop())}),L()(),M(13,"div")(14,"label"),Y(15,"Location (lat,lng):"),L(),M(16,"input",6),ot("ngModelChange",function(a){pe(t);let i=Q();return st(i.location,a)||(i.location=a),me(a)}),Se("input",function(){pe(t);let a=Q();return me(a.saveStop())}),L()(),M(17,"div")(18,"label"),Y(19,"Side of Street (optional):"),L(),M(20,"p",7),Y(21,"What side(s) of the street can students safely be picked up or dropped off on?"),L(),M(22,"div",8),ut(23,Du,4,4,"label",9,ui),L()(),M(25,"div")(26,"label",10)(27,"input",11),ot("ngModelChange",function(a){pe(t);let i=Q();return st(i.curbside,a)||(i.curbside=a),me(a)}),Se("change",function(){pe(t);let a=Q();return me(a.saveStop())}),L(),Y(28," Curbside "),L()(),M(29,"div")(30,"label"),Y(31,"Notes:"),L(),M(32,"textarea",12),ot("ngModelChange",function(a){pe(t);let i=Q();return st(i.notes,a)||(i.notes=a),me(a)}),Se("input",function(){pe(t);let a=Q();return me(a.saveStop())}),L()(),M(33,"div",13)(34,"button",14),Se("click",function(){pe(t);let a=Q();return me(a.cancelEdit())}),Y(35,"Done"),L()()()}if(e&2){let t=Q();G(4),it("ngModel",t.id),G(4),it("ngModel",t.address),G(4),it("ngModel",t.name),G(4),it("ngModel",t.location),G(7),ht(t.sideOptions),G(4),it("ngModel",t.curbside),G(5),it("ngModel",t.notes)}}function Ou(e,r){if(e&1&&Y(0),e&2){let t=Q().$implicit;Ve(" (",t.nickname,") ")}}function Pu(e,r){e&1&&(M(0,"strong"),Y(1," - CURBSIDE"),L())}function Nu(e,r){if(e&1&&(M(0,"span"),Y(1),L()),e&2){let t=Q().$implicit;G(),Ve("Notes: ",t.notes)}}function Iu(e,r){if(e&1){let t=gt();M(0,"li")(1,"span")(2,"strong"),Y(3),L(),tt(4,Ou,1,1),tt(5,Pu,2,0,"strong"),dt(6,"br"),Y(7),dt(8,"br"),Y(9),dt(10,"br"),Y(11),dt(12,"br"),tt(13,Nu,2,1,"span"),L(),M(14,"button",0),Se("click",function(){let a=pe(t).$index,i=Q();return me(i.editStop(a))}),Y(15,"Edit"),L(),M(16,"button",0),Se("click",function(){let a=pe(t).$index,i=Q();return me(i.removeStop(a))}),Y(17,"Delete"),L(),M(18,"button",16),Se("click",function(){let a=pe(t).$index,i=Q();return me(i.moveUp(a))}),Y(19,"\u2191"),L(),M(20,"button",16),Se("click",function(){let a=pe(t).$index,i=Q();return me(i.moveDown(a))}),Y(21,"\u2193"),L()()}if(e&2){let t=r.$implicit,n=r.$index,a=Q();G(3),vt(t.id),G(),rt(t.nickname?4:-1),G(),rt(t.curbside?5:-1),G(2),Ve(" ",t.address),G(2),Ve(" Location: ",t.location.join(",")),G(2),Ve(" Side(s): ",t.sideOfStreet.join(", ")),G(2),rt(t.notes?13:-1),G(5),We("disabled",n===0),G(2),We("disabled",n===a.stops().length-1)}}function Mu(e,r){e&1&&(M(0,"li"),Y(1,"No stops added yet."),L())}var Ri=class e{planService=ce(Dt);stops=Ze([]);name=Ze("");id=Ze("");address=Ze("");location=Ze("");sideOfStreet=Ze([]);notes=Ze("");curbside=Ze(!1);editingStop=Ie(null);constructor(){yt(()=>{let r=this.planService.currentPlan();r&&Array.isArray(r.stops)?this.stops.set(r.stops.map(t=>Ae({},t))):this.stops.set([])})}startAdd(){this.editingStop.set({}),this.name.set(""),this.id.set(""),this.address.set(""),this.location.set(""),this.sideOfStreet.set([]),this.curbside.set(!1),this.notes.set("")}editStop(r){let t=this.stops()[r];this.editingStop.set(t),this.name.set(t.nickname),this.id.set(t.id),this.address.set(t.address),this.location.set(t.location.join(",")),this.sideOfStreet.set([...t.sideOfStreet]),this.curbside.set(!!t.curbside),this.notes.set(t.notes??"")}cancelEdit(){this.editingStop.set(null),this.name.set(""),this.id.set(""),this.address.set(""),this.location.set(""),this.sideOfStreet.set([]),this.curbside.set(!1),this.notes.set("")}saveStop(){let r=this.location(),t=0,n=0;if(r){let o=r.split(",").map(c=>parseFloat(c.trim()));o.length===2&&!isNaN(o[0])&&!isNaN(o[1])&&(t=o[0],n=o[1])}let a={id:this.id(),nickname:this.name(),address:this.address(),location:[t,n],sideOfStreet:[...this.sideOfStreet()],curbside:this.curbside(),notes:this.notes()};if(!a.id||!a.address)return;let i=this.stops().findIndex(o=>o.id===this.id());i===-1?this.stops.update(o=>[...o,a]):this.stops.update(o=>o.map((c,l)=>l===i?a:c));let s=this.planService.currentPlan();if(s){let o=Qe(Ae({},s),{stops:this.stops().map(c=>Ae({},c))});this.planService.updatePlan(o),this.stops.set(o.stops.map(c=>Ae({},c)))}}toggleSideForm(r,t){let n=this.sideOfStreet();t?n.includes(r)||this.sideOfStreet.set([...n,r]):this.sideOfStreet.set(n.filter(a=>a!==r))}removeStop(r){this.stops.update(n=>n.filter((a,i)=>i!==r));let t=this.planService.currentPlan();if(t){let n=Qe(Ae({},t),{stops:this.stops().map(a=>Ae({},a))});this.planService.updatePlan(n),this.stops.set(n.stops.map(a=>Ae({},a)))}}moveUp(r){this.stops.update(n=>{if(r>0){let a=[...n];return[a[r-1],a[r]]=[a[r],a[r-1]],a}return n});let t=this.planService.currentPlan();if(t){let n=Qe(Ae({},t),{stops:this.stops().map(a=>Ae({},a))});this.planService.updatePlan(n),this.stops.set(n.stops.map(a=>Ae({},a)))}}moveDown(r){this.stops.update(n=>{if(r<n.length-1){let a=[...n];return[a[r],a[r+1]]=[a[r+1],a[r]],a}return n});let t=this.planService.currentPlan();if(t){let n=Qe(Ae({},t),{stops:this.stops().map(a=>Ae({},a))});this.planService.updatePlan(n),this.stops.set(n.stops.map(a=>Ae({},a)))}}sideOptions=["north","south","east","west","northeast","southeast","southwest","northwest"];toggleSide(r,t,n){n?r.sideOfStreet.includes(t)||(r.sideOfStreet=[...r.sideOfStreet,t]):r.sideOfStreet=r.sideOfStreet.filter(a=>a!==t)}static \u0275fac=function(t){return new(t||e)};static \u0275cmp=Ke({type:e,selectors:[["app-stop-step"]],inputs:{stops:[1,"stops"],name:[1,"name"],id:[1,"id"],address:[1,"address"],location:[1,"location"],sideOfStreet:[1,"sideOfStreet"],notes:[1,"notes"],curbside:[1,"curbside"]},outputs:{stops:"stopsChange",name:"nameChange",id:"idChange",address:"addressChange",location:"locationChange",sideOfStreet:"sideOfStreetChange",notes:"notesChange",curbside:"curbsideChange"},decls:11,vars:4,consts:[["type","button",3,"click"],[1,"wizard-next-btn",3,"routerLink"],[3,"ngSubmit"],["name","id","required","",3,"ngModelChange","input","ngModel"],["name","address","required","",3,"ngModelChange","input","ngModel"],["name","name","required","",3,"ngModelChange","input","ngModel"],["name","location","required","",3,"ngModelChange","input","ngModel"],[1,"instructions"],[1,"sides"],[2,"display","inline-flex","align-items","center","gap","0.25rem"],[2,"display","inline-flex","align-items","center","gap","0.5rem"],["type","checkbox","name","curbside",3,"ngModelChange","change","ngModel"],["name","notes","rows","2",3,"ngModelChange","input","ngModel"],[1,"actions"],[3,"click"],["type","checkbox",3,"change","checked"],["type","button",3,"click","disabled"]],template:function(t,n){t&1&&(M(0,"h2"),Y(1,"Stops"),L(),M(2,"button",0),Se("click",function(){return n.startAdd()}),Y(3,"Add Stop"),L(),tt(4,Ru,36,6,"form"),M(5,"ul"),ut(6,Iu,22,9,"li",null,Au,!1,Mu,2,0,"li"),L(),M(9,"button",1),Y(10,"Next"),L()),t&2&&(G(4),rt(n.editingStop()?4:-1),G(2),ht(n.stops()),G(3),We("routerLink",Bt(3,Fu)))},dependencies:[Ar,Yr,Tr,dn,br,jr,Kr,Fr,$r,Lt,mi],styles:[".sides[_ngcontent-%COMP%]{display:inline-flex;flex-wrap:wrap;gap:1rem}"]})};var Bu=()=>["../students"],Lu=(e,r)=>r.name,Uu=(e,r)=>r.day,Wu=(e,r)=>r.stop;function Vu(e,r){if(e&1){let t=gt();M(0,"label",7)(1,"input",9),ot("ngModelChange",function(a){let i=pe(t).$implicit;return st(i.selected,a)||(i.selected=a),me(a)}),Se("change",function(){pe(t);let a=Q(2);return me(a.save())}),L(),Y(2),L()}if(e&2){let t=r.$implicit;G(),We("name",t.day),it("ngModel",t.selected),G(),Ve(" ",t.day," ")}}function Hu(e,r){if(e&1&&Y(0),e&2){let t=Q().$implicit;Ve(" (",t.stop.nickname,") ")}}function zu(e,r){if(e&1){let t=gt();M(0,"div")(1,"label",10),Y(2),tt(3,Hu,1,1),L(),M(4,"input",11),ot("ngModelChange",function(a){let i=pe(t).$implicit;return st(i.time,a)||(i.time=a),me(a)}),Se("input",function(){pe(t);let a=Q(2);return me(a.save())}),L()()}if(e&2){let t=r.$implicit;G(),We("title",t.stop.address),G(),Ve(" Stop ",t.stop.id," "),G(),rt(t.stop.nickname?3:-1),G(),We("name",Ea("time-",t.stop.id)),it("ngModel",t.time)}}function Xu(e,r){if(e&1){let t=gt();M(0,"form")(1,"label"),Y(2,"Schedule Name "),M(3,"input",2),ot("ngModelChange",function(a){pe(t);let i=Q();return st(i.scheduleName,a)||(i.scheduleName=a),me(a)}),Se("input",function(){pe(t);let a=Q();return me(a.save())}),L()(),M(4,"label"),Y(5," Schedule Type "),M(6,"select",3),ot("ngModelChange",function(a){pe(t);let i=Q();return st(i.stopTypes,a)||(i.stopTypes=a),me(a)}),Se("input",function(){pe(t);let a=Q();return me(a.save())}),M(7,"option",4),Y(8,"Pick Up"),L(),M(9,"option",5),Y(10,"Drop Off"),L()()(),M(11,"div")(12,"label"),Y(13,"Days of the Week:"),L(),M(14,"div",6),ut(15,Vu,3,3,"label",7,Uu),L()(),M(17,"div")(18,"h3"),Y(19,"Stop Times"),L(),M(20,"div",8),ut(21,zu,5,6,"div",null,Wu),L()(),M(23,"button",0),Se("click",function(){pe(t);let a=Q();return a.save(),me(a.editingSchedule.set(null))}),Y(24,"Done"),L()()}if(e&2){let t=Q();G(3),it("ngModel",t.scheduleName),G(3),it("ngModel",t.stopTypes),G(9),ht(t.daySettings()),G(6),ht(t.sortedStopTimes())}}function Gu(e,r){if(e&1){let t=gt();M(0,"li")(1,"strong"),Y(2),L(),Y(3),Zt(4,"scheduleTimeRange"),Zt(5,"date"),Zt(6,"scheduleTimeRange"),Zt(7,"date"),M(8,"button",0),Se("click",function(){let a=pe(t).$implicit,i=Q();return me(i.editSchedule(a))}),Y(9,"Edit"),L(),M(10,"button",0),Se("click",function(){let a=pe(t).$implicit,i=Q();return me(i.removeSchedule(a.name))}),Y(11,"Remove"),L()()}if(e&2){let t=r.$implicit;G(2),vt(t.name),G(),l0(" - ",Dn(5,6,Wr(4,4,t)[0],"shortTime")," - ",Dn(7,11,Wr(6,9,t)[1],"shortTime")," - ",t.days.join(", ")," ")}}function ju(e,r){e&1&&(M(0,"li"),Y(1,"No schedules added yet."),L())}var Ls=class e{transform(r){let t=(r.stops??[]).map(n=>n.time).filter(n=>n).map(n=>new Date(`1970-01-01T${n}:00`)).sort((n,a)=>n.getTime()-a.getTime());return[t.at(0)??null,t.at(-1)??null]}static \u0275fac=function(t){return new(t||e)};static \u0275pipe=fi({name:"scheduleTimeRange",type:e,pure:!0})},Oi=class e{planService=ce(Dt);router=ce(hn);scheduleName=Ze("");stops=Ie([]);stopTimes=Ie([]);stopTypes=Ie("pick up");buses=Ie([]);routes=Ze([]);schedules=Ze([]);editingSchedule=Ie(null);daysOfWeek=["Monday","Tuesday","Wednesday","Thursday","Friday"];daySettings=Ie([]);sortedStopTimes=Me(()=>[...this.stopTimes()].sort((r,t)=>{let n=r.time(),a=t.time();if(n&&a){if(n<a)return-1;if(n>a)return 1}else{if(n&&!a)return-1;if(!n&&a)return 1}return r.stop.id<t.stop.id?-1:r.stop.id>t.stop.id?1:0}));constructor(){yt(()=>{let r=this.planService.currentPlan();r&&Array.isArray(r.routes)?(this.routes.set(r.routes.map(t=>Ae({},t))),this.schedules.set(r.schedules?.map(t=>Ae({},t))??[])):(this.routes.set([]),this.schedules.set([])),this.stops.set(r?.stops??[])})}setStopTime(r,t){this.stopTimes.set(Qe(Ae({},this.stopTimes()),{[r]:t}))}addSchedule(){let r={id:na(),name:this.scheduleName(),days:[],stops:this.stops().map(t=>({stopId:t.id,time:this.stopTimes().find(n=>n.stop.id===t.id)?.time()??"",stopType:this.stopTypes()}))};this.schedules.update(t=>[...t,r]),this.scheduleName.set(""),this.daySettings.set(this.daysOfWeek.map(t=>({day:t,selected:!1}))),this.stopTimes.set(this.stops().map(t=>({stop:t,time:Ie("")}))),this.stopTypes.set("pick up"),this.editingSchedule.set(r)}editSchedule(r){this.editingSchedule.set(null),this.editingSchedule.set(r),this.scheduleName.set(r.name),this.daySettings.set(this.daysOfWeek.map(t=>({day:t,selected:r.days.includes(t)}))),this.stopTimes.set(this.stops().map(t=>{let n=r.stops.find(a=>a.stopId===t.id);return console.log({s:t,stopEntry:n}),{stop:t,time:Ie(n?.time??"")}})),r.stops.length>0?this.stopTypes.set(r.stops[0].stopType):this.stopTypes.set("pick up")}removeSchedule(r){this.schedules.update(t=>t.filter(n=>n.name!==r))}save(){let r=this.planService.currentPlan();if(!r)return;let t=this.daySettings().filter(i=>i.selected).map(i=>i.day),n=this.stops().map(i=>({stopId:i.id,time:this.stopTimes().find(s=>s.stop.id===i.id)?.time()??"",stopType:this.stopTypes()}));console.log("[SAVE] daysSelected:",t),console.log("[SAVE] stopsSaved:",n),console.log("[SAVE] scheduleName:",this.scheduleName()),console.log("[SAVE] editingSchedule:",this.editingSchedule());let a=Qe(Ae({},r),{schedules:this.schedules().map(i=>i.id===this.editingSchedule()?.id?Qe(Ae({},i),{name:this.scheduleName(),days:t,stops:n}):i),updatedAt:new Date().toISOString()});console.log("[SAVE] updatedPlan:",a),this.planService.updatePlan(a),this.schedules.set(a.schedules.map(i=>Ae({},i)))}static \u0275fac=function(t){return new(t||e)};static \u0275cmp=Ke({type:e,selectors:[["app-route-schedule-step"]],inputs:{scheduleName:[1,"scheduleName"],routes:[1,"routes"],schedules:[1,"schedules"]},outputs:{scheduleName:"scheduleNameChange",routes:"routesChange",schedules:"schedulesChange"},decls:11,vars:4,consts:[[3,"click"],[3,"routerLink"],["name","scheduleName",3,"ngModelChange","input","ngModel"],["name","stopType",3,"ngModelChange","input","ngModel"],["name","pickUp","value","pick up"],["name","dropOff","value","drop off"],[1,"days-list"],[2,"margin-right","1rem"],[1,"stops-list"],["type","checkbox",3,"ngModelChange","change","name","ngModel"],[3,"title"],["type","time",3,"ngModelChange","input","name","ngModel"]],template:function(t,n){t&1&&(M(0,"h2"),Y(1,"Route Schedules"),L(),M(2,"button",0),Se("click",function(){return n.addSchedule()}),Y(3,"New Schedule"),L(),tt(4,Xu,25,2,"form"),M(5,"ul"),ut(6,Gu,12,14,"li",null,Lu,!1,ju,2,0,"li"),L(),M(9,"button",1),Y(10,"Next"),L()),t&2&&(G(4),rt(n.editingSchedule()?4:-1),G(2),ht(n.schedules()),G(3),We("routerLink",Bt(3,Bu)))},dependencies:[Ar,Yr,Si,ki,Tr,dn,yi,br,jr,Fr,$r,Lt,Ls,ra],styles:[".stops-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem}.days-list[_ngcontent-%COMP%]{display:flex;flex-direction:row;gap:.5rem;margin-bottom:1rem}"]})};var Rc={};Rc.version="0.20.3";var er=1200,ua=1252,Le,$u=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],ao={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},io=function(e){$u.indexOf(e)!=-1&&(ua=ao[0]=e)};function Yu(){io(1252)}var Hr=function(e){er=e,io(e)};function Oc(){Hr(1200),Yu()}function Ks(e){for(var r=[],t=0,n=e.length;t<n;++t)r[t]=e.charCodeAt(t);return r}function Pc(e){for(var r=[],t=0;t<e.length>>1;++t)r[t]=String.fromCharCode(e.charCodeAt(2*t)+(e.charCodeAt(2*t+1)<<8));return r.join("")}function Ku(e){for(var r=[],t=0;t<e.length>>1;++t)r[t]=String.fromCharCode(e[2*t]+(e[2*t+1]<<8));return r.join("")}function Nc(e){for(var r=[],t=0;t<e.length>>1;++t)r[t]=String.fromCharCode(e.charCodeAt(2*t+1)+(e.charCodeAt(2*t)<<8));return r.join("")}var ba=function(e){var r=e.charCodeAt(0),t=e.charCodeAt(1);return r==255&&t==254?Pc(e.slice(2)):r==254&&t==255?Nc(e.slice(2)):r==65279?e.slice(1):e},Pi=function(r){return String.fromCharCode(r)},D0=function(r){return String.fromCharCode(r)};var Et=null,R0=!0,xn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function O0(e){for(var r="",t=0,n=0,a=0,i=0,s=0,o=0,c=0,l=0;l<e.length;)t=e.charCodeAt(l++),i=t>>2,n=e.charCodeAt(l++),s=(t&3)<<4|n>>4,a=e.charCodeAt(l++),o=(n&15)<<2|a>>6,c=a&63,isNaN(n)?o=c=64:isNaN(a)&&(c=64),r+=xn.charAt(i)+xn.charAt(s)+xn.charAt(o)+xn.charAt(c);return r}function Sr(e){var r="",t=0,n=0,a=0,i=0,s=0,o=0,c=0;if(e.slice(0,5)=="data:"){var l=e.slice(0,1024).indexOf(";base64,");l>-1&&(e=e.slice(l+8))}e=e.replace(/[^\w\+\/\=]/g,"");for(var l=0;l<e.length;)i=xn.indexOf(e.charAt(l++)),s=xn.indexOf(e.charAt(l++)),t=i<<2|s>>4,r+=String.fromCharCode(t),o=xn.indexOf(e.charAt(l++)),n=(s&15)<<4|o>>2,o!==64&&(r+=String.fromCharCode(n)),c=xn.indexOf(e.charAt(l++)),a=(o&3)<<6|c,c!==64&&(r+=String.fromCharCode(a));return r}var He=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),yn=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(r,t){return t?new Buffer(r,t):new Buffer(r)}:Buffer.from.bind(Buffer)}return function(){}})(),Va=(function(){if(typeof Buffer>"u")return!1;var e=yn([65,0]);if(!e)return!1;var r=e.toString("utf16le");return r.length==1})();function _n(e){return He?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function P0(e){return He?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var wr=function(r){return He?yn(r,"binary"):r.split("").map(function(t){return t.charCodeAt(0)&255})};function on(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var r=[],t=0;t<e.length;++t)r[t]=String.fromCharCode(e[t]);return r.join("")}function so(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return so(new Uint8Array(e));for(var r=new Array(e.length),t=0;t<e.length;++t)r[t]=e[t];return r}var mn=He?function(e){return Buffer.concat(e.map(function(r){return Buffer.isBuffer(r)?r:yn(r)}))}:function(e){if(typeof Uint8Array<"u"){var r=0,t=0;for(r=0;r<e.length;++r)t+=e[r].length;var n=new Uint8Array(t),a=0;for(r=0,t=0;r<e.length;t+=a,++r)a=e[r].length,e[r]instanceof Uint8Array?n.set(e[r],t):typeof e[r]=="string"?n.set(new Uint8Array(wr(e[r])),t):n.set(new Uint8Array(e[r]),t);return n}return[].concat.apply([],e.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function Zu(e){for(var r=[],t=0,n=e.length+250,a=_n(e.length+255),i=0;i<e.length;++i){var s=e.charCodeAt(i);if(s<128)a[t++]=s;else if(s<2048)a[t++]=192|s>>6&31,a[t++]=128|s&63;else if(s>=55296&&s<57344){s=(s&1023)+64;var o=e.charCodeAt(++i)&1023;a[t++]=240|s>>8&7,a[t++]=128|s>>2&63,a[t++]=128|o>>6&15|(s&3)<<4,a[t++]=128|o&63}else a[t++]=224|s>>12&15,a[t++]=128|s>>6&63,a[t++]=128|s&63;t>n&&(r.push(a.slice(0,t)),t=0,a=_n(65535),n=65530)}return r.push(a.slice(0,t)),mn(r)}var lr=/\u0000/g,Fa=/[\u0001-\u0006]/g;function ca(e){for(var r="",t=e.length-1;t>=0;)r+=e.charAt(t--);return r}function zr(e,r){var t=""+e;return t.length>=r?t:Ge("0",r-t.length)+t}function oo(e,r){var t=""+e;return t.length>=r?t:Ge(" ",r-t.length)+t}function zi(e,r){var t=""+e;return t.length>=r?t:t+Ge(" ",r-t.length)}function qu(e,r){var t=""+Math.round(e);return t.length>=r?t:Ge("0",r-t.length)+t}function Ju(e,r){var t=""+e;return t.length>=r?t:Ge("0",r-t.length)+t}var N0=Math.pow(2,32);function ia(e,r){if(e>N0||e<-N0)return qu(e,r);var t=Math.round(e);return Ju(t,r)}function Xi(e,r){return r=r||0,e.length>=7+r&&(e.charCodeAt(r)|32)===103&&(e.charCodeAt(r+1)|32)===101&&(e.charCodeAt(r+2)|32)===110&&(e.charCodeAt(r+3)|32)===101&&(e.charCodeAt(r+4)|32)===114&&(e.charCodeAt(r+5)|32)===97&&(e.charCodeAt(r+6)|32)===108}var I0=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Us=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Qu(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"\u4E0A\u5348/\u4E0B\u5348 "hh"\u6642"mm"\u5206"ss"\u79D2 "',e}var De={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"\u4E0A\u5348/\u4E0B\u5348 "hh"\u6642"mm"\u5206"ss"\u79D2 "'},M0={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},eh={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Gi(e,r,t){for(var n=e<0?-1:1,a=e*n,i=0,s=1,o=0,c=1,l=0,f=0,d=Math.floor(a);l<r&&(d=Math.floor(a),o=d*s+i,f=d*l+c,!(a-d<5e-8));)a=1/(a-d),i=s,s=o,c=l,l=f;if(f>r&&(l>r?(f=c,o=i):(f=l,o=s)),!t)return[0,n*o,f];var h=Math.floor(n*o/f);return[h,n*o-h*f,f]}function th(e){var r=e.toPrecision(16);if(r.indexOf("e")>-1){var t=r.slice(0,r.indexOf("e"));return t=t.indexOf(".")>-1?t.slice(0,t.slice(0,2)=="0."?17:16):t.slice(0,15)+Ge("0",t.length-15),t+r.slice(r.indexOf("e"))}var n=r.indexOf(".")>-1?r.slice(0,r.slice(0,2)=="0."?17:16):r.slice(0,15)+Ge("0",r.length-15);return Number(n)}function tn(e,r,t){if(e>2958465||e<0)return null;e=th(e);var n=e|0,a=Math.floor(86400*(e-n)),i=0,s=[],o={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),r&&r.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++a==86400&&(o.T=a=0,++n,++o.D)),n===60)s=t?[1317,10,29]:[1900,2,29],i=3;else if(n===0)s=t?[1317,8,29]:[1900,1,0],i=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),s=[c.getFullYear(),c.getMonth()+1,c.getDate()],i=c.getDay(),n<60&&(i=(i+6)%7),t&&(i=ih(c,s))}return o.y=s[0],o.m=s[1],o.d=s[2],o.S=a%60,a=Math.floor(a/60),o.M=a%60,a=Math.floor(a/60),o.H=a,o.q=i,o}function co(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function rh(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function nh(e){var r=e<0?12:11,t=co(e.toFixed(12));return t.length<=r||(t=e.toPrecision(10),t.length<=r)?t:e.toExponential(5)}function ah(e){var r=co(e.toFixed(11));return r.length>(e<0?12:11)||r==="0"||r==="-0"?e.toPrecision(6):r}function Ha(e){if(!isFinite(e))return isNaN(e)?"#NUM!":"#DIV/0!";var r=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),t;return r>=-4&&r<=-1?t=e.toPrecision(10+r):Math.abs(r)<=9?t=nh(e):r===10?t=e.toFixed(10).substr(0,12):t=ah(e),co(rh(t.toUpperCase()))}function Ln(e,r){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Ha(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return kr(14,Mt(e,r&&r.date1904),r)}throw new Error("unsupported value in General format: "+e)}function ih(e,r){r[0]-=581;var t=e.getDay();return e<60&&(t=(t+6)%7),t}function sh(e,r,t,n){var a="",i=0,s=0,o=t.y,c,l=0;switch(e){case 98:o=t.y+543;case 121:switch(r.length){case 1:case 2:c=o%100,l=2;break;default:c=o%1e4,l=4;break}break;case 109:switch(r.length){case 1:case 2:c=t.m,l=r.length;break;case 3:return Us[t.m-1][1];case 5:return Us[t.m-1][0];default:return Us[t.m-1][2]}break;case 100:switch(r.length){case 1:case 2:c=t.d,l=r.length;break;case 3:return I0[t.q][0];default:return I0[t.q][1]}break;case 104:switch(r.length){case 1:case 2:c=1+(t.H+11)%12,l=r.length;break;default:throw"bad hour format: "+r}break;case 72:switch(r.length){case 1:case 2:c=t.H,l=r.length;break;default:throw"bad hour format: "+r}break;case 77:switch(r.length){case 1:case 2:c=t.M,l=r.length;break;default:throw"bad minute format: "+r}break;case 115:if(r!="s"&&r!="ss"&&r!=".0"&&r!=".00"&&r!=".000")throw"bad second format: "+r;return t.u===0&&(r=="s"||r=="ss")?zr(t.S,r.length):(n>=2?s=n===3?1e3:100:s=n===1?10:1,i=Math.round(s*(t.S+t.u)),i>=60*s&&(i=0),r==="s"?i===0?"0":""+i/s:(a=zr(i,2+n),r==="ss"?a.substr(0,2):"."+a.substr(2,r.length-1)));case 90:switch(r){case"[h]":case"[hh]":c=t.D*24+t.H;break;case"[m]":case"[mm]":c=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":c=((t.D*24+t.H)*60+t.M)*60+(n==0?Math.round(t.S+t.u):t.S);break;default:throw"bad abstime format: "+r}l=r.length===3?1:2;break;case 101:c=o,l=1;break}var f=l>0?zr(c,l):"";return f}function rn(e){var r=3;if(e.length<=r)return e;for(var t=e.length%r,n=e.substr(0,t);t!=e.length;t+=r)n+=(n.length>0?",":"")+e.substr(t,r);return n}var Ic=/%/g;function oh(e,r,t){var n=r.replace(Ic,""),a=r.length-n.length;return an(e,n,t*Math.pow(10,2*a))+Ge("%",a)}function ch(e,r,t){for(var n=r.length-1;r.charCodeAt(n-1)===44;)--n;return an(e,r.substr(0,n),t/Math.pow(10,3*(r.length-n)))}function Mc(e,r){var t,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+Mc(e,-r);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var i=Math.floor(Math.log(r)*Math.LOG10E)%a;if(i<0&&(i+=a),t=(r/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),t.indexOf("e")===-1){var s=Math.floor(Math.log(r)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(s-t.length+i):t+="E+"+(s-i);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,a)+"."+t.substr(2+a),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,l,f){return c+l+f.substr(0,(a+i)%a)+"."+f.substr(i)+"E"})}else t=r.toExponential(n);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var Bc=/# (\?+)( ?)\/( ?)(\d+)/;function lh(e,r,t){var n=parseInt(e[4],10),a=Math.round(r*n),i=Math.floor(a/n),s=a-i*n,o=n;return t+(i===0?"":""+i)+" "+(s===0?Ge(" ",e[1].length+1+e[4].length):oo(s,e[1].length)+e[2]+"/"+e[3]+zr(o,e[4].length))}function fh(e,r,t){return t+(r===0?"":""+r)+Ge(" ",e[1].length+2+e[4].length)}var Lc=/^#*0*\.([0#]+)/,Uc=/\)[^)]*[0#]/,Wc=/\(###\) ###\\?-####/;function sr(e){for(var r="",t,n=0;n!=e.length;++n)switch(t=e.charCodeAt(n)){case 35:break;case 63:r+=" ";break;case 48:r+="0";break;default:r+=String.fromCharCode(t)}return r}function B0(e,r){var t=Math.pow(10,r);return""+Math.round(e*t)/t}function L0(e,r){var t=e-Math.floor(e),n=Math.pow(10,r);return r<(""+Math.round(t*n)).length?0:Math.round(t*n)}function uh(e,r){return r<(""+Math.round((e-Math.floor(e))*Math.pow(10,r))).length?1:0}function hh(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Rr(e,r,t){if(e.charCodeAt(0)===40&&!r.match(Uc)){var n=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?Rr("n",n,t):"("+Rr("n",n,-t)+")"}if(r.charCodeAt(r.length-1)===44)return ch(e,r,t);if(r.indexOf("%")!==-1)return oh(e,r,t);if(r.indexOf("E")!==-1)return Mc(r,t);if(r.charCodeAt(0)===36)return"$"+Rr(e,r.substr(r.charAt(1)==" "?2:1),t);var a,i,s,o,c=Math.abs(t),l=t<0?"-":"";if(r.match(/^00+$/))return l+ia(c,r.length);if(r.match(/^[#?]+$/))return a=ia(t,0),a==="0"&&(a=""),a.length>r.length?a:sr(r.substr(0,r.length-a.length))+a;if(i=r.match(Bc))return lh(i,c,l);if(r.match(/^#+0+$/))return l+ia(c,r.length-r.indexOf("0"));if(i=r.match(Lc))return a=B0(t,i[1].length).replace(/^([^\.]+)$/,"$1."+sr(i[1])).replace(/\.$/,"."+sr(i[1])).replace(/\.(\d*)$/,function(x,g){return"."+g+Ge("0",sr(i[1]).length-g.length)}),r.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),i=r.match(/^(0*)\.(#*)$/))return l+B0(c,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=r.match(/^#{1,3},##0(\.?)$/))return l+rn(ia(c,0));if(i=r.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+Rr(e,r,-t):rn(""+(Math.floor(t)+uh(t,i[1].length)))+"."+zr(L0(t,i[1].length),i[1].length);if(i=r.match(/^#,#*,#0/))return Rr(e,r.replace(/^#,#*,/,""),t);if(i=r.match(/^([0#]+)(\\?-([0#]+))+$/))return a=ca(Rr(e,r.replace(/[\\-]/g,""),t)),s=0,ca(ca(r.replace(/\\/g,"")).replace(/[0#]/g,function(x){return s<a.length?a.charAt(s++):x==="0"?"0":""}));if(r.match(Wc))return a=Rr(e,"##########",t),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var f="";if(i=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),o=Gi(c,Math.pow(10,s)-1,!1),a=""+l,f=an("n",i[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),a+=f+i[2]+"/"+i[3],f=zi(o[2],s),f.length<i[4].length&&(f=sr(i[4].substr(i[4].length-f.length))+f),a+=f,a;if(i=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),o=Gi(c,Math.pow(10,s)-1,!0),l+(o[0]||(o[1]?"":"0"))+" "+(o[1]?oo(o[1],s)+i[2]+"/"+i[3]+zi(o[2],s):Ge(" ",2*s+1+i[2].length+i[3].length));if(i=r.match(/^[#0?]+$/))return a=ia(t,0),r.length<=a.length?a:sr(r.substr(0,r.length-a.length))+a;if(i=r.match(/^([#0?]+)\.([#0]+)$/)){a=""+t.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=a.indexOf(".");var d=r.indexOf(".")-s,h=r.length-a.length-d;return sr(r.substr(0,d)+a+r.substr(r.length-h))}if(i=r.match(/^00,000\.([#0]*0)$/))return s=L0(t,i[1].length),t<0?"-"+Rr(e,r,-t):rn(hh(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?zr(0,3-x.length):"")+x})+"."+zr(s,i[1].length);switch(r){case"###,##0.00":return Rr(e,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var u=rn(ia(c,0));return u!=="0"?l+u:"";case"###,###.00":return Rr(e,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return Rr(e,"#,##0.00",t).replace(/^0\./,".");default:}throw new Error("unsupported format |"+r+"|")}function dh(e,r,t){for(var n=r.length-1;r.charCodeAt(n-1)===44;)--n;return an(e,r.substr(0,n),t/Math.pow(10,3*(r.length-n)))}function ph(e,r,t){var n=r.replace(Ic,""),a=r.length-n.length;return an(e,n,t*Math.pow(10,2*a))+Ge("%",a)}function Vc(e,r){var t,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+Vc(e,-r);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var i=Math.floor(Math.log(r)*Math.LOG10E)%a;if(i<0&&(i+=a),t=(r/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),!t.match(/[Ee]/)){var s=Math.floor(Math.log(r)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(s-t.length+i):t+="E+"+(s-i),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,l,f){return c+l+f.substr(0,(a+i)%a)+"."+f.substr(i)+"E"})}else t=r.toExponential(n);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function qr(e,r,t){if(e.charCodeAt(0)===40&&!r.match(Uc)){var n=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?qr("n",n,t):"("+qr("n",n,-t)+")"}if(r.charCodeAt(r.length-1)===44)return dh(e,r,t);if(r.indexOf("%")!==-1)return ph(e,r,t);if(r.indexOf("E")!==-1)return Vc(r,t);if(r.charCodeAt(0)===36)return"$"+qr(e,r.substr(r.charAt(1)==" "?2:1),t);var a,i,s,o,c=Math.abs(t),l=t<0?"-":"";if(r.match(/^00+$/))return l+zr(c,r.length);if(r.match(/^[#?]+$/))return a=""+t,t===0&&(a=""),a.length>r.length?a:sr(r.substr(0,r.length-a.length))+a;if(i=r.match(Bc))return fh(i,c,l);if(r.match(/^#+0+$/))return l+zr(c,r.length-r.indexOf("0"));if(i=r.match(Lc))return a=(""+t).replace(/^([^\.]+)$/,"$1."+sr(i[1])).replace(/\.$/,"."+sr(i[1])),a=a.replace(/\.(\d*)$/,function(x,g){return"."+g+Ge("0",sr(i[1]).length-g.length)}),r.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),i=r.match(/^(0*)\.(#*)$/))return l+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=r.match(/^#{1,3},##0(\.?)$/))return l+rn(""+c);if(i=r.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+qr(e,r,-t):rn(""+t)+"."+Ge("0",i[1].length);if(i=r.match(/^#,#*,#0/))return qr(e,r.replace(/^#,#*,/,""),t);if(i=r.match(/^([0#]+)(\\?-([0#]+))+$/))return a=ca(qr(e,r.replace(/[\\-]/g,""),t)),s=0,ca(ca(r.replace(/\\/g,"")).replace(/[0#]/g,function(x){return s<a.length?a.charAt(s++):x==="0"?"0":""}));if(r.match(Wc))return a=qr(e,"##########",t),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var f="";if(i=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),o=Gi(c,Math.pow(10,s)-1,!1),a=""+l,f=an("n",i[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),a+=f+i[2]+"/"+i[3],f=zi(o[2],s),f.length<i[4].length&&(f=sr(i[4].substr(i[4].length-f.length))+f),a+=f,a;if(i=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),o=Gi(c,Math.pow(10,s)-1,!0),l+(o[0]||(o[1]?"":"0"))+" "+(o[1]?oo(o[1],s)+i[2]+"/"+i[3]+zi(o[2],s):Ge(" ",2*s+1+i[2].length+i[3].length));if(i=r.match(/^[#0?]+$/))return a=""+t,r.length<=a.length?a:sr(r.substr(0,r.length-a.length))+a;if(i=r.match(/^([#0]+)\.([#0]+)$/)){a=""+t.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=a.indexOf(".");var d=r.indexOf(".")-s,h=r.length-a.length-d;return sr(r.substr(0,d)+a+r.substr(r.length-h))}if(i=r.match(/^00,000\.([#0]*0)$/))return t<0?"-"+qr(e,r,-t):rn(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?zr(0,3-x.length):"")+x})+"."+zr(0,i[1].length);switch(r){case"###,###":case"##,###":case"#,###":var u=rn(""+c);return u!=="0"?l+u:"";default:if(r.match(/\.[0#?]*$/))return qr(e,r.slice(0,r.lastIndexOf(".")),t)+sr(r.slice(r.lastIndexOf(".")))}throw new Error("unsupported format |"+r+"|")}function an(e,r,t){return(t|0)===t?qr(e,r,t):Rr(e,r,t)}function mh(e){for(var r=[],t=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:t=!t;break;case 95:case 42:case 92:++n;break;case 59:r[r.length]=e.substr(a,n-a),a=n+1}if(r[r.length]=e.substr(a),t===!0)throw new Error("Format |"+e+"| unterminated string ");return r}var Hc=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Xr(e){for(var r=0,t="",n="";r<e.length;)switch(t=e.charAt(r)){case"G":Xi(e,r)&&(r+=6),r++;break;case'"':for(;e.charCodeAt(++r)!==34&&r<e.length;);++r;break;case"\\":r+=2;break;case"_":r+=2;break;case"@":++r;break;case"B":case"b":if(e.charAt(r+1)==="1"||e.charAt(r+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"\u4E0A":if(e.substr(r,3).toUpperCase()==="A/P"||e.substr(r,5).toUpperCase()==="AM/PM"||e.substr(r,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348")return!0;++r;break;case"[":for(n=t;e.charAt(r++)!=="]"&&r<e.length;)n+=e.charAt(r);if(n.match(Hc))return!0;break;case".":case"0":case"#":for(;r<e.length&&("0#?.,E+-%".indexOf(t=e.charAt(++r))>-1||t=="\\"&&e.charAt(r+1)=="-"&&"0#".indexOf(e.charAt(r+2))>-1););break;case"?":for(;e.charAt(++r)===t;);break;case"*":++r,(e.charAt(r)==" "||e.charAt(r)=="*")&&++r;break;case"(":case")":++r;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;r<e.length&&"0123456789".indexOf(e.charAt(++r))>-1;);break;case" ":++r;break;default:++r;break}return!1}function xh(e,r,t,n){for(var a=[],i="",s=0,o="",c="t",l,f,d,h="H";s<e.length;)switch(o=e.charAt(s)){case"G":if(!Xi(e,s))throw new Error("unrecognized character "+o+" in "+e);a[a.length]={t:"G",v:"General"},s+=7;break;case'"':for(i="";(d=e.charCodeAt(++s))!==34&&s<e.length;)i+=String.fromCharCode(d);a[a.length]={t:"t",v:i},++s;break;case"\\":var u=e.charAt(++s),x=u==="("||u===")"?u:"t";a[a.length]={t:x,v:u},++s;break;case"_":a[a.length]={t:"t",v:" "},s+=2;break;case"@":a[a.length]={t:"T",v:r},++s;break;case"B":case"b":if(e.charAt(s+1)==="1"||e.charAt(s+1)==="2"){if(l==null&&(l=tn(r,t,e.charAt(s+1)==="2"),l==null))return"";a[a.length]={t:"X",v:e.substr(s,2)},c=o,s+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(r<0||l==null&&(l=tn(r,t),l==null))return"";for(i=o;++s<e.length&&e.charAt(s).toLowerCase()===o;)i+=o;o==="m"&&c.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=h),a[a.length]={t:o,v:i},c=o;break;case"A":case"a":case"\u4E0A":var g={t:o,v:o};if(l==null&&(l=tn(r,t)),e.substr(s,3).toUpperCase()==="A/P"?(l!=null&&(g.v=l.H>=12?e.charAt(s+2):o),g.t="T",h="h",s+=3):e.substr(s,5).toUpperCase()==="AM/PM"?(l!=null&&(g.v=l.H>=12?"PM":"AM"),g.t="T",s+=5,h="h"):e.substr(s,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348"?(l!=null&&(g.v=l.H>=12?"\u4E0B\u5348":"\u4E0A\u5348"),g.t="T",s+=5,h="h"):(g.t="t",++s),l==null&&g.t==="T")return"";a[a.length]=g,c=o;break;case"[":for(i=o;e.charAt(s++)!=="]"&&s<e.length;)i+=e.charAt(s);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(Hc)){if(l==null&&(l=tn(r,t),l==null))return"";a[a.length]={t:"Z",v:i.toLowerCase()},c=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",Xr(e)||(a[a.length]={t:"t",v:i}));break;case".":if(l!=null){for(i=o;++s<e.length&&(o=e.charAt(s))==="0";)i+=o;a[a.length]={t:"s",v:i};break}case"0":case"#":for(i=o;++s<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(s))>-1;)i+=o;a[a.length]={t:"n",v:i};break;case"?":for(i=o;e.charAt(++s)===o;)i+=o;a[a.length]={t:o,v:i},c=o;break;case"*":++s,(e.charAt(s)==" "||e.charAt(s)=="*")&&++s;break;case"(":case")":a[a.length]={t:n===1?"t":o,v:o},++s;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=o;s<e.length&&"0123456789".indexOf(e.charAt(++s))>-1;)i+=e.charAt(s);a[a.length]={t:"D",v:i};break;case" ":a[a.length]={t:o,v:o},++s;break;case"$":a[a.length]={t:"t",v:"$"},++s;break;default:if(",$-+/():!^&'~{}<>=\u20ACacfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);a[a.length]={t:"t",v:o},++s;break}var p=0,m=0,w;for(s=a.length-1,c="t";s>=0;--s)switch(a[s].t){case"h":case"H":a[s].t=h,c="h",p<1&&(p=1);break;case"s":(w=a[s].v.match(/\.0+$/))&&(m=Math.max(m,w[0].length-1),p=4),p<3&&(p=3);case"d":case"y":case"e":c=a[s].t;break;case"M":c=a[s].t,p<2&&(p=2);break;case"m":c==="s"&&(a[s].t="M",p<2&&(p=2));break;case"X":break;case"Z":p<1&&a[s].v.match(/[Hh]/)&&(p=1),p<2&&a[s].v.match(/[Mm]/)&&(p=2),p<3&&a[s].v.match(/[Ss]/)&&(p=3)}var _;switch(p){case 0:break;case 1:case 2:case 3:l.u>=.5&&(l.u=0,++l.S),l.S>=60&&(l.S=0,++l.M),l.M>=60&&(l.M=0,++l.H),l.H>=24&&(l.H=0,++l.D,_=tn(l.D),_.u=l.u,_.S=l.S,_.M=l.M,_.H=l.H,l=_);break;case 4:switch(m){case 1:l.u=Math.round(l.u*10)/10;break;case 2:l.u=Math.round(l.u*100)/100;break;case 3:l.u=Math.round(l.u*1e3)/1e3;break}l.u>=1&&(l.u=0,++l.S),l.S>=60&&(l.S=0,++l.M),l.M>=60&&(l.M=0,++l.H),l.H>=24&&(l.H=0,++l.D,_=tn(l.D),_.u=l.u,_.S=l.S,_.M=l.M,_.H=l.H,l=_);break}var F="",N;for(s=0;s<a.length;++s)switch(a[s].t){case"t":case"T":case" ":case"D":break;case"X":a[s].v="",a[s].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[s].v=sh(a[s].t.charCodeAt(0),a[s].v,l,m),a[s].t="t";break;case"n":case"?":for(N=s+1;a[N]!=null&&((o=a[N].t)==="?"||o==="D"||(o===" "||o==="t")&&a[N+1]!=null&&(a[N+1].t==="?"||a[N+1].t==="t"&&a[N+1].v==="/")||a[s].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(a[N].v==="/"||a[N].v===" "&&a[N+1]!=null&&a[N+1].t=="?"));)a[s].v+=a[N].v,a[N]={v:"",t:";"},++N;F+=a[s].v,s=N-1;break;case"G":a[s].t="t",a[s].v=Ln(r,t);break}var j="",O,P;if(F.length>0){F.charCodeAt(0)==40?(O=r<0&&F.charCodeAt(0)===45?-r:r,P=an("n",F,O)):(O=r<0&&n>1?-r:r,P=an("n",F,O),O<0&&a[0]&&a[0].t=="t"&&(P=P.substr(1),a[0].v="-"+a[0].v)),N=P.length-1;var D=a.length;for(s=0;s<a.length;++s)if(a[s]!=null&&a[s].t!="t"&&a[s].v.indexOf(".")>-1){D=s;break}var W=a.length;if(D===a.length&&P.indexOf("E")===-1){for(s=a.length-1;s>=0;--s)a[s]==null||"n?".indexOf(a[s].t)===-1||(N>=a[s].v.length-1?(N-=a[s].v.length,a[s].v=P.substr(N+1,a[s].v.length)):N<0?a[s].v="":(a[s].v=P.substr(0,N+1),N=-1),a[s].t="t",W=s);N>=0&&W<a.length&&(a[W].v=P.substr(0,N+1)+a[W].v)}else if(D!==a.length&&P.indexOf("E")===-1){for(N=P.indexOf(".")-1,s=D;s>=0;--s)if(!(a[s]==null||"n?".indexOf(a[s].t)===-1)){for(f=a[s].v.indexOf(".")>-1&&s===D?a[s].v.indexOf(".")-1:a[s].v.length-1,j=a[s].v.substr(f+1);f>=0;--f)N>=0&&(a[s].v.charAt(f)==="0"||a[s].v.charAt(f)==="#")&&(j=P.charAt(N--)+j);a[s].v=j,a[s].t="t",W=s}for(N>=0&&W<a.length&&(a[W].v=P.substr(0,N+1)+a[W].v),N=P.indexOf(".")+1,s=D;s<a.length;++s)if(!(a[s]==null||"n?(".indexOf(a[s].t)===-1&&s!==D)){for(f=a[s].v.indexOf(".")>-1&&s===D?a[s].v.indexOf(".")+1:0,j=a[s].v.substr(0,f);f<a[s].v.length;++f)N<P.length&&(j+=P.charAt(N++));a[s].v=j,a[s].t="t",W=s}}}for(s=0;s<a.length;++s)a[s]!=null&&"n?".indexOf(a[s].t)>-1&&(O=n>1&&r<0&&s>0&&a[s-1].v==="-"?-r:r,a[s].v=an(a[s].t,a[s].v,O),a[s].t="t");var B="";for(s=0;s!==a.length;++s)a[s]!=null&&(B+=a[s].v);return B}var U0=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function W0(e,r){if(r==null)return!1;var t=parseFloat(r[2]);switch(r[1]){case"=":if(e==t)return!0;break;case">":if(e>t)return!0;break;case"<":if(e<t)return!0;break;case"<>":if(e!=t)return!0;break;case">=":if(e>=t)return!0;break;case"<=":if(e<=t)return!0;break}return!1}function gh(e,r){var t=mh(e),n=t.length,a=t[n-1].indexOf("@");if(n<4&&a>-1&&--n,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof r!="number")return[4,t.length===4||a>-1?t[t.length-1]:"@"];switch(typeof r=="number"&&!isFinite(r)&&(r=0),t.length){case 1:t=a>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=a>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=a>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break;case 4:break}var i=r>0?t[0]:r<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[n,i];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var s=t[0].match(U0),o=t[1].match(U0);return W0(r,s)?[n,t[0]]:W0(r,o)?[n,t[1]]:[n,t[s!=null&&o!=null?2:1]]}return[n,i]}function kr(e,r,t){t==null&&(t={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&t.dateNF?n=t.dateNF:n=e;break;case"number":e==14&&t.dateNF?n=t.dateNF:n=(t.table!=null?t.table:De)[e],n==null&&(n=t.table&&t.table[M0[e]]||De[M0[e]]),n==null&&(n=eh[e]||"General");break}if(Xi(n,0))return Ln(r,t);r instanceof Date&&(r=Mt(r,t.date1904));var a=gh(n,r);if(Xi(a[1]))return Ln(r,t);if(r===!0)r="TRUE";else if(r===!1)r="FALSE";else{if(r===""||r==null)return"";if(isNaN(r)&&a[1].indexOf("0")>-1)return"#NUM!";if(!isFinite(r)&&a[1].indexOf("0")>-1)return"#DIV/0!"}return xh(a[1],r,t,a[0])}function _h(e,r){if(typeof r!="number"){r=+r||-1;for(var t=0;t<392;++t){if(De[t]==null){r<0&&(r=t);continue}if(De[t]==e){r=t;break}}r<0&&(r=391)}return De[r]=e,r}function zc(){De=Qu()}var vh={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},ji=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function wh(e){var r=typeof e=="number"?De[e]:e;return r=r.replace(ji,"(\\d+)"),ji.lastIndex=0,new RegExp("^"+r+"$")}function yh(e,r,t){var n=-1,a=-1,i=-1,s=-1,o=-1,c=-1;(r.match(ji)||[]).forEach(function(d,h){var u=parseInt(t[h+1],10);switch(d.toLowerCase().charAt(0)){case"y":n=u;break;case"d":i=u;break;case"h":s=u;break;case"s":c=u;break;case"m":s>=0?o=u:a=u;break}}),ji.lastIndex=0,c>=0&&o==-1&&a>=0&&(o=a,a=-1);var l=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);l.length==7&&(l="0"+l),l.length==8&&(l="20"+l);var f=("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return s==-1&&o==-1&&c==-1?l:n==-1&&a==-1&&i==-1?f:l+"T"+f}var Sh={"d.m":"d\\.m"};function Pn(e,r){return _h(Sh[e]||e,r)}var V0=(function(){var e={};e.version="1.2.0";function r(){for(var O=0,P=new Array(256),D=0;D!=256;++D)O=D,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,P[D]=O;return typeof Int32Array<"u"?new Int32Array(P):P}var t=r();function n(O){var P=0,D=0,W=0,B=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(W=0;W!=256;++W)B[W]=O[W];for(W=0;W!=256;++W)for(D=O[W],P=256+W;P<4096;P+=256)D=B[P]=D>>>8^O[D&255];var U=[];for(W=1;W!=16;++W)U[W-1]=typeof Int32Array<"u"&&typeof B.subarray=="function"?B.subarray(W*256,W*256+256):B.slice(W*256,W*256+256);return U}var a=n(t),i=a[0],s=a[1],o=a[2],c=a[3],l=a[4],f=a[5],d=a[6],h=a[7],u=a[8],x=a[9],g=a[10],p=a[11],m=a[12],w=a[13],_=a[14];function F(O,P){for(var D=P^-1,W=0,B=O.length;W<B;)D=D>>>8^t[(D^O.charCodeAt(W++))&255];return~D}function N(O,P){for(var D=P^-1,W=O.length-15,B=0;B<W;)D=_[O[B++]^D&255]^w[O[B++]^D>>8&255]^m[O[B++]^D>>16&255]^p[O[B++]^D>>>24]^g[O[B++]]^x[O[B++]]^u[O[B++]]^h[O[B++]]^d[O[B++]]^f[O[B++]]^l[O[B++]]^c[O[B++]]^o[O[B++]]^s[O[B++]]^i[O[B++]]^t[O[B++]];for(W+=15;B<W;)D=D>>>8^t[(D^O[B++])&255];return~D}function j(O,P){for(var D=P^-1,W=0,B=O.length,U=0,K=0;W<B;)U=O.charCodeAt(W++),U<128?D=D>>>8^t[(D^U)&255]:U<2048?(D=D>>>8^t[(D^(192|U>>6&31))&255],D=D>>>8^t[(D^(128|U&63))&255]):U>=55296&&U<57344?(U=(U&1023)+64,K=O.charCodeAt(W++)&1023,D=D>>>8^t[(D^(240|U>>8&7))&255],D=D>>>8^t[(D^(128|U>>2&63))&255],D=D>>>8^t[(D^(128|K>>6&15|(U&3)<<4))&255],D=D>>>8^t[(D^(128|K&63))&255]):(D=D>>>8^t[(D^(224|U>>12&15))&255],D=D>>>8^t[(D^(128|U>>6&63))&255],D=D>>>8^t[(D^(128|U&63))&255]);return~D}return e.table=t,e.bstr=F,e.buf=N,e.str=j,e})(),je=(function(){var r={};r.version="1.2.2";function t(v,E){for(var y=v.split("/"),S=E.split("/"),k=0,T=0,z=Math.min(y.length,S.length);k<z;++k){if(T=y[k].length-S[k].length)return T;if(y[k]!=S[k])return y[k]<S[k]?-1:1}return y.length-S.length}function n(v){if(v.charAt(v.length-1)=="/")return v.slice(0,-1).indexOf("/")===-1?v:n(v.slice(0,-1));var E=v.lastIndexOf("/");return E===-1?v:v.slice(0,E+1)}function a(v){if(v.charAt(v.length-1)=="/")return a(v.slice(0,-1));var E=v.lastIndexOf("/");return E===-1?v:v.slice(E+1)}function i(v,E){typeof E=="string"&&(E=new Date(E));var y=E.getHours();y=y<<6|E.getMinutes(),y=y<<5|E.getSeconds()>>>1,v.write_shift(2,y);var S=E.getFullYear()-1980;S=S<<4|E.getMonth()+1,S=S<<5|E.getDate(),v.write_shift(2,S)}function s(v){var E=v.read_shift(2)&65535,y=v.read_shift(2)&65535,S=new Date,k=y&31;y>>>=5;var T=y&15;y>>>=4,S.setMilliseconds(0),S.setFullYear(y+1980),S.setMonth(T-1),S.setDate(k);var z=E&31;E>>>=5;var Z=E&63;return E>>>=6,S.setHours(E),S.setMinutes(Z),S.setSeconds(z<<1),S}function o(v){It(v,0);for(var E={},y=0;v.l<=v.length-4;){var S=v.read_shift(2),k=v.read_shift(2),T=v.l+k,z={};switch(S){case 21589:y=v.read_shift(1),y&1&&(z.mtime=v.read_shift(4)),k>5&&(y&2&&(z.atime=v.read_shift(4)),y&4&&(z.ctime=v.read_shift(4))),z.mtime&&(z.mt=new Date(z.mtime*1e3));break;case 1:{var Z=v.read_shift(4),V=v.read_shift(4);z.usz=V*Math.pow(2,32)+Z,Z=v.read_shift(4),V=v.read_shift(4),z.csz=V*Math.pow(2,32)+Z}break}v.l=T,E[S]=z}return E}var c;function l(){return c||(c=Zs)}function f(v,E){if(v[0]==80&&v[1]==75)return Ko(v,E);if((v[0]|32)==109&&(v[1]|32)==105)return qf(v,E);if(v.length<512)throw new Error("CFB file size "+v.length+" < 512");var y=3,S=512,k=0,T=0,z=0,Z=0,V=0,H=[],X=v.slice(0,512);It(X,0);var ae=d(X);switch(y=ae[0],y){case 3:S=512;break;case 4:S=4096;break;case 0:if(ae[1]==0)return Ko(v,E);default:throw new Error("Major Version: Expected 3 or 4 saw "+y)}S!==512&&(X=v.slice(0,S),It(X,28));var ie=v.slice(0,S);h(X,y);var _e=X.read_shift(4,"i");if(y===3&&_e!==0)throw new Error("# Directory Sectors: Expected 0 saw "+_e);X.l+=4,z=X.read_shift(4,"i"),X.l+=4,X.chk("00100000","Mini Stream Cutoff Size: "),Z=X.read_shift(4,"i"),k=X.read_shift(4,"i"),V=X.read_shift(4,"i"),T=X.read_shift(4,"i");for(var le=-1,ne=0;ne<109&&(le=X.read_shift(4,"i"),!(le<0));++ne)H[ne]=le;var Oe=u(v,S);p(V,T,Oe,S,H);var pt=w(Oe,z,H,S);z<pt.length&&(pt[z].name="!Directory"),k>0&&Z!==K&&(pt[Z].name="!MiniFAT"),pt[H[0]].name="!FAT",pt.fat_addrs=H,pt.ssz=S;var fr={},Ft=[],xr=[],va=[];_(z,pt,Oe,Ft,k,fr,xr,Z),x(xr,va,Ft),Ft.shift();var wa={FileIndex:xr,FullPaths:va};return E&&E.raw&&(wa.raw={header:ie,sectors:Oe}),wa}function d(v){if(v[v.l]==80&&v[v.l+1]==75)return[0,0];v.chk(he,"Header Signature: "),v.l+=16;var E=v.read_shift(2,"u");return[v.read_shift(2,"u"),E]}function h(v,E){var y=9;switch(v.l+=2,y=v.read_shift(2)){case 9:if(E!=3)throw new Error("Sector Shift: Expected 9 saw "+y);break;case 12:if(E!=4)throw new Error("Sector Shift: Expected 12 saw "+y);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+y)}v.chk("0600","Mini Sector Shift: "),v.chk("000000000000","Reserved: ")}function u(v,E){for(var y=Math.ceil(v.length/E)-1,S=[],k=1;k<y;++k)S[k-1]=v.slice(k*E,(k+1)*E);return S[y-1]=v.slice(y*E),S}function x(v,E,y){for(var S=0,k=0,T=0,z=0,Z=0,V=y.length,H=[],X=[];S<V;++S)H[S]=X[S]=S,E[S]=y[S];for(;Z<X.length;++Z)S=X[Z],k=v[S].L,T=v[S].R,z=v[S].C,H[S]===S&&(k!==-1&&H[k]!==k&&(H[S]=H[k]),T!==-1&&H[T]!==T&&(H[S]=H[T])),z!==-1&&(H[z]=S),k!==-1&&S!=H[S]&&(H[k]=H[S],X.lastIndexOf(k)<Z&&X.push(k)),T!==-1&&S!=H[S]&&(H[T]=H[S],X.lastIndexOf(T)<Z&&X.push(T));for(S=1;S<V;++S)H[S]===S&&(T!==-1&&H[T]!==T?H[S]=H[T]:k!==-1&&H[k]!==k&&(H[S]=H[k]));for(S=1;S<V;++S)if(v[S].type!==0){if(Z=S,Z!=H[Z])do Z=H[Z],E[S]=E[Z]+"/"+E[S];while(Z!==0&&H[Z]!==-1&&Z!=H[Z]);H[S]=-1}for(E[0]+="/",S=1;S<V;++S)v[S].type!==2&&(E[S]+="/")}function g(v,E,y){for(var S=v.start,k=v.size,T=[],z=S;y&&k>0&&z>=0;)T.push(E.slice(z*U,z*U+U)),k-=U,z=On(y,z*4);return T.length===0?kt(0):mn(T).slice(0,v.size)}function p(v,E,y,S,k){var T=K;if(v===K){if(E!==0)throw new Error("DIFAT chain shorter than expected")}else if(v!==-1){var z=y[v],Z=(S>>>2)-1;if(!z)return;for(var V=0;V<Z&&(T=On(z,V*4))!==K;++V)k.push(T);E>=1&&p(On(z,S-4),E-1,y,S,k)}}function m(v,E,y,S,k){var T=[],z=[];k||(k=[]);var Z=S-1,V=0,H=0;for(V=E;V>=0;){k[V]=!0,T[T.length]=V,z.push(v[V]);var X=y[Math.floor(V*4/S)];if(H=V*4&Z,S<4+H)throw new Error("FAT boundary crossed: "+V+" 4 "+S);if(!v[X])break;V=On(v[X],H)}return{nodes:T,data:K0([z])}}function w(v,E,y,S){var k=v.length,T=[],z=[],Z=[],V=[],H=S-1,X=0,ae=0,ie=0,_e=0;for(X=0;X<k;++X)if(Z=[],ie=X+E,ie>=k&&(ie-=k),!z[ie]){V=[];var le=[];for(ae=ie;ae>=0;){le[ae]=!0,z[ae]=!0,Z[Z.length]=ae,V.push(v[ae]);var ne=y[Math.floor(ae*4/S)];if(_e=ae*4&H,S<4+_e)throw new Error("FAT boundary crossed: "+ae+" 4 "+S);if(!v[ne]||(ae=On(v[ne],_e),le[ae]))break}T[ie]={nodes:Z,data:K0([V])}}return T}function _(v,E,y,S,k,T,z,Z){for(var V=0,H=S.length?2:0,X=E[v].data,ae=0,ie=0,_e;ae<X.length;ae+=128){var le=X.slice(ae,ae+128);It(le,64),ie=le.read_shift(2),_e=ns(le,0,ie-H),S.push(_e);var ne={name:_e,type:le.read_shift(1),color:le.read_shift(1),L:le.read_shift(4,"i"),R:le.read_shift(4,"i"),C:le.read_shift(4,"i"),clsid:le.read_shift(16),state:le.read_shift(4,"i"),start:0,size:0},Oe=le.read_shift(2)+le.read_shift(2)+le.read_shift(2)+le.read_shift(2);Oe!==0&&(ne.ct=F(le,le.l-8));var pt=le.read_shift(2)+le.read_shift(2)+le.read_shift(2)+le.read_shift(2);pt!==0&&(ne.mt=F(le,le.l-8)),ne.start=le.read_shift(4,"i"),ne.size=le.read_shift(4,"i"),ne.size<0&&ne.start<0&&(ne.size=ne.type=0,ne.start=K,ne.name=""),ne.type===5?(V=ne.start,k>0&&V!==K&&(E[V].name="!StreamData")):ne.size>=4096?(ne.storage="fat",E[ne.start]===void 0&&(E[ne.start]=m(y,ne.start,E.fat_addrs,E.ssz)),E[ne.start].name=ne.name,ne.content=E[ne.start].data.slice(0,ne.size)):(ne.storage="minifat",ne.size<0?ne.size=0:V!==K&&ne.start!==K&&E[V]&&(ne.content=g(ne,E[V].data,(E[Z]||{}).data))),ne.content&&It(ne.content,0),T[_e]=ne,z.push(ne)}}function F(v,E){return new Date((Vt(v,E+4)/1e7*Math.pow(2,32)+Vt(v,E)/1e7-11644473600)*1e3)}function N(v,E){return l(),f(c.readFileSync(v),E)}function j(v,E){var y=E&&E.type;switch(y||He&&Buffer.isBuffer(v)&&(y="buffer"),y||"base64"){case"file":return N(v,E);case"base64":return f(wr(Sr(v)),E);case"binary":return f(wr(v),E)}return f(v,E)}function O(v,E){var y=E||{},S=y.root||"Root Entry";if(v.FullPaths||(v.FullPaths=[]),v.FileIndex||(v.FileIndex=[]),v.FullPaths.length!==v.FileIndex.length)throw new Error("inconsistent CFB structure");v.FullPaths.length===0&&(v.FullPaths[0]=S+"/",v.FileIndex[0]={name:S,type:5}),y.CLSID&&(v.FileIndex[0].clsid=y.CLSID),P(v)}function P(v){var E="Sh33tJ5";if(!je.find(v,"/"+E)){var y=kt(4);y[0]=55,y[1]=y[3]=50,y[2]=54,v.FileIndex.push({name:E,type:2,content:y,size:4,L:69,R:69,C:69}),v.FullPaths.push(v.FullPaths[0]+E),D(v)}}function D(v,E){O(v);for(var y=!1,S=!1,k=v.FullPaths.length-1;k>=0;--k){var T=v.FileIndex[k];switch(T.type){case 0:S?y=!0:(v.FileIndex.pop(),v.FullPaths.pop());break;case 1:case 2:case 5:S=!0,isNaN(T.R*T.L*T.C)&&(y=!0),T.R>-1&&T.L>-1&&T.R==T.L&&(y=!0);break;default:y=!0;break}}if(!(!y&&!E)){var z=new Date(1987,1,19),Z=0,V=Object.create?Object.create(null):{},H=[];for(k=0;k<v.FullPaths.length;++k)V[v.FullPaths[k]]=!0,v.FileIndex[k].type!==0&&H.push([v.FullPaths[k],v.FileIndex[k]]);for(k=0;k<H.length;++k){var X=n(H[k][0]);for(S=V[X];!S;){for(;n(X)&&!V[n(X)];)X=n(X);H.push([X,{name:a(X).replace("/",""),type:1,clsid:Ee,ct:z,mt:z,content:null}]),V[X]=!0,X=n(H[k][0]),S=V[X]}}for(H.sort(function(_e,le){return t(_e[0],le[0])}),v.FullPaths=[],v.FileIndex=[],k=0;k<H.length;++k)v.FullPaths[k]=H[k][0],v.FileIndex[k]=H[k][1];for(k=0;k<H.length;++k){var ae=v.FileIndex[k],ie=v.FullPaths[k];if(ae.name=a(ie).replace("/",""),ae.L=ae.R=ae.C=-(ae.color=1),ae.size=ae.content?ae.content.length:0,ae.start=0,ae.clsid=ae.clsid||Ee,k===0)ae.C=H.length>1?1:-1,ae.size=0,ae.type=5;else if(ie.slice(-1)=="/"){for(Z=k+1;Z<H.length&&n(v.FullPaths[Z])!=ie;++Z);for(ae.C=Z>=H.length?-1:Z,Z=k+1;Z<H.length&&n(v.FullPaths[Z])!=n(ie);++Z);ae.R=Z>=H.length?-1:Z,ae.type=1}else n(v.FullPaths[k+1]||"")==n(ie)&&(ae.R=k+1),ae.type=2}}}function W(v,E){var y=E||{};if(y.fileType=="mad")return Jf(v,y);switch(D(v),y.fileType){case"zip":return Gf(v,y)}var S=(function(_e){for(var le=0,ne=0,Oe=0;Oe<_e.FileIndex.length;++Oe){var pt=_e.FileIndex[Oe];if(pt.content){var fr=pt.content.length;fr>0&&(fr<4096?le+=fr+63>>6:ne+=fr+511>>9)}}for(var Ft=_e.FullPaths.length+3>>2,xr=le+7>>3,va=le+127>>7,wa=xr+ne+Ft+va,En=wa+127>>7,Rs=En<=109?0:Math.ceil((En-109)/127);wa+En+Rs+127>>7>En;)Rs=++En<=109?0:Math.ceil((En-109)/127);var Jr=[1,Rs,En,va,Ft,ne,le,0];return _e.FileIndex[0].size=le<<6,Jr[7]=(_e.FileIndex[0].start=Jr[0]+Jr[1]+Jr[2]+Jr[3]+Jr[4]+Jr[5])+(Jr[6]+7>>3),Jr})(v),k=kt(S[7]<<9),T=0,z=0;{for(T=0;T<8;++T)k.write_shift(1,re[T]);for(T=0;T<8;++T)k.write_shift(2,0);for(k.write_shift(2,62),k.write_shift(2,3),k.write_shift(2,65534),k.write_shift(2,9),k.write_shift(2,6),T=0;T<3;++T)k.write_shift(2,0);for(k.write_shift(4,0),k.write_shift(4,S[2]),k.write_shift(4,S[0]+S[1]+S[2]+S[3]-1),k.write_shift(4,0),k.write_shift(4,4096),k.write_shift(4,S[3]?S[0]+S[1]+S[2]-1:K),k.write_shift(4,S[3]),k.write_shift(-4,S[1]?S[0]-1:K),k.write_shift(4,S[1]),T=0;T<109;++T)k.write_shift(-4,T<S[2]?S[1]+T:-1)}if(S[1])for(z=0;z<S[1];++z){for(;T<236+z*127;++T)k.write_shift(-4,T<S[2]?S[1]+T:-1);k.write_shift(-4,z===S[1]-1?K:z+1)}var Z=function(_e){for(z+=_e;T<z-1;++T)k.write_shift(-4,T+1);_e&&(++T,k.write_shift(-4,K))};for(z=T=0,z+=S[1];T<z;++T)k.write_shift(-4,te.DIFSECT);for(z+=S[2];T<z;++T)k.write_shift(-4,te.FATSECT);Z(S[3]),Z(S[4]);for(var V=0,H=0,X=v.FileIndex[0];V<v.FileIndex.length;++V)X=v.FileIndex[V],X.content&&(H=X.content.length,!(H<4096)&&(X.start=z,Z(H+511>>9)));for(Z(S[6]+7>>3);k.l&511;)k.write_shift(-4,te.ENDOFCHAIN);for(z=T=0,V=0;V<v.FileIndex.length;++V)X=v.FileIndex[V],X.content&&(H=X.content.length,!(!H||H>=4096)&&(X.start=z,Z(H+63>>6)));for(;k.l&511;)k.write_shift(-4,te.ENDOFCHAIN);for(T=0;T<S[4]<<2;++T){var ae=v.FullPaths[T];if(!ae||ae.length===0){for(V=0;V<17;++V)k.write_shift(4,0);for(V=0;V<3;++V)k.write_shift(4,-1);for(V=0;V<12;++V)k.write_shift(4,0);continue}X=v.FileIndex[T],T===0&&(X.start=X.size?X.start-1:K);var ie=T===0&&y.root||X.name;if(ie.length>31&&(console.error("Name "+ie+" will be truncated to "+ie.slice(0,31)),ie=ie.slice(0,31)),H=2*(ie.length+1),k.write_shift(64,ie,"utf16le"),k.write_shift(2,H),k.write_shift(1,X.type),k.write_shift(1,X.color),k.write_shift(-4,X.L),k.write_shift(-4,X.R),k.write_shift(-4,X.C),X.clsid)k.write_shift(16,X.clsid,"hex");else for(V=0;V<4;++V)k.write_shift(4,0);k.write_shift(4,X.state||0),k.write_shift(4,0),k.write_shift(4,0),k.write_shift(4,0),k.write_shift(4,0),k.write_shift(4,X.start),k.write_shift(4,X.size),k.write_shift(4,0)}for(T=1;T<v.FileIndex.length;++T)if(X=v.FileIndex[T],X.size>=4096)if(k.l=X.start+1<<9,He&&Buffer.isBuffer(X.content))X.content.copy(k,k.l,0,X.size),k.l+=X.size+511&-512;else{for(V=0;V<X.size;++V)k.write_shift(1,X.content[V]);for(;V&511;++V)k.write_shift(1,0)}for(T=1;T<v.FileIndex.length;++T)if(X=v.FileIndex[T],X.size>0&&X.size<4096)if(He&&Buffer.isBuffer(X.content))X.content.copy(k,k.l,0,X.size),k.l+=X.size+63&-64;else{for(V=0;V<X.size;++V)k.write_shift(1,X.content[V]);for(;V&63;++V)k.write_shift(1,0)}if(He)k.l=k.length;else for(;k.l<k.length;)k.write_shift(1,0);return k}function B(v,E){var y=v.FullPaths.map(function(V){return V.toUpperCase()}),S=y.map(function(V){var H=V.split("/");return H[H.length-(V.slice(-1)=="/"?2:1)]}),k=!1;E.charCodeAt(0)===47?(k=!0,E=y[0].slice(0,-1)+E):k=E.indexOf("/")!==-1;var T=E.toUpperCase(),z=k===!0?y.indexOf(T):S.indexOf(T);if(z!==-1)return v.FileIndex[z];var Z=!T.match(Fa);for(T=T.replace(lr,""),Z&&(T=T.replace(Fa,"!")),z=0;z<y.length;++z)if((Z?y[z].replace(Fa,"!"):y[z]).replace(lr,"")==T||(Z?S[z].replace(Fa,"!"):S[z]).replace(lr,"")==T)return v.FileIndex[z];return null}var U=64,K=-2,he="d0cf11e0a1b11ae1",re=[208,207,17,224,161,177,26,225],Ee="00000000000000000000000000000000",te={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:K,FREESECT:-1,HEADER_SIGNATURE:he,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Ee,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ve(v,E,y){l();var S=W(v,y);c.writeFileSync(E,S)}function Te(v){for(var E=new Array(v.length),y=0;y<v.length;++y)E[y]=String.fromCharCode(v[y]);return E.join("")}function se(v,E){var y=W(v,E);switch(E&&E.type||"buffer"){case"file":return l(),c.writeFileSync(E.filename,y),y;case"binary":return typeof y=="string"?y:Te(y);case"base64":return O0(typeof y=="string"?y:Te(y));case"buffer":if(He)return Buffer.isBuffer(y)?y:yn(y);case"array":return typeof y=="string"?wr(y):y}return y}var Pe;function J(v){try{var E=v.InflateRaw,y=new E;if(y._processChunk(new Uint8Array([3,0]),y._finishFlushFlag),y.bytesRead)Pe=v;else throw new Error("zlib does not expose bytesRead")}catch(S){console.error("cannot use native zlib: "+(S.message||S))}}function ke(v,E){if(!Pe)return _a(v,E);var y=Pe.InflateRaw,S=new y,k=S._processChunk(v.slice(v.l),S._finishFlushFlag);return v.l+=S.bytesRead,k}function ge(v){return Pe?Pe.deflateRawSync(v):mr(v)}var Ue=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],we=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],be=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function b(v){var E=(v<<1|v<<11)&139536|(v<<5|v<<15)&558144;return(E>>16|E>>8|E)&255}for(var I=typeof Uint8Array<"u",R=I?new Uint8Array(256):[],A=0;A<256;++A)R[A]=b(A);function q(v,E){var y=R[v&255];return E<=8?y>>>8-E:(y=y<<8|R[v>>8&255],E<=16?y>>>16-E:(y=y<<8|R[v>>16&255],y>>>24-E))}function C(v,E){var y=E&7,S=E>>>3;return(v[S]|(y<=6?0:v[S+1]<<8))>>>y&3}function ye(v,E){var y=E&7,S=E>>>3;return(v[S]|(y<=5?0:v[S+1]<<8))>>>y&7}function ue(v,E){var y=E&7,S=E>>>3;return(v[S]|(y<=4?0:v[S+1]<<8))>>>y&15}function ee(v,E){var y=E&7,S=E>>>3;return(v[S]|(y<=3?0:v[S+1]<<8))>>>y&31}function Ce(v,E){var y=E&7,S=E>>>3;return(v[S]|(y<=1?0:v[S+1]<<8))>>>y&127}function Ne(v,E,y){var S=E&7,k=E>>>3,T=(1<<y)-1,z=v[k]>>>S;return y<8-S||(z|=v[k+1]<<8-S,y<16-S)||(z|=v[k+2]<<16-S,y<24-S)||(z|=v[k+3]<<24-S),z&T}function de(v,E,y){var S=E&7,k=E>>>3;return S<=5?v[k]|=(y&7)<<S:(v[k]|=y<<S&255,v[k+1]=(y&7)>>8-S),E+3}function et(v,E,y){var S=E&7,k=E>>>3;return y=(y&1)<<S,v[k]|=y,E+1}function ct(v,E,y){var S=E&7,k=E>>>3;return y<<=S,v[k]|=y&255,y>>>=8,v[k+1]=y,E+8}function _t(v,E,y){var S=E&7,k=E>>>3;return y<<=S,v[k]|=y&255,y>>>=8,v[k+1]=y&255,v[k+2]=y>>>8,E+16}function $t(v,E){var y=v.length,S=2*y>E?2*y:E+5,k=0;if(y>=E)return v;if(He){var T=P0(S);if(v.copy)v.copy(T);else for(;k<v.length;++k)T[k]=v[k];return T}else if(I){var z=new Uint8Array(S);if(z.set)z.set(v);else for(;k<y;++k)z[k]=v[k];return z}return v.length=S,v}function oe(v){for(var E=new Array(v),y=0;y<v;++y)E[y]=0;return E}function fe(v,E,y){var S=1,k=0,T=0,z=0,Z=0,V=v.length,H=I?new Uint16Array(32):oe(32);for(T=0;T<32;++T)H[T]=0;for(T=V;T<y;++T)v[T]=0;V=v.length;var X=I?new Uint16Array(V):oe(V);for(T=0;T<V;++T)H[k=v[T]]++,S<k&&(S=k),X[T]=0;for(H[0]=0,T=1;T<=S;++T)H[T+16]=Z=Z+H[T-1]<<1;for(T=0;T<V;++T)Z=v[T],Z!=0&&(X[T]=H[Z+16]++);var ae=0;for(T=0;T<V;++T)if(ae=v[T],ae!=0)for(Z=q(X[T],S)>>S-ae,z=(1<<S+4-ae)-1;z>=0;--z)E[Z|z<<ae]=ae&15|T<<4;return S}var Er=I?new Uint16Array(512):oe(512),Yt=I?new Uint16Array(32):oe(32);if(!I){for(var bt=0;bt<512;++bt)Er[bt]=0;for(bt=0;bt<32;++bt)Yt[bt]=0}(function(){for(var v=[],E=0;E<32;E++)v.push(5);fe(v,Yt,32);var y=[];for(E=0;E<=143;E++)y.push(8);for(;E<=255;E++)y.push(9);for(;E<=279;E++)y.push(7);for(;E<=287;E++)y.push(8);fe(y,Er,288)})();var ir=(function(){for(var E=I?new Uint8Array(32768):[],y=0,S=0;y<be.length-1;++y)for(;S<be[y+1];++S)E[S]=y;for(;S<32768;++S)E[S]=29;var k=I?new Uint8Array(259):[];for(y=0,S=0;y<we.length-1;++y)for(;S<we[y+1];++S)k[S]=y;function T(Z,V){for(var H=0;H<Z.length;){var X=Math.min(65535,Z.length-H),ae=H+X==Z.length;for(V.write_shift(1,+ae),V.write_shift(2,X),V.write_shift(2,~X&65535);X-- >0;)V[V.l++]=Z[H++]}return V.l}function z(Z,V){for(var H=0,X=0,ae=I?new Uint16Array(32768):[];X<Z.length;){var ie=Math.min(65535,Z.length-X);if(ie<10){for(H=de(V,H,+(X+ie==Z.length)),H&7&&(H+=8-(H&7)),V.l=H/8|0,V.write_shift(2,ie),V.write_shift(2,~ie&65535);ie-- >0;)V[V.l++]=Z[X++];H=V.l*8;continue}H=de(V,H,+(X+ie==Z.length)+2);for(var _e=0;ie-- >0;){var le=Z[X];_e=(_e<<5^le)&32767;var ne=-1,Oe=0;if((ne=ae[_e])&&(ne|=X&-32768,ne>X&&(ne-=32768),ne<X))for(;Z[ne+Oe]==Z[X+Oe]&&Oe<250;)++Oe;if(Oe>2){le=k[Oe],le<=22?H=ct(V,H,R[le+1]>>1)-1:(ct(V,H,3),H+=5,ct(V,H,R[le-23]>>5),H+=3);var pt=le<8?0:le-4>>2;pt>0&&(_t(V,H,Oe-we[le]),H+=pt),le=E[X-ne],H=ct(V,H,R[le]>>3),H-=3;var fr=le<4?0:le-2>>1;fr>0&&(_t(V,H,X-ne-be[le]),H+=fr);for(var Ft=0;Ft<Oe;++Ft)ae[_e]=X&32767,_e=(_e<<5^Z[X])&32767,++X;ie-=Oe-1}else le<=143?le=le+48:H=et(V,H,1),H=ct(V,H,R[le]),ae[_e]=X&32767,++X}H=ct(V,H,0)-1}return V.l=(H+7)/8|0,V.l}return function(V,H){return V.length<8?T(V,H):z(V,H)}})();function mr(v){var E=kt(50+Math.floor(v.length*1.1)),y=ir(v,E);return E.slice(0,y)}var Re=I?new Uint16Array(32768):oe(32768),Fe=I?new Uint16Array(32768):oe(32768),lt=I?new Uint16Array(128):oe(128),xt=1,ii=1;function ln(v,E){var y=ee(v,E)+257;E+=5;var S=ee(v,E)+1;E+=5;var k=ue(v,E)+4;E+=4;for(var T=0,z=I?new Uint8Array(19):oe(19),Z=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],V=1,H=I?new Uint8Array(8):oe(8),X=I?new Uint8Array(8):oe(8),ae=z.length,ie=0;ie<k;++ie)z[Ue[ie]]=T=ye(v,E),V<T&&(V=T),H[T]++,E+=3;var _e=0;for(H[0]=0,ie=1;ie<=V;++ie)X[ie]=_e=_e+H[ie-1]<<1;for(ie=0;ie<ae;++ie)(_e=z[ie])!=0&&(Z[ie]=X[_e]++);var le=0;for(ie=0;ie<ae;++ie)if(le=z[ie],le!=0){_e=R[Z[ie]]>>8-le;for(var ne=(1<<7-le)-1;ne>=0;--ne)lt[_e|ne<<le]=le&7|ie<<3}var Oe=[];for(V=1;Oe.length<y+S;)switch(_e=lt[Ce(v,E)],E+=_e&7,_e>>>=3){case 16:for(T=3+C(v,E),E+=2,_e=Oe[Oe.length-1];T-- >0;)Oe.push(_e);break;case 17:for(T=3+ye(v,E),E+=3;T-- >0;)Oe.push(0);break;case 18:for(T=11+Ce(v,E),E+=7;T-- >0;)Oe.push(0);break;default:Oe.push(_e),V<_e&&(V=_e);break}var pt=Oe.slice(0,y),fr=Oe.slice(y);for(ie=y;ie<286;++ie)pt[ie]=0;for(ie=S;ie<30;++ie)fr[ie]=0;return xt=fe(pt,Re,286),ii=fe(fr,Fe,30),E}function kn(v,E){if(v[0]==3&&!(v[1]&3))return[_n(E),2];for(var y=0,S=0,k=P0(E||1<<18),T=0,z=k.length>>>0,Z=0,V=0;(S&1)==0;){if(S=ye(v,y),y+=3,S>>>1)S>>1==1?(Z=9,V=5):(y=ln(v,y),Z=xt,V=ii);else{y&7&&(y+=8-(y&7));var H=v[y>>>3]|v[(y>>>3)+1]<<8;if(y+=32,H>0)for(!E&&z<T+H&&(k=$t(k,T+H),z=k.length);H-- >0;)k[T++]=v[y>>>3],y+=8;continue}for(;;){!E&&z<T+32767&&(k=$t(k,T+32767),z=k.length);var X=Ne(v,y,Z),ae=S>>>1==1?Er[X]:Re[X];if(y+=ae&15,ae>>>=4,(ae>>>8&255)===0)k[T++]=ae;else{if(ae==256)break;ae-=257;var ie=ae<8?0:ae-4>>2;ie>5&&(ie=0);var _e=T+we[ae];ie>0&&(_e+=Ne(v,y,ie),y+=ie),X=Ne(v,y,V),ae=S>>>1==1?Yt[X]:Fe[X],y+=ae&15,ae>>>=4;var le=ae<4?0:ae-2>>1,ne=be[ae];for(le>0&&(ne+=Ne(v,y,le),y+=le),!E&&z<_e&&(k=$t(k,_e+100),z=k.length);T<_e;)k[T]=k[T-ne],++T}}}return E?[k,y+7>>>3]:[k.slice(0,T),y+7>>>3]}function _a(v,E){var y=v.slice(v.l||0),S=kn(y,E);return v.l+=S[1],S[0]}function Yo(v,E){if(v)typeof console<"u"&&console.error(E);else throw new Error(E)}function Ko(v,E){var y=v;It(y,0);var S=[],k=[],T={FileIndex:S,FullPaths:k};O(T,{root:E.root});for(var z=y.length-4;(y[z]!=80||y[z+1]!=75||y[z+2]!=5||y[z+3]!=6)&&z>=0;)--z;y.l=z+4,y.l+=4;var Z=y.read_shift(2);y.l+=6;var V=y.read_shift(4);for(y.l=V,z=0;z<Z;++z){y.l+=20;var H=y.read_shift(4),X=y.read_shift(4),ae=y.read_shift(2),ie=y.read_shift(2),_e=y.read_shift(2);y.l+=8;var le=y.read_shift(4),ne=o(y.slice(y.l+ae,y.l+ae+ie));y.l+=ae+ie+_e;var Oe=y.l;y.l=le+4,ne&&ne[1]&&((ne[1]||{}).usz&&(X=ne[1].usz),(ne[1]||{}).csz&&(H=ne[1].csz)),Xf(y,H,X,T,ne),y.l=Oe}return T}function Xf(v,E,y,S,k){v.l+=2;var T=v.read_shift(2),z=v.read_shift(2),Z=s(v);if(T&8257)throw new Error("Unsupported ZIP encryption");for(var V=v.read_shift(4),H=v.read_shift(4),X=v.read_shift(4),ae=v.read_shift(2),ie=v.read_shift(2),_e="",le=0;le<ae;++le)_e+=String.fromCharCode(v[v.l++]);if(ie){var ne=o(v.slice(v.l,v.l+ie));(ne[21589]||{}).mt&&(Z=ne[21589].mt),(ne[1]||{}).usz&&(X=ne[1].usz),(ne[1]||{}).csz&&(H=ne[1].csz),k&&((k[21589]||{}).mt&&(Z=k[21589].mt),(k[1]||{}).usz&&(X=k[1].usz),(k[1]||{}).csz&&(H=k[1].csz))}v.l+=ie;var Oe=v.slice(v.l,v.l+H);switch(z){case 8:Oe=ke(v,X);break;case 0:v.l+=H;break;default:throw new Error("Unsupported ZIP Compression method "+z)}var pt=!1;T&8&&(V=v.read_shift(4),V==134695760&&(V=v.read_shift(4),pt=!0),H=v.read_shift(4),X=v.read_shift(4)),H!=E&&Yo(pt,"Bad compressed size: "+E+" != "+H),X!=y&&Yo(pt,"Bad uncompressed size: "+y+" != "+X),Ds(S,_e,Oe,{unsafe:!0,mt:Z})}function Gf(v,E){var y=E||{},S=[],k=[],T=kt(1),z=y.compression?8:0,Z=0,V=!1;V&&(Z|=8);var H=0,X=0,ae=0,ie=0,_e=v.FullPaths[0],le=_e,ne=v.FileIndex[0],Oe=[],pt=0;for(H=1;H<v.FullPaths.length;++H)if(le=v.FullPaths[H].slice(_e.length),ne=v.FileIndex[H],!(!ne.size||!ne.content||Array.isArray(ne.content)&&ne.content.length==0||le=="Sh33tJ5")){var fr=ae,Ft=kt(le.length);for(X=0;X<le.length;++X)Ft.write_shift(1,le.charCodeAt(X)&127);Ft=Ft.slice(0,Ft.l),Oe[ie]=typeof ne.content=="string"?V0.bstr(ne.content,0):V0.buf(ne.content,0);var xr=typeof ne.content=="string"?wr(ne.content):ne.content;z==8&&(xr=ge(xr)),T=kt(30),T.write_shift(4,67324752),T.write_shift(2,20),T.write_shift(2,Z),T.write_shift(2,z),ne.mt?i(T,ne.mt):T.write_shift(4,0),T.write_shift(-4,Z&8?0:Oe[ie]),T.write_shift(4,Z&8?0:xr.length),T.write_shift(4,Z&8?0:ne.content.length),T.write_shift(2,Ft.length),T.write_shift(2,0),ae+=T.length,S.push(T),ae+=Ft.length,S.push(Ft),ae+=xr.length,S.push(xr),Z&8&&(T=kt(12),T.write_shift(-4,Oe[ie]),T.write_shift(4,xr.length),T.write_shift(4,ne.content.length),ae+=T.l,S.push(T)),T=kt(46),T.write_shift(4,33639248),T.write_shift(2,0),T.write_shift(2,20),T.write_shift(2,Z),T.write_shift(2,z),T.write_shift(4,0),T.write_shift(-4,Oe[ie]),T.write_shift(4,xr.length),T.write_shift(4,ne.content.length),T.write_shift(2,Ft.length),T.write_shift(2,0),T.write_shift(2,0),T.write_shift(2,0),T.write_shift(2,0),T.write_shift(4,0),T.write_shift(4,fr),pt+=T.l,k.push(T),pt+=Ft.length,k.push(Ft),++ie}return T=kt(22),T.write_shift(4,101010256),T.write_shift(2,0),T.write_shift(2,0),T.write_shift(2,ie),T.write_shift(2,ie),T.write_shift(4,pt),T.write_shift(4,ae),T.write_shift(2,0),mn([mn(S),mn(k),T])}var si={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function jf(v,E){if(v.ctype)return v.ctype;var y=v.name||"",S=y.match(/\.([^\.]+)$/);return S&&si[S[1]]||E&&(S=(y=E).match(/[\.\\]([^\.\\])+$/),S&&si[S[1]])?si[S[1]]:"application/octet-stream"}function $f(v){for(var E=O0(v),y=[],S=0;S<E.length;S+=76)y.push(E.slice(S,S+76));return y.join(`\r
`)+`\r
`}function Yf(v){var E=v.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(H){var X=H.charCodeAt(0).toString(16).toUpperCase();return"="+(X.length==1?"0"+X:X)});E=E.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),E.charAt(0)==`
`&&(E="=0D"+E.slice(1)),E=E.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var y=[],S=E.split(`\r
`),k=0;k<S.length;++k){var T=S[k];if(T.length==0){y.push("");continue}for(var z=0;z<T.length;){var Z=76,V=T.slice(z,z+Z);V.charAt(Z-1)=="="?Z--:V.charAt(Z-2)=="="?Z-=2:V.charAt(Z-3)=="="&&(Z-=3),V=T.slice(z,z+Z),z+=Z,z<T.length&&(V+="="),y.push(V)}}return y.join(`\r
`)}function Kf(v){for(var E=[],y=0;y<v.length;++y){for(var S=v[y];y<=v.length&&S.charAt(S.length-1)=="=";)S=S.slice(0,S.length-1)+v[++y];E.push(S)}for(var k=0;k<E.length;++k)E[k]=E[k].replace(/[=][0-9A-Fa-f]{2}/g,function(T){return String.fromCharCode(parseInt(T.slice(1),16))});return wr(E.join(`\r
`))}function Zf(v,E,y){for(var S="",k="",T="",z,Z=0;Z<10;++Z){var V=E[Z];if(!V||V.match(/^\s*$/))break;var H=V.match(/^([^:]*?):\s*([^\s].*)$/);if(H)switch(H[1].toLowerCase()){case"content-location":S=H[2].trim();break;case"content-type":T=H[2].trim();break;case"content-transfer-encoding":k=H[2].trim();break}}switch(++Z,k.toLowerCase()){case"base64":z=wr(Sr(E.slice(Z).join("")));break;case"quoted-printable":z=Kf(E.slice(Z));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+k)}var X=Ds(v,S.slice(y.length),z,{unsafe:!0});T&&(X.ctype=T)}function qf(v,E){if(Te(v.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var y=E&&E.root||"",S=(He&&Buffer.isBuffer(v)?v.toString("binary"):Te(v)).split(`\r
`),k=0,T="";for(k=0;k<S.length;++k)if(T=S[k],!!/^Content-Location:/i.test(T)&&(T=T.slice(T.indexOf("file")),y||(y=T.slice(0,T.lastIndexOf("/")+1)),T.slice(0,y.length)!=y))for(;y.length>0&&(y=y.slice(0,y.length-1),y=y.slice(0,y.lastIndexOf("/")+1),T.slice(0,y.length)!=y););var z=(S[1]||"").match(/boundary="(.*?)"/);if(!z)throw new Error("MAD cannot find boundary");var Z="--"+(z[1]||""),V=[],H=[],X={FileIndex:V,FullPaths:H};O(X);var ae,ie=0;for(k=0;k<S.length;++k){var _e=S[k];_e!==Z&&_e!==Z+"--"||(ie++&&Zf(X,S.slice(ae,k),y),ae=k)}return X}function Jf(v,E){var y=E||{},S=y.boundary||"SheetJS";S="------="+S;for(var k=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+S.slice(2)+'"',"","",""],T=v.FullPaths[0],z=T,Z=v.FileIndex[0],V=1;V<v.FullPaths.length;++V)if(z=v.FullPaths[V].slice(T.length),Z=v.FileIndex[V],!(!Z.size||!Z.content||z=="Sh33tJ5")){z=z.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Oe){return"_x"+Oe.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Oe){return"_u"+Oe.charCodeAt(0).toString(16)+"_"});for(var H=Z.content,X=He&&Buffer.isBuffer(H)?H.toString("binary"):Te(H),ae=0,ie=Math.min(1024,X.length),_e=0,le=0;le<=ie;++le)(_e=X.charCodeAt(le))>=32&&_e<128&&++ae;var ne=ae>=ie*4/5;k.push(S),k.push("Content-Location: "+(y.root||"file:///C:/SheetJS/")+z),k.push("Content-Transfer-Encoding: "+(ne?"quoted-printable":"base64")),k.push("Content-Type: "+jf(Z,z)),k.push(""),k.push(ne?Yf(X):$f(X))}return k.push(S+`--\r
`),k.join(`\r
`)}function Qf(v){var E={};return O(E,v),E}function Ds(v,E,y,S){var k=S&&S.unsafe;k||O(v);var T=!k&&je.find(v,E);if(!T){var z=v.FullPaths[0];E.slice(0,z.length)==z?z=E:(z.slice(-1)!="/"&&(z+="/"),z=(z+E).replace("//","/")),T={name:a(E),type:2},v.FileIndex.push(T),v.FullPaths.push(z),k||je.utils.cfb_gc(v)}return T.content=y,T.size=y?y.length:0,S&&(S.CLSID&&(T.clsid=S.CLSID),S.mt&&(T.mt=S.mt),S.ct&&(T.ct=S.ct)),T}function eu(v,E){O(v);var y=je.find(v,E);if(y){for(var S=0;S<v.FileIndex.length;++S)if(v.FileIndex[S]==y)return v.FileIndex.splice(S,1),v.FullPaths.splice(S,1),!0}return!1}function tu(v,E,y){O(v);var S=je.find(v,E);if(S){for(var k=0;k<v.FileIndex.length;++k)if(v.FileIndex[k]==S)return v.FileIndex[k].name=a(y),v.FullPaths[k]=y,!0}return!1}function ru(v){D(v,!0)}return r.find=B,r.read=j,r.parse=f,r.write=se,r.writeFile=ve,r.utils={cfb_new:Qf,cfb_add:Ds,cfb_del:eu,cfb_mov:tu,cfb_gc:ru,ReadShift:Ra,CheckField:ll,prep_blob:It,bconcat:mn,use_zlib:J,_deflateRaw:mr,_inflateRaw:_a,consts:te},r})(),Zs;function kh(e){if(typeof Zs<"u")return Zs.readFileSync(e);if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var r=File(e);r.open("r"),r.encoding="binary";var t=r.read();return r.close(),t}catch(n){if(!n.message||n.message.indexOf("onstruct")==-1)throw n}throw new Error("Cannot access file "+e)}function Pr(e){for(var r=Object.keys(e),t=[],n=0;n<r.length;++n)Object.prototype.hasOwnProperty.call(e,r[n])&&t.push(r[n]);return t}function lo(e){for(var r=[],t=Pr(e),n=0;n!==t.length;++n)r[e[t[n]]]=t[n];return r}var Xc=Date.UTC(1899,11,30,0,0,0),Eh=Date.UTC(1899,11,31,0,0,0),Ch=Date.UTC(1904,0,1,0,0,0);function Mt(e,r){var t=e.getTime(),n=(t-Xc)/(1440*60*1e3);return r?(n-=1462,n<-1402?n-1:n):n<60?n-1:n}function gn(e){if(e>=60&&e<61)return e;var r=new Date;return r.setTime((e>60?e:e+1)*24*60*60*1e3+Xc),r}function Th(e){var r=0,t=0,n=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var i=1;i!=a.length;++i)if(a[i]){switch(t=1,i>3&&(n=!0),a[i].slice(a[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[i].slice(a[i].length-1));case"D":t*=24;case"H":t*=60;case"M":if(n)t*=60;else throw new Error("Unsupported ISO Duration Field: M");case"S":break}r+=t*parseInt(a[i],10)}return r}var bh=/^(\d+):(\d+)(:\d+)?(\.\d+)?$/,Fh=/^(\d+)-(\d+)-(\d+)$/,Gc=/^(\d+)-(\d+)-(\d+)[T ](\d+):(\d+)(:\d+)?(\.\d+)?$/;function Gt(e,r){if(e instanceof Date)return e;var t=e.match(bh);if(t)return new Date((r?Ch:Eh)+((parseInt(t[1],10)*60+parseInt(t[2],10))*60+(t[3]?parseInt(t[3].slice(1),10):0))*1e3+(t[4]?parseInt((t[4]+"000").slice(1,4),10):0));if(t=e.match(Fh),t)return new Date(Date.UTC(+t[1],+t[2]-1,+t[3],0,0,0,0));if(t=e.match(Gc),t)return new Date(Date.UTC(+t[1],+t[2]-1,+t[3],+t[4],+t[5],t[6]&&parseInt(t[6].slice(1),10)||0,t[7]&&parseInt((t[7]+"0000").slice(1,4),10)||0));var n=new Date(e);return n}function Un(e,r){if(He&&Buffer.isBuffer(e)){if(r&&Va){if(e[0]==255&&e[1]==254)return Aa(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Aa(Nc(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(r){if(e[0]==255&&e[1]==254)return Aa(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Aa(new TextDecoder("utf-16be").decode(e.slice(2)))}var t={"\u20AC":"\x80","\u201A":"\x82",\u0192:"\x83","\u201E":"\x84","\u2026":"\x85","\u2020":"\x86","\u2021":"\x87","\u02C6":"\x88","\u2030":"\x89",\u0160:"\x8A","\u2039":"\x8B",\u0152:"\x8C",\u017D:"\x8E","\u2018":"\x91","\u2019":"\x92","\u201C":"\x93","\u201D":"\x94","\u2022":"\x95","\u2013":"\x96","\u2014":"\x97","\u02DC":"\x98","\u2122":"\x99",\u0161:"\x9A","\u203A":"\x9B",\u0153:"\x9C",\u017E:"\x9E",\u0178:"\x9F"};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(i){return t[i]||i})}catch{}var n=[],a=0;try{for(a=0;a<e.length-65536;a+=65536)n.push(String.fromCharCode.apply(0,e.slice(a,a+65536)));n.push(String.fromCharCode.apply(0,e.slice(a)))}catch{try{for(;a<e.length-16384;a+=16384)n.push(String.fromCharCode.apply(0,e.slice(a,a+16384)));n.push(String.fromCharCode.apply(0,e.slice(a)))}catch{for(;a!=e.length;++a)n.push(String.fromCharCode(e[a]))}}return n.join("")}function Nt(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var r={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=Nt(e[t]));return r}function Ge(e,r){for(var t="";t.length<r;)t+=e;return t}function yr(e){var r=Number(e);if(!isNaN(r))return isFinite(r)?r:NaN;if(!/\d/.test(e))return r;var t=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(r=Number(n))||(n=n.replace(/[(]([^()]*)[)]/,function(a,i){return t=-t,i}),!isNaN(r=Number(n)))?r/t:r}var Ah=/^(0?\d|1[0-2])(?:|:([0-5]?\d)(?:|(\.\d+)(?:|:([0-5]?\d))|:([0-5]?\d)(|\.\d+)))\s+([ap])m?$/,Dh=/^([01]?\d|2[0-3])(?:|:([0-5]?\d)(?:|(\.\d+)(?:|:([0-5]?\d))|:([0-5]?\d)(|\.\d+)))$/,Rh=/^(\d+)-(\d+)-(\d+)[T ](\d+):(\d+)(:\d+)(\.\d+)?[Z]?$/,Oh=new Date("6/9/69 00:00 UTC").valueOf()==-177984e5;function Ph(e){return e[2]?e[3]?e[4]?new Date(Date.UTC(1899,11,31,+e[1]%12+(e[7]=="p"?12:0),+e[2],+e[4],parseFloat(e[3])*1e3)):new Date(Date.UTC(1899,11,31,e[7]=="p"?12:0,+e[1],+e[2],parseFloat(e[3])*1e3)):e[5]?new Date(Date.UTC(1899,11,31,+e[1]%12+(e[7]=="p"?12:0),+e[2],+e[5],e[6]?parseFloat(e[6])*1e3:0)):new Date(Date.UTC(1899,11,31,+e[1]%12+(e[7]=="p"?12:0),+e[2],0,0)):new Date(Date.UTC(1899,11,31,+e[1]%12+(e[7]=="p"?12:0),0,0,0))}function Nh(e){return e[2]?e[3]?e[4]?new Date(Date.UTC(1899,11,31,+e[1],+e[2],+e[4],parseFloat(e[3])*1e3)):new Date(Date.UTC(1899,11,31,0,+e[1],+e[2],parseFloat(e[3])*1e3)):e[5]?new Date(Date.UTC(1899,11,31,+e[1],+e[2],+e[5],e[6]?parseFloat(e[6])*1e3:0)):new Date(Date.UTC(1899,11,31,+e[1],+e[2],0,0)):new Date(Date.UTC(1899,11,31,+e[1],0,0,0))}var Ih=["january","february","march","april","may","june","july","august","september","october","november","december"];function za(e){if(Rh.test(e))return e.indexOf("Z")==-1?ts(new Date(e)):new Date(e);var r=e.toLowerCase(),t=r.replace(/\s+/g," ").trim(),n=t.match(Ah);if(n)return Ph(n);if(n=t.match(Dh),n)return Nh(n);if(n=t.match(Gc),n)return new Date(Date.UTC(+n[1],+n[2]-1,+n[3],+n[4],+n[5],n[6]&&parseInt(n[6].slice(1),10)||0,n[7]&&parseInt((n[7]+"0000").slice(1,4),10)||0));var a=new Date(Oh&&e.indexOf("UTC")==-1?e+" UTC":e),i=new Date(NaN),s=a.getYear(),o=a.getMonth(),c=a.getDate();if(isNaN(c))return i;if(r.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(r=r.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),r.length>3&&Ih.indexOf(r)==-1)return i}else if(r.replace(/[ap]m?/,"").match(/[a-z]/))return i;return s<0||s>8099||e.match(/[^-0-9:,\/\\\ ]/)?i:a}var Mh=(function(){var e="abacaba".split(/(:?b)/i).length==5;return function(t,n,a){if(e||typeof n=="string")return t.split(n);for(var i=t.split(n),s=[i[0]],o=1;o<i.length;++o)s.push(a),s.push(i[o]);return s}})();function Wn(e){return new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds())}function ts(e){return new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()))}function fo(e){var r=e.slice(0,1024),t=r.indexOf("<!DOCTYPE");if(t==-1)return e;var n=e.match(/<[\w]/);return n?e.slice(0,t)+e.slice(n.index):e}function uo(e,r,t){for(var n=[],a=e.indexOf(r);a>-1;){var i=e.indexOf(t,a+r.length);if(i==-1)break;n.push(e.slice(a,i+t.length)),a=e.indexOf(r,i+t.length)}return n.length>0?n:null}function Ka(e,r,t){var n=[],a=0,i=e.indexOf(r);if(i==-1)return e;for(;i>-1;){n.push(e.slice(a,i));var s=e.indexOf(t,i+r.length);if(s==-1)break;(i=e.indexOf(r,a=s+t.length))==-1&&n.push(e.slice(a))}return n.join("")}var Bh={" ":1,"	":1,"\r":1,"\n":1,">":1};function Nn(e,r){for(var t=e.indexOf("<"+r),n=r.length+1,a=e.length;t>=0&&t<=a-n&&!Bh[e.charAt(t+n)];)t=e.indexOf("<"+r,t+1);if(t===-1)return null;var i=e.indexOf(">",t+r.length);if(i===-1)return null;var s="</"+r+">",o=e.indexOf(s,i);return o==-1?null:[e.slice(t,o+s.length),e.slice(i+1,o)]}var Ht=(function(){var e={};return function(t,n){var a=e[n];a||(e[n]=a=[new RegExp("<(?:\\w+:)?"+n+"\\b[^<>]*>","g"),new RegExp("</(?:\\w+:)?"+n+">","g")]),a[0].lastIndex=a[1].lastIndex=0;var i=a[0].exec(t);if(!i)return null;var s=i.index,o=a[0].lastIndex;if(a[1].lastIndex=a[0].lastIndex,i=a[1].exec(t),!i)return null;var c=i.index,l=a[1].lastIndex;return[t.slice(s,l),t.slice(o,c)]}})(),jc=(function(){var e={};return function(t,n){var a=[],i=e[n];i||(e[n]=i=[new RegExp("<(?:\\w+:)?"+n+"\\b[^<>]*>","g"),new RegExp("</(?:\\w+:)?"+n+">","g")]),i[0].lastIndex=i[1].lastIndex=0;for(var s;s=i[0].exec(t);){var o=s.index;if(i[1].lastIndex=i[0].lastIndex,s=i[1].exec(t),!s)return null;var c=i[1].lastIndex;a.push(t.slice(o,c)),i[0].lastIndex=i[1].lastIndex}return a.length==0?null:a}})(),Lh=(function(){var e={};return function(t,n){var a=[],i=e[n];i||(e[n]=i=[new RegExp("<(?:\\w+:)?"+n+"\\b[^<>]*>","g"),new RegExp("</(?:\\w+:)?"+n+">","g")]),i[0].lastIndex=i[1].lastIndex=0;for(var s,o=0,c=0;s=i[0].exec(t);){if(o=s.index,a.push(t.slice(c,o)),c=o,i[1].lastIndex=i[0].lastIndex,s=i[1].exec(t),!s)return null;c=i[1].lastIndex,i[0].lastIndex=i[1].lastIndex}return a.push(t.slice(c)),a.length==0?"":a.join("")}})(),Uh=(function(){var e={};return function(t,n){var a=[],i=e[n];i||(e[n]=i=[new RegExp("<"+n+"\\b[^<>]*>","ig"),new RegExp("</"+n+">","ig")]),i[0].lastIndex=i[1].lastIndex=0;for(var s;s=i[0].exec(t);){var o=s.index;if(i[1].lastIndex=i[0].lastIndex,s=i[1].exec(t),!s)return null;var c=i[1].lastIndex;a.push(t.slice(o,c)),i[0].lastIndex=i[1].lastIndex}return a.length==0?null:a}})();function $c(e){return e?e.content&&e.type?Un(e.content,!0):e.data?ba(e.data):e.asNodeBuffer&&He?ba(e.asNodeBuffer().toString("binary")):e.asBinary?ba(e.asBinary()):e._data&&e._data.getContent?ba(Un(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function Yc(e){if(!e)return null;if(e.data)return Ks(e.data);if(e.asNodeBuffer&&He)return e.asNodeBuffer();if(e._data&&e._data.getContent){var r=e._data.getContent();return typeof r=="string"?Ks(r):Array.prototype.slice.call(r)}return e.content&&e.type?e.content:null}function Wh(e){return e&&e.name.slice(-4)===".bin"?Yc(e):$c(e)}function Or(e,r){for(var t=e.FullPaths||Pr(e.files),n=r.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),i=0;i<t.length;++i){var s=t[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==s||a==s)return e.files?e.files[t[i]]:e.FileIndex[i]}return null}function ho(e,r){var t=Or(e,r);if(t==null)throw new Error("Cannot find file "+r+" in zip");return t}function Ot(e,r,t){if(!t)return Wh(ho(e,r));if(!r)return null;try{return Ot(e,r)}catch{return null}}function cr(e,r,t){if(!t)return $c(ho(e,r));if(!r)return null;try{return cr(e,r)}catch{return null}}function Kc(e,r,t){if(!t)return Yc(ho(e,r));if(!r)return null;try{return Kc(e,r)}catch{return null}}function H0(e){for(var r=e.FullPaths||Pr(e.files),t=[],n=0;n<r.length;++n)r[n].slice(-1)!="/"&&t.push(r[n].replace(/^Root Entry[\/]/,""));return t.sort()}function Vh(e,r,t){if(e.FullPaths){if(Array.isArray(t)&&typeof t[0]=="string"&&(t=t.join("")),typeof t=="string"){var n;return He?n=yn(t):n=Zu(t),je.utils.cfb_add(e,r,n)}je.utils.cfb_add(e,r,t)}else e.file(r,t)}function Zc(e,r){switch(r.type){case"base64":return je.read(e,{type:"base64"});case"binary":return je.read(e,{type:"binary"});case"buffer":case"array":return je.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+r.type)}function oa(e,r){if(e.charAt(0)=="/")return e.slice(1);var t=r.split("/");r.slice(-1)!="/"&&t.pop();for(var n=e.split("/");n.length!==0;){var a=n.shift();a===".."?t.pop():a!=="."&&t.push(a)}return t.join("/")}var qc=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,Jc=/\s([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,z0=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?<>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'"<>\s=]+))*\s*[\/\?]?>/mg,Hh=/<[^<>]*>/g,jt=qc.match(z0)?z0:Hh,zh=/<\w*:/,Xh=/<(\/?)\w+:/;function xe(e,r,t){for(var n={},a=0,i=0;a!==e.length&&!((i=e.charCodeAt(a))===32||i===10||i===13);++a);if(r||(n[0]=e.slice(0,a)),a===e.length)return n;var s=e.match(Jc),o=0,c="",l=0,f="",d="",h=1;if(s)for(l=0;l!=s.length;++l){for(d=s[l].slice(1),i=0;i!=d.length&&d.charCodeAt(i)!==61;++i);for(f=d.slice(0,i).trim();d.charCodeAt(i+1)==32;)++i;for(h=(a=d.charCodeAt(i+1))==34||a==39?1:0,c=d.slice(i+1+h,d.length-h),o=0;o!=f.length&&f.charCodeAt(o)!==58;++o);if(o===f.length)f.indexOf("_")>0&&(f=f.slice(0,f.indexOf("_"))),n[f]=c,t||(n[f.toLowerCase()]=c);else{var u=(o===5&&f.slice(0,5)==="xmlns"?"xmlns":"")+f.slice(o+1);if(n[u]&&f.slice(o-3,o)=="ext")continue;n[u]=c,t||(n[u.toLowerCase()]=c)}}return n}function Gh(e,r,t){for(var n={},a=0,i=0;a!==e.length&&!((i=e.charCodeAt(a))===32||i===10||i===13);++a);if(r||(n[0]=e.slice(0,a)),a===e.length)return n;var s=e.match(Jc),o=0,c="",l=0,f="",d="",h=1;if(s)for(l=0;l!=s.length;++l){for(d=s[l].slice(1),i=0;i!=d.length&&d.charCodeAt(i)!==61;++i);for(f=d.slice(0,i).trim();d.charCodeAt(i+1)==32;)++i;h=(a=d.charCodeAt(i+1))==34||a==39?1:0,c=d.slice(i+1+h,d.length-h),f.indexOf("_")>0&&(f=f.slice(0,f.indexOf("_"))),n[f]=c,t||(n[f.toLowerCase()]=c)}return n}function Nr(e){return e.replace(Xh,"<$1")}var Qc={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},jh=lo(Qc),ze=(function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,r=/_x([\da-fA-F]{4})_/ig;function t(n){var a=n+"",i=a.indexOf("<![CDATA[");if(i==-1)return a.replace(e,function(o,c){return Qc[o]||String.fromCharCode(parseInt(c,o.indexOf("x")>-1?16:10))||o}).replace(r,function(o,c){return String.fromCharCode(parseInt(c,16))});var s=a.indexOf("]]>");return t(a.slice(0,i))+a.slice(i+9,s)+t(a.slice(s+3))}return function(a,i){var s=t(a);return i?s.replace(/\r\n/g,`
`):s}})(),$h=/[&<>'"]/g;var Yh=/[\u0000-\u001f]/g;function Da(e){var r=e+"";return r.replace($h,function(t){return jh[t]}).replace(/\n/g,"<br/>").replace(Yh,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}var X0=(function(){var e=/&#(\d+);/g;function r(t,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,r)}})();function nt(e){switch(e){case 1:case!0:case"1":case"true":return!0;case 0:case!1:case"0":case"false":return!1}return!1}function Ws(e){for(var r="",t=0,n=0,a=0,i=0,s=0,o=0;t<e.length;){if(n=e.charCodeAt(t++),n<128){r+=String.fromCharCode(n);continue}if(a=e.charCodeAt(t++),n>191&&n<224){s=(n&31)<<6,s|=a&63,r+=String.fromCharCode(s);continue}if(i=e.charCodeAt(t++),n<240){r+=String.fromCharCode((n&15)<<12|(a&63)<<6|i&63);continue}s=e.charCodeAt(t++),o=((n&7)<<18|(a&63)<<12|(i&63)<<6|s&63)-65536,r+=String.fromCharCode(55296+(o>>>10&1023)),r+=String.fromCharCode(56320+(o&1023))}return r}function G0(e){var r=_n(2*e.length),t,n,a=1,i=0,s=0,o;for(n=0;n<e.length;n+=a)a=1,(o=e.charCodeAt(n))<128?t=o:o<224?(t=(o&31)*64+(e.charCodeAt(n+1)&63),a=2):o<240?(t=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),a=3):(a=4,t=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),t-=65536,s=55296+(t>>>10&1023),t=56320+(t&1023)),s!==0&&(r[i++]=s&255,r[i++]=s>>>8,s=0),r[i++]=t%256,r[i++]=t>>>8;return r.slice(0,i).toString("ucs2")}function j0(e){return yn(e,"binary").toString("utf8")}var Ni="foo bar baz\xE2\x98\x83\xF0\x9F\x8D\xA3",ft=He&&(j0(Ni)==Ws(Ni)&&j0||G0(Ni)==Ws(Ni)&&G0)||Ws,Aa=He?function(e){return yn(e,"utf8").toString("binary")}:function(e){for(var r=[],t=0,n=0,a=0;t<e.length;)switch(n=e.charCodeAt(t++),!0){case n<128:r.push(String.fromCharCode(n));break;case n<2048:r.push(String.fromCharCode(192+(n>>6))),r.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=e.charCodeAt(t++)-56320+(n<<10),r.push(String.fromCharCode(240+(a>>18&7))),r.push(String.fromCharCode(144+(a>>12&63))),r.push(String.fromCharCode(128+(a>>6&63))),r.push(String.fromCharCode(128+(a&63)));break;default:r.push(String.fromCharCode(224+(n>>12))),r.push(String.fromCharCode(128+(n>>6&63))),r.push(String.fromCharCode(128+(n&63)))}return r.join("")},el=(function(){var e=[["nbsp"," "],["middot","\xB7"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(r){return[new RegExp("&"+r[0]+";","ig"),r[1]]});return function(t){for(var n=t.replace(/^[\t\n\r ]+/,"").replace(/(^|[^\t\n\r ])[\t\n\r ]+$/,"$1").replace(/>\s+/g,">").replace(/\b\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^<>]*>/g,""),a=0;a<e.length;++a)n=n.replace(e[a][0],e[a][1]);return n}})(),Kh=/<\/?(?:vt:)?variant>/g,Zh=/<(?:vt:)([^<"'>]*)>([\s\S]*)</;function $0(e,r){var t=xe(e),n=jc(e,t.baseType)||[],a=[];if(n.length!=t.size){if(r.WTF)throw new Error("unexpected vector length "+n.length+" != "+t.size);return a}return n.forEach(function(i){var s=i.replace(Kh,"").match(Zh);s&&a.push({v:ft(s[2]),t:s[1]})}),a}var qh=/(^\s|\s$|\n)/;function Jh(e){return Pr(e).map(function(r){return" "+r+'="'+e[r]+'"'}).join("")}function Qh(e,r,t){return"<"+e+(t!=null?Jh(t):"")+(r!=null?(r.match(qh)?' xml:space="preserve"':"")+">"+r+"</"+e:"/")+">"}function rs(e){if(He&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return ft(on(so(e)));throw new Error("Bad input format: expected Buffer or string")}var Pt=/<([\/]?)([^\s?><!\/:"]*:|)([^\s?<>:\/"]+)(?:\s+[^<>=?"'\s]+="[^"]*?")*\s*[\/]?>/mg,ed={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},td=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function rd(e,r){for(var t=1-2*(e[r+7]>>>7),n=((e[r+7]&127)<<4)+(e[r+6]>>>4&15),a=e[r+6]&15,i=5;i>=0;--i)a=a*256+e[r+i];return n==2047?a==0?t*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),t*Math.pow(2,n-52)*a)}function nd(e,r,t){var n=(r<0||1/r==-1/0?1:0)<<7,a=0,i=0,s=n?-r:r;isFinite(s)?s==0?a=i=0:(a=Math.floor(Math.log(s)/Math.LN2),i=s*Math.pow(2,52-a),a<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?a=-1022:(i-=Math.pow(2,52),a+=1023)):(a=2047,i=isNaN(r)?26985:0);for(var o=0;o<=5;++o,i/=256)e[t+o]=i&255;e[t+6]=(a&15)<<4|i&15,e[t+7]=a>>4|n}var Y0=function(e){for(var r=[],t=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var a=0,i=e[0][n].length;a<i;a+=t)r.push.apply(r,e[0][n].slice(a,a+t));return r},K0=He?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(r){return Buffer.isBuffer(r)?r:yn(r)})):Y0(e)}:Y0,Z0=function(e,r,t){for(var n=[],a=r;a<t;a+=2)n.push(String.fromCharCode(nn(e,a)));return n.join("").replace(lr,"")},ns=He?function(e,r,t){return!Buffer.isBuffer(e)||!Va?Z0(e,r,t):e.toString("utf16le",r,t).replace(lr,"")}:Z0,q0=function(e,r,t){for(var n=[],a=r;a<r+t;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},tl=He?function(e,r,t){return Buffer.isBuffer(e)?e.toString("hex",r,r+t):q0(e,r,t)}:q0,J0=function(e,r,t){for(var n=[],a=r;a<t;a++)n.push(String.fromCharCode(sa(e,a)));return n.join("")},pa=He?function(r,t,n){return Buffer.isBuffer(r)?r.toString("utf8",t,n):J0(r,t,n)}:J0,rl=function(e,r){var t=Vt(e,r);return t>0?pa(e,r+4,r+4+t-1):""},po=rl,nl=function(e,r){var t=Vt(e,r);return t>0?pa(e,r+4,r+4+t-1):""},mo=nl,al=function(e,r){var t=2*Vt(e,r);return t>0?pa(e,r+4,r+4+t-1):""},xo=al,il=function(r,t){var n=Vt(r,t);return n>0?ns(r,t+4,t+4+n):""},go=il,sl=function(e,r){var t=Vt(e,r);return t>0?pa(e,r+4,r+4+t):""},_o=sl,ol=function(e,r){return rd(e,r)},$i=ol,cl=function(r){return Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array};He&&(po=function(r,t){if(!Buffer.isBuffer(r))return rl(r,t);var n=r.readUInt32LE(t);return n>0?r.toString("utf8",t+4,t+4+n-1):""},mo=function(r,t){if(!Buffer.isBuffer(r))return nl(r,t);var n=r.readUInt32LE(t);return n>0?r.toString("utf8",t+4,t+4+n-1):""},xo=function(r,t){if(!Buffer.isBuffer(r)||!Va)return al(r,t);var n=2*r.readUInt32LE(t);return r.toString("utf16le",t+4,t+4+n-1)},go=function(r,t){if(!Buffer.isBuffer(r)||!Va)return il(r,t);var n=r.readUInt32LE(t);return r.toString("utf16le",t+4,t+4+n)},_o=function(r,t){if(!Buffer.isBuffer(r))return sl(r,t);var n=r.readUInt32LE(t);return r.toString("utf8",t+4,t+4+n)},$i=function(r,t){return Buffer.isBuffer(r)?r.readDoubleLE(t):ol(r,t)},cl=function(r){return Buffer.isBuffer(r)||Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array});function ad(){ns=function(e,r,t){return Le.utils.decode(1200,e.slice(r,t)).replace(lr,"")},pa=function(e,r,t){return Le.utils.decode(65001,e.slice(r,t))},po=function(e,r){var t=Vt(e,r);return t>0?Le.utils.decode(ua,e.slice(r+4,r+4+t-1)):""},mo=function(e,r){var t=Vt(e,r);return t>0?Le.utils.decode(er,e.slice(r+4,r+4+t-1)):""},xo=function(e,r){var t=2*Vt(e,r);return t>0?Le.utils.decode(1200,e.slice(r+4,r+4+t-1)):""},go=function(e,r){var t=Vt(e,r);return t>0?Le.utils.decode(1200,e.slice(r+4,r+4+t)):""},_o=function(e,r){var t=Vt(e,r);return t>0?Le.utils.decode(65001,e.slice(r+4,r+4+t)):""}}typeof Le<"u"&&ad();var sa=function(e,r){return e[r]},nn=function(e,r){return e[r+1]*256+e[r]},id=function(e,r){var t=e[r+1]*256+e[r];return t<32768?t:(65535-t+1)*-1},Vt=function(e,r){return e[r+3]*(1<<24)+(e[r+2]<<16)+(e[r+1]<<8)+e[r]},On=function(e,r){return e[r+3]<<24|e[r+2]<<16|e[r+1]<<8|e[r]},sd=function(e,r){return e[r]<<24|e[r+1]<<16|e[r+2]<<8|e[r+3]};function Ra(e,r){var t="",n,a,i=[],s,o,c,l;switch(r){case"dbcs":if(l=this.l,He&&Buffer.isBuffer(this)&&Va)t=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)t+=String.fromCharCode(nn(this,l)),l+=2;e*=2;break;case"utf8":t=pa(this,this.l,this.l+e);break;case"utf16le":e*=2,t=ns(this,this.l,this.l+e);break;case"wstr":if(typeof Le<"u")t=Le.utils.decode(er,this.slice(this.l,this.l+2*e));else return Ra.call(this,e,"dbcs");e=2*e;break;case"lpstr-ansi":t=po(this,this.l),e=4+Vt(this,this.l);break;case"lpstr-cp":t=mo(this,this.l),e=4+Vt(this,this.l);break;case"lpwstr":t=xo(this,this.l),e=4+2*Vt(this,this.l);break;case"lpp4":e=4+Vt(this,this.l),t=go(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Vt(this,this.l),t=_o(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,t="";(s=sa(this,this.l+e++))!==0;)i.push(Pi(s));t=i.join("");break;case"_wstr":for(e=0,t="";(s=nn(this,this.l+e))!==0;)i.push(Pi(s)),e+=2;e+=2,t=i.join("");break;case"dbcs-cont":for(t="",l=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(l)!==-1)return s=sa(this,l),this.l=l+1,o=Ra.call(this,e-c,s?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(Pi(nn(this,l))),l+=2}t=i.join(""),e*=2;break;case"cpstr":if(typeof Le<"u"){t=Le.utils.decode(er,this.slice(this.l,this.l+e));break}case"sbcs-cont":for(t="",l=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(l)!==-1)return s=sa(this,l),this.l=l+1,o=Ra.call(this,e-c,s?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(Pi(sa(this,l))),l+=1}t=i.join("");break;default:switch(e){case 1:return n=sa(this,this.l),this.l++,n;case 2:return n=(r==="i"?id:nn)(this,this.l),this.l+=2,n;case 4:case-4:return r==="i"||(this[this.l+3]&128)===0?(n=(e>0?On:sd)(this,this.l),this.l+=4,n):(a=Vt(this,this.l),this.l+=4,a);case 8:case-8:if(r==="f")return e==8?a=$i(this,this.l):a=$i([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:t=tl(this,this.l,e);break}}return this.l+=e,t}var od=function(e,r,t){e[t]=r&255,e[t+1]=r>>>8&255,e[t+2]=r>>>16&255,e[t+3]=r>>>24&255},cd=function(e,r,t){e[t]=r&255,e[t+1]=r>>8&255,e[t+2]=r>>16&255,e[t+3]=r>>24&255},ld=function(e,r,t){e[t]=r&255,e[t+1]=r>>>8&255};function fd(e,r,t){var n=0,a=0;if(t==="dbcs"){for(a=0;a!=r.length;++a)ld(this,r.charCodeAt(a),this.l+2*a);n=2*r.length}else if(t==="sbcs"||t=="cpstr")if(typeof Le<"u"&&ua==874){for(a=0;a!=r.length;++a){var i=Le.utils.encode(ua,r.charAt(a));this[this.l+a]=i[0]}n=r.length}else if(typeof Le<"u"&&t=="cpstr"){if(i=Le.utils.encode(er,r),i.length==r.length)for(a=0;a<r.length;++a)i[a]==0&&r.charCodeAt(a)!=0&&(i[a]=95);if(i.length==2*r.length)for(a=0;a<r.length;++a)i[2*a]==0&&i[2*a+1]==0&&r.charCodeAt(a)!=0&&(i[2*a]=95);for(a=0;a<i.length;++a)this[this.l+a]=i[a];n=i.length}else{for(r=r.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=r.length;++a)this[this.l+a]=r.charCodeAt(a)&255;n=r.length}else if(t==="hex"){for(;a<e;++a)this[this.l++]=parseInt(r.slice(2*a,2*a+2),16)||0;return this}else if(t==="utf16le"){var s=Math.min(this.l+e,this.length);for(a=0;a<Math.min(r.length,e);++a){var o=r.charCodeAt(a);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=r&255;break;case 2:n=2,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255;break;case 3:n=3,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255,r>>>=8,this[this.l+2]=r&255;break;case 4:n=4,od(this,r,this.l);break;case 8:if(n=8,t==="f"){nd(this,r,this.l);break}case 16:break;case-4:n=4,cd(this,r,this.l);break}return this.l+=n,this}function ll(e,r){var t=tl(this,this.l,e.length>>1);if(t!==e)throw new Error(r+"Expected "+e+" saw "+t);this.l+=e.length>>1}function It(e,r){e.l=r,e.read_shift=Ra,e.chk=ll,e.write_shift=fd}function ar(e,r){e.l+=r}function kt(e){var r=_n(e);return It(r,0),r}function cn(e,r,t){if(e){var n,a,i;It(e,e.l||0);for(var s=e.length,o=0,c=0;e.l<s;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var l=Qi[o]||Qi[65535];for(n=e.read_shift(1),i=n&127,a=1;a<4&&n&128;++a)i+=((n=e.read_shift(1))&127)<<7*a;c=e.l+i;var f=l.f&&l.f(e,i,t);if(e.l=c,r(f,l,o))return}}}function qs(){var e=[],r=He?16384:2048,t=He&&typeof kt(r).copy=="function",n=function(d){var h=kt(d);return It(h,0),h},a=n(r),i=function(){a&&(a.l&&(a.length>a.l&&(a=a.slice(0,a.l),a.l=a.length),a.length>0&&e.push(a)),a=null)},s=function(d){return a&&d<a.length-a.l?a:(i(),a=n(Math.max(d+1,r)))},o=function(){return i(),mn(e)},c=function(){return i(),e},l=function(d){i(),a=d,a.l==null&&(a.l=a.length),s(r)};return{next:s,push:l,end:o,_bufs:e,end2:c}}function Oa(e,r,t){var n=Nt(e);if(r.s?(n.cRel&&(n.c+=r.s.c),n.rRel&&(n.r+=r.s.r)):(n.cRel&&(n.c+=r.c),n.rRel&&(n.r+=r.r)),!t||t.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Q0(e,r,t){var n=Nt(e);return n.s=Oa(n.s,r.s,t),n.e=Oa(n.e,r.s,t),n}function Pa(e,r){if(e.cRel&&e.c<0)for(e=Nt(e);e.c<0;)e.c+=r>8?16384:256;if(e.rRel&&e.r<0)for(e=Nt(e);e.r<0;)e.r+=r>8?1048576:r>5?65536:16384;var t=Ye(e);return!e.cRel&&e.cRel!=null&&(t=dd(t)),!e.rRel&&e.rRel!=null&&(t=ud(t)),t}function Vs(e,r){return e.s.r==0&&!e.s.rRel&&e.e.r==(r.biff>=12?1048575:r.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+qe(e.s.c)+":"+(e.e.cRel?"":"$")+qe(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(r.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+at(e.s.r)+":"+(e.e.rRel?"":"$")+at(e.e.r):Pa(e.s,r.biff)+":"+Pa(e.e,r.biff)}function vo(e){return parseInt(hd(e),10)-1}function at(e){return""+(e+1)}function ud(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function hd(e){return e.replace(/\$(\d+)$/,"$1")}function wo(e){for(var r=pd(e),t=0,n=0;n!==r.length;++n)t=26*t+r.charCodeAt(n)-64;return t-1}function qe(e){if(e<0)throw new Error("invalid column "+e);var r="";for(++e;e;e=Math.floor((e-1)/26))r=String.fromCharCode((e-1)%26+65)+r;return r}function dd(e){return e.replace(/^([A-Z])/,"$$$1")}function pd(e){return e.replace(/^\$([A-Z])/,"$1")}function md(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function rr(e){for(var r=0,t=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?r=10*r+(a-48):a>=65&&a<=90&&(t=26*t+(a-64))}return{c:t-1,r:r-1}}function Ye(e){for(var r=e.c+1,t="";r;r=(r-1)/26|0)t=String.fromCharCode((r-1)%26+65)+t;return t+(e.r+1)}function Hn(e){var r=e.indexOf(":");return r==-1?{s:rr(e),e:rr(e)}:{s:rr(e.slice(0,r)),e:rr(e.slice(r+1))}}function Xe(e,r){return typeof r>"u"||typeof r=="number"?Xe(e.s,e.e):(typeof e!="string"&&(e=Ye(e)),typeof r!="string"&&(r=Ye(r)),e==r?e:e+":"+r)}function xd(e,r){if(!e&&!(r&&r.biff<=5&&r.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e.replace(/'/g,"''")+"'":e}function Ct(e){var r={s:{c:0,r:0},e:{c:0,r:0}},t=0,n=0,a=0,i=e.length;for(t=0;n<i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)t=26*t+a;for(r.s.c=--t,t=0;n<i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)t=10*t+a;if(r.s.r=--t,n===i||a!=10)return r.e.c=r.s.c,r.e.r=r.s.r,r;for(++n,t=0;n!=i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)t=26*t+a;for(r.e.c=--t,t=0;n!=i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)t=10*t+a;return r.e.r=--t,r}function ec(e,r){var t=e.t=="d"&&r instanceof Date;if(e.z!=null)try{return e.w=kr(e.z,t?Mt(r):r)}catch{}try{return e.w=kr((e.XF||{}).numFmtId||(t?14:0),t?Mt(r):r)}catch{return""+r}}function vn(e,r,t){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&t&&t.dateNF&&(e.z=t.dateNF),e.t=="e"?pr[e.v]||e.v:r==null?ec(e,e.v):ec(e,r))}function Sn(e,r){var t=r&&r.sheet?r.sheet:"Sheet1",n={};return n[t]=e,{SheetNames:[t],Sheets:n}}function gd(e){var r={},t=e||{};return t.dense&&(r["!data"]=[]),r}function fl(e,r,t){var n=t||{},a=e?e["!data"]!=null:n.dense;Et!=null&&a==null&&(a=Et);var i=e||(a?{"!data":[]}:{});a&&!i["!data"]&&(i["!data"]=[]);var s=0,o=0;if(i&&n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var c=typeof n.origin=="string"?rr(n.origin):n.origin;s=c.r,o=c.c}var l={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var f=Ct(i["!ref"]);l.s.c=f.s.c,l.s.r=f.s.r,l.e.c=Math.max(l.e.c,f.e.c),l.e.r=Math.max(l.e.r,f.e.r),s==-1&&(l.e.r=s=i["!ref"]?f.e.r+1:0)}else l.s.c=l.e.c=l.s.r=l.e.r=0;for(var d=[],h=!1,u=0;u!=r.length;++u)if(r[u]){if(!Array.isArray(r[u]))throw new Error("aoa_to_sheet expects an array of arrays");var x=s+u;a&&(i["!data"][x]||(i["!data"][x]=[]),d=i["!data"][x]);for(var g=r[u],p=0;p!=g.length;++p)if(!(typeof g[p]>"u")){var m={v:g[p],t:""},w=o+p;if(l.s.r>x&&(l.s.r=x),l.s.c>w&&(l.s.c=w),l.e.r<x&&(l.e.r=x),l.e.c<w&&(l.e.c=w),h=!0,g[p]&&typeof g[p]=="object"&&!Array.isArray(g[p])&&!(g[p]instanceof Date))m=g[p];else if(Array.isArray(m.v)&&(m.f=g[p][1],m.v=m.v[0]),m.v===null)if(m.f)m.t="n";else if(n.nullError)m.t="e",m.v=0;else if(n.sheetStubs)m.t="z";else continue;else typeof m.v=="number"?isFinite(m.v)?m.t="n":isNaN(m.v)?(m.t="e",m.v=15):(m.t="e",m.v=7):typeof m.v=="boolean"?m.t="b":m.v instanceof Date?(m.z=n.dateNF||De[14],n.UTC||(m.v=ts(m.v)),n.cellDates?(m.t="d",m.w=kr(m.z,Mt(m.v,n.date1904))):(m.t="n",m.v=Mt(m.v,n.date1904),m.w=kr(m.z,m.v))):m.t="s";if(a)d[w]&&d[w].z&&(m.z=d[w].z),d[w]=m;else{var _=qe(w)+(x+1);i[_]&&i[_].z&&(m.z=i[_].z),i[_]=m}}}return h&&l.s.c<104e5&&(i["!ref"]=Xe(l)),i}function ma(e,r){return fl(null,e,r)}function _d(e){return e.read_shift(4,"i")}function nr(e){var r=e.read_shift(4);return r===0?"":e.read_shift(r,"dbcs")}function vd(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function yo(e,r){var t=e.l,n=e.read_shift(1),a=nr(e),i=[],s={t:a,h:a};if((n&1)!==0){for(var o=e.read_shift(4),c=0;c!=o;++c)i.push(vd(e));s.r=i}else s.r=[{ich:0,ifnt:0}];return e.l=t+r,s}var wd=yo;function Ir(e){var r=e.read_shift(4),t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:r,iStyleRef:t}}function zn(e){var r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:r}}var yd=nr;function as(e){var r=e.read_shift(4);return r===0||r===4294967295?"":e.read_shift(r,"dbcs")}var Sd=nr,Js=as;function is(e){var r=e.slice(e.l,e.l+4),t=r[0]&1,n=r[0]&2;e.l+=4;var a=n===0?$i([0,0,0,0,r[0]&252,r[1],r[2],r[3]],0):On(r,0)>>2;return t?a/100:a}function ul(e){var r={s:{},e:{}};return r.s.r=e.read_shift(4),r.e.r=e.read_shift(4),r.s.c=e.read_shift(4),r.e.c=e.read_shift(4),r}var Xn=ul;function tr(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function kd(e){var r={},t=e.read_shift(1),n=t>>>1,a=e.read_shift(1),i=e.read_shift(2,"i"),s=e.read_shift(1),o=e.read_shift(1),c=e.read_shift(1);switch(e.l++,n){case 0:r.auto=1;break;case 1:r.index=a;var l=In[a];l&&(r.rgb=Ga(l));break;case 2:r.rgb=Ga([s,o,c]);break;case 3:r.theme=a;break}return i!=0&&(r.tint=i>0?i/32767:i/32768),r}function Ed(e){var r=e.read_shift(1);e.l++;var t={fBold:r&1,fItalic:r&2,fUnderline:r&4,fStrikeout:r&8,fOutline:r&16,fShadow:r&32,fCondense:r&64,fExtend:r&128};return t}function hl(e,r){var t={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return t[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,r==1?"lpstr":"lpwstr")}function Cd(e){return hl(e,1)}function Td(e){return hl(e,2)}var So=2,dr=3,Ii=11,tc=12,Yi=19,Mi=64,bd=65,Fd=71,Ad=4108,Dd=4126,Ut=80,dl=81,Rd=[Ut,dl],Od={1:{n:"CodePage",t:So},2:{n:"Category",t:Ut},3:{n:"PresentationFormat",t:Ut},4:{n:"ByteCount",t:dr},5:{n:"LineCount",t:dr},6:{n:"ParagraphCount",t:dr},7:{n:"SlideCount",t:dr},8:{n:"NoteCount",t:dr},9:{n:"HiddenCount",t:dr},10:{n:"MultimediaClipCount",t:dr},11:{n:"ScaleCrop",t:Ii},12:{n:"HeadingPairs",t:Ad},13:{n:"TitlesOfParts",t:Dd},14:{n:"Manager",t:Ut},15:{n:"Company",t:Ut},16:{n:"LinksUpToDate",t:Ii},17:{n:"CharacterCount",t:dr},19:{n:"SharedDoc",t:Ii},22:{n:"HyperlinksChanged",t:Ii},23:{n:"AppVersion",t:dr,p:"version"},24:{n:"DigSig",t:bd},26:{n:"ContentType",t:Ut},27:{n:"ContentStatus",t:Ut},28:{n:"Language",t:Ut},29:{n:"Version",t:Ut},255:{},2147483648:{n:"Locale",t:Yi},2147483651:{n:"Behavior",t:Yi},1919054434:{}},Pd={1:{n:"CodePage",t:So},2:{n:"Title",t:Ut},3:{n:"Subject",t:Ut},4:{n:"Author",t:Ut},5:{n:"Keywords",t:Ut},6:{n:"Comments",t:Ut},7:{n:"Template",t:Ut},8:{n:"LastAuthor",t:Ut},9:{n:"RevNumber",t:Ut},10:{n:"EditTime",t:Mi},11:{n:"LastPrinted",t:Mi},12:{n:"CreatedDate",t:Mi},13:{n:"ModifiedDate",t:Mi},14:{n:"PageCount",t:dr},15:{n:"WordCount",t:dr},16:{n:"CharCount",t:dr},17:{n:"Thumbnail",t:Fd},18:{n:"Application",t:Ut},19:{n:"DocSecurity",t:dr},255:{},2147483648:{n:"Locale",t:Yi},2147483651:{n:"Behavior",t:Yi},1919054434:{}},rc={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},Nd=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function Id(e){return e.map(function(r){return[r>>16&255,r>>8&255,r&255]})}var Md=Id([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,0,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),In=Nt(Md),pr={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},zt={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},pl=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"],nc={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function Bd(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function Ld(e){var r=Bd();if(!e||!e.match)return r;var t={};if((e.match(jt)||[]).forEach(function(n){var a=xe(n);switch(a[0].replace(zh,"<")){case"<?xml":break;case"<Types":r.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":t[a.Extension.toLowerCase()]=a.ContentType;break;case"<Override":r[nc[a.ContentType]]!==void 0&&r[nc[a.ContentType]].push(a.PartName);break}}),r.xmlns!==ed.CT)throw new Error("Unknown Namespace: "+r.xmlns);return r.calcchain=r.calcchains.length>0?r.calcchains[0]:"",r.sst=r.strs.length>0?r.strs[0]:"",r.style=r.styles.length>0?r.styles[0]:"",r.defaults=t,delete r.calcchains,r}var en={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",CONN:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/connections",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Qs(e){var r=e.lastIndexOf("/");return e.slice(0,r+1)+"_rels/"+e.slice(r+1)+".rels"}function Na(e,r){var t={"!id":{}};if(!e)return t;r.charAt(0)!=="/"&&(r="/"+r);var n={};return(e.match(jt)||[]).forEach(function(a){var i=xe(a);if(i[0]==="<Relationship"){var s={};s.Type=i.Type,s.Target=ze(i.Target),s.Id=i.Id,i.TargetMode&&(s.TargetMode=i.TargetMode);var o=i.TargetMode==="External"?i.Target:oa(i.Target,r);t[o]=s,n[i.Id]=s}}),t["!id"]=n,t}var Ud="application/vnd.oasis.opendocument.spreadsheet";function Wd(e,r){for(var t=rs(e),n,a;n=Pt.exec(t);)switch(n[3]){case"manifest":break;case"file-entry":if(a=xe(n[0],!1),a.path=="/"&&a.type!==Ud)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(r&&r.WTF)throw n}}var ac=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function ml(e){var r={};e=ft(e);for(var t=0;t<ac.length;++t){var n=ac[t],a=Nn(e,n[0]);a!=null&&a.length>0&&(r[n[1]]=ze(a[1])),n[2]==="date"&&r[n[1]]&&(r[n[1]]=Gt(r[n[1]]))}return r}var Vd=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function xl(e,r,t,n){var a=[];if(typeof e=="string")a=$0(e,n);else for(var i=0;i<e.length;++i)a=a.concat(e[i].map(function(f){return{v:f}}));var s=typeof r=="string"?$0(r,n).map(function(f){return f.v}):r,o=0,c=0;if(s.length>0)for(var l=0;l!==a.length;l+=2){switch(c=+a[l+1].v,a[l].v){case"Worksheets":case"\u5DE5\u4F5C\u8868":case"\u041B\u0438\u0441\u0442\u044B":case"\u0623\u0648\u0631\u0627\u0642 \u0627\u0644\u0639\u0645\u0644":case"\u30EF\u30FC\u30AF\u30B7\u30FC\u30C8":case"\u05D2\u05DC\u05D9\u05D5\u05E0\u05D5\u05EA \u05E2\u05D1\u05D5\u05D3\u05D4":case"Arbeitsbl\xE4tter":case"\xC7al\u0131\u015Fma Sayfalar\u0131":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de c\xE1lculo":case"Planilhas":case"Regneark":case"Hojas de c\xE1lculo":case"Werkbladen":t.Worksheets=c,t.SheetNames=s.slice(o,o+c);break;case"Named Ranges":case"Rangos con nombre":case"\u540D\u524D\u4ED8\u304D\u4E00\u89A7":case"Benannte Bereiche":case"Navngivne omr\xE5der":t.NamedRanges=c,t.DefinedNames=s.slice(o,o+c);break;case"Charts":case"Diagramme":t.Chartsheets=c,t.ChartNames=s.slice(o,o+c);break}o+=c}}function Hd(e,r,t){var n={};return r||(r={}),e=ft(e),Vd.forEach(function(a){var i=(Ht(e,a[0])||[])[1];switch(a[2]){case"string":i&&(r[a[1]]=ze(i));break;case"bool":r[a[1]]=i==="true";break;case"raw":var s=Nn(e,a[0]);s&&s.length>0&&(n[a[1]]=s[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&xl(n.HeadingPairs,n.TitlesOfParts,r,t),r}var zd=/<[^<>]+>[^<]*/g;function Xd(e,r){var t={},n="",a=e.match(zd);if(a)for(var i=0;i!=a.length;++i){var s=a[i],o=xe(s);switch(Nr(o[0])){case"<?xml":break;case"<Properties":break;case"<property":n=ze(o.name);break;case"</property>":n=null;break;default:if(s.indexOf("<vt:")===0){var c=s.split(">"),l=c[0].slice(4),f=c[1];switch(l){case"lpstr":case"bstr":case"lpwstr":t[n]=ze(f);break;case"bool":t[n]=nt(f);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":t[n]=parseInt(f,10);break;case"r4":case"r8":case"decimal":t[n]=parseFloat(f);break;case"filetime":case"date":t[n]=Gt(f);break;case"cy":case"error":t[n]=ze(f);break;default:if(l.slice(-1)=="/")break;r.WTF&&typeof console<"u"&&console.warn("Unexpected",s,l,c)}}else if(s.slice(0,2)!=="</"){if(r.WTF)throw new Error(s)}}}return t}var Gd={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Hs;function jd(e,r,t){Hs||(Hs=lo(Gd)),r=Hs[r]||r,e[r]=t}function ko(e){var r=e.read_shift(4),t=e.read_shift(4);return new Date((t/1e7*Math.pow(2,32)+r/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function $d(e,r,t){var n=e.l,a=e.read_shift(0,"lpstr-cp");if(t)for(;e.l-n&3;)++e.l;return a}function Yd(e,r,t){var n=e.read_shift(0,"lpwstr");return t&&(e.l+=4-(n.length+1&3)&3),n}function gl(e,r,t){return r===31?Yd(e):$d(e,r,t)}function Ia(e,r,t){return gl(e,r,t===!1?0:4)}function Kd(e,r){if(!r)throw new Error("VtUnalignedString must have positive length");return gl(e,r,0)}function Zd(e){for(var r=e.read_shift(4),t=[],n=0;n!=r;++n){var a=e.l;t[n]=e.read_shift(0,"lpwstr").replace(lr,""),e.l-a&2&&(e.l+=2)}return t}function qd(e){for(var r=e.read_shift(4),t=[],n=0;n!=r;++n)t[n]=e.read_shift(0,"lpstr-cp").replace(lr,"");return t}function Jd(e){var r=e.l,t=Ki(e,dl);e[e.l]==0&&e[e.l+1]==0&&e.l-r&2&&(e.l+=2);var n=Ki(e,dr);return[t,n]}function Qd(e){for(var r=e.read_shift(4),t=[],n=0;n<r/2;++n)t.push(Jd(e));return t}function ic(e,r){for(var t=e.read_shift(4),n={},a=0;a!=t;++a){var i=e.read_shift(4),s=e.read_shift(4);n[i]=e.read_shift(s,r===1200?"utf16le":"utf8").replace(lr,"").replace(Fa,"!"),r===1200&&s%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function _l(e){var r=e.read_shift(4),t=e.slice(e.l,e.l+r);return e.l+=r,(r&3)>0&&(e.l+=4-(r&3)&3),t}function e1(e){var r={};return r.Size=e.read_shift(4),e.l+=r.Size+3-(r.Size-1)%4,r}function Ki(e,r,t){var n=e.read_shift(2),a,i=t||{};if(e.l+=2,r!==tc&&n!==r&&Rd.indexOf(r)===-1&&!((r&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+r+" saw "+n);switch(r===tc?n:r){case 2:return a=e.read_shift(2,"i"),i.raw||(e.l+=2),a;case 3:return a=e.read_shift(4,"i"),a;case 11:return e.read_shift(4)!==0;case 19:return a=e.read_shift(4),a;case 30:e.l+=4,val=Ia(e,e[e.l-4]).replace(/(^|[^\u0000])\u0000+$/,"$1");break;case 31:e.l+=4,val=Ia(e,e[e.l-4]).replace(/(^|[^\u0000])\u0000+$/,"$1");break;case 64:return ko(e);case 65:return _l(e);case 71:return e1(e);case 80:return Ia(e,n,!i.raw).replace(lr,"");case 81:return Kd(e,n).replace(lr,"");case 4108:return Qd(e);case 4126:case 4127:return n==4127?Zd(e):qd(e);default:throw new Error("TypedPropertyValue unrecognized type "+r+" "+n)}}function sc(e,r){var t=e.l,n=e.read_shift(4),a=e.read_shift(4),i=[],s=0,o=0,c=-1,l={};for(s=0;s!=a;++s){var f=e.read_shift(4),d=e.read_shift(4);i[s]=[f,d+t]}i.sort(function(w,_){return w[1]-_[1]});var h={};for(s=0;s!=a;++s){if(e.l!==i[s][1]){var u=!0;if(s>0&&r)switch(r[i[s-1][0]].t){case 2:e.l+2===i[s][1]&&(e.l+=2,u=!1);break;case 80:e.l<=i[s][1]&&(e.l=i[s][1],u=!1);break;case 4108:e.l<=i[s][1]&&(e.l=i[s][1],u=!1);break}if((!r||s==0)&&e.l<=i[s][1]&&(u=!1,e.l=i[s][1]),u)throw new Error("Read Error: Expected address "+i[s][1]+" at "+e.l+" :"+s)}if(r){if(i[s][0]==0&&i.length>s+1&&i[s][1]==i[s+1][1])continue;var x=r[i[s][0]];if(h[x.n]=Ki(e,x.t,{raw:!0}),x.p==="version"&&(h[x.n]=String(h[x.n]>>16)+"."+("0000"+String(h[x.n]&65535)).slice(-4)),x.n=="CodePage")switch(h[x.n]){case 0:h[x.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Hr(o=h[x.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[x.n])}}else if(i[s][0]===1){if(o=h.CodePage=Ki(e,So),Hr(o),c!==-1){var g=e.l;e.l=i[c][1],l=ic(e,o),e.l=g}}else if(i[s][0]===0){if(o===0){c=s,e.l=i[s+1][1];continue}l=ic(e,o)}else{var p=l[i[s][0]],m;switch(e[e.l]){case 65:e.l+=4,m=_l(e);break;case 30:e.l+=4,m=Ia(e,e[e.l-4]).replace(/(^|[^\u0000])\u0000+$/,"$1");break;case 31:e.l+=4,m=Ia(e,e[e.l-4]).replace(/(^|[^\u0000])\u0000+$/,"$1");break;case 3:e.l+=4,m=e.read_shift(4,"i");break;case 19:e.l+=4,m=e.read_shift(4);break;case 5:e.l+=4,m=e.read_shift(8,"f");break;case 11:e.l+=4,m=St(e,4);break;case 64:e.l+=4,m=Gt(ko(e));break;default:throw new Error("unparsed value: "+e[e.l])}h[p]=m}}return e.l=t+n,h}function oc(e,r,t){var n=e.content;if(!n)return{};It(n,0);var a,i,s,o,c=0;n.chk("feff","Byte Order: "),n.read_shift(2);var l=n.read_shift(4),f=n.read_shift(16);if(f!==je.utils.consts.HEADER_CLSID&&f!==t)throw new Error("Bad PropertySet CLSID "+f);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(i=n.read_shift(16),o=n.read_shift(4),a===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);a===2&&(s=n.read_shift(16),c=n.read_shift(4));var d=sc(n,r),h={SystemIdentifier:l};for(var u in d)h[u]=d[u];if(h.FMTID=i,a===1)return h;if(c-n.l==2&&(n.l+=2),n.l!==c)throw new Error("Length mismatch 2: "+n.l+" !== "+c);var x;try{x=sc(n,null)}catch{}for(u in x)h[u]=x[u];return h.FMTID=[i,s],h}function pn(e,r){return e.read_shift(r),null}function t1(e,r,t){for(var n=[],a=e.l+r;e.l<a;)n.push(t(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return n}function St(e,r){return e.read_shift(r)===1}function wt(e){return e.read_shift(2,"u")}function vl(e,r){return t1(e,r,wt)}function wl(e){var r=e.read_shift(1),t=e.read_shift(1);return t===1?r:r===1}function ha(e,r,t){var n=e.read_shift(t&&t.biff>=12?2:1),a="sbcs-cont",i=er;if(t&&t.biff>=8&&(er=1200),!t||t.biff==8){var s=e.read_shift(1);s&&(a="dbcs-cont")}else t.biff==12&&(a="wstr");t.biff>=2&&t.biff<=5&&(a="cpstr");var o=n?e.read_shift(n,a):"";return er=i,o}function r1(e){var r=er;er=1200;var t=e.read_shift(2),n=e.read_shift(1),a=n&4,i=n&8,s=1+(n&1),o=0,c,l={};i&&(o=e.read_shift(2)),a&&(c=e.read_shift(4));var f=s==2?"dbcs-cont":"sbcs-cont",d=t===0?"":e.read_shift(t,f);return i&&(e.l+=4*o),a&&(e.l+=c),l.t=d,i||(l.raw="<t>"+l.t+"</t>",l.r=l.t),er=r,l}function Vn(e,r,t){var n;if(t){if(t.biff>=2&&t.biff<=5)return e.read_shift(r,"cpstr");if(t.biff>=12)return e.read_shift(r,"dbcs-cont")}var a=e.read_shift(1);return a===0?n=e.read_shift(r,"sbcs-cont"):n=e.read_shift(r,"dbcs-cont"),n}function Za(e,r,t){var n=e.read_shift(t&&t.biff==2?1:2);return n===0?(e.l++,""):Vn(e,n,t)}function Gn(e,r,t){if(t.biff>5)return Za(e,r,t);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,t.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function n1(e){var r=e.read_shift(1);e.l++;var t=e.read_shift(2);return e.l+=2,[r,t]}function a1(e){var r=e.read_shift(4),t=e.l,n=!1;r>24&&(e.l+=r-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=t);var a=e.read_shift((n?r-24:r)>>1,"utf16le").replace(lr,"");return n&&(e.l+=24),a}function i1(e){for(var r=e.read_shift(2),t="";r-- >0;)t+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=e.read_shift(4);if(a===0)return t+n.replace(/\\/g,"/");var i=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var s=e.read_shift(i>>1,"utf16le").replace(lr,"");return t+s}function s1(e,r){var t=e.read_shift(16);switch(r-=16,t){case"e0c9ea79f9bace118c8200aa004ba90b":return a1(e,r);case"0303000000000000c000000000000046":return i1(e,r);default:throw new Error("Unsupported Moniker "+t)}}function Bi(e){var r=e.read_shift(4),t=r>0?e.read_shift(r,"utf16le").replace(lr,""):"";return t}function o1(e,r){var t=e.l+r,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=e.read_shift(2);e.l+=2;var i,s,o,c,l="",f,d;a&16&&(i=Bi(e,t-e.l)),a&128&&(s=Bi(e,t-e.l)),(a&257)===257&&(o=Bi(e,t-e.l)),(a&257)===1&&(c=s1(e,t-e.l)),a&8&&(l=Bi(e,t-e.l)),a&32&&(f=e.read_shift(16)),a&64&&(d=ko(e)),e.l=t;var h=s||o||c||"";h&&l&&(h+="#"+l),h||(h="#"+l),a&2&&h.charAt(0)=="/"&&h.charAt(1)!="/"&&(h="file://"+h);var u={Target:h};return f&&(u.guid=f),d&&(u.time=d),i&&(u.Tooltip=i),u}function yl(e){var r=e.read_shift(1),t=e.read_shift(1),n=e.read_shift(1),a=e.read_shift(1);return[r,t,n,a]}function Sl(e,r){var t=yl(e,r);return t[3]=0,t}function Gr(e,r,t){var n=e.read_shift(2),a=e.read_shift(2),i={r:n,c:a,ixfe:0};if(t&&t.biff==2||r==7){var s=e.read_shift(1);i.ixfe=s&63,e.l+=2}else i.ixfe=e.read_shift(2);return i}function c1(e){var r=e.read_shift(2),t=e.read_shift(2);return e.l+=8,{type:r,flags:t}}function l1(e,r,t){return r===0?"":Gn(e,r,t)}function f1(e,r,t){var n=t.biff>8?4:2,a=e.read_shift(n),i=e.read_shift(n,"i"),s=e.read_shift(n,"i");return[a,i,s]}function kl(e){var r=e.read_shift(2),t=is(e);return[r,t]}function u1(e,r,t){e.l+=4,r-=4;var n=e.l+r,a=ha(e,r,t),i=e.read_shift(2);if(n-=e.l,i!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+i);return e.l+=i,a}function ss(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);return{s:{c:n,r},e:{c:a,r:t}}}function El(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(1),a=e.read_shift(1);return{s:{c:n,r},e:{c:a,r:t}}}var h1=El;function Cl(e){e.l+=4;var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[t,r,n]}function d1(e){var r={};return e.l+=4,e.l+=16,r.fSharedNote=e.read_shift(2),e.l+=4,r}function p1(e){var r={};return e.l+=4,e.cf=e.read_shift(2),r}function Jt(e){e.l+=2,e.l+=e.read_shift(2)}var m1={0:Jt,4:Jt,5:Jt,6:Jt,7:p1,8:Jt,9:Jt,10:Jt,11:Jt,12:Jt,13:d1,14:Jt,15:Jt,16:Jt,17:Jt,18:Jt,19:Jt,20:Jt,21:Cl};function x1(e,r){for(var t=e.l+r,n=[];e.l<t;){var a=e.read_shift(2);e.l-=2;try{n[a]=m1[a](e,t-e.l)}catch{return e.l=t,n}}return e.l!=t&&(e.l=t),n}function Li(e,r){var t={BIFFVer:0,dt:0};switch(t.BIFFVer=e.read_shift(2),r-=2,r>=2&&(t.dt=e.read_shift(2),e.l-=2),t.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(r>6)throw new Error("Unexpected BIFF Ver "+t.BIFFVer)}return e.read_shift(r),t}function g1(e,r){return r===0||e.read_shift(2),1200}function _1(e,r,t){if(t.enc)return e.l+=r,"";var n=e.l,a=Gn(e,0,t);return e.read_shift(r+n-e.l),a}function v1(e,r,t){var n=t&&t.biff==8||r==2?e.read_shift(2):(e.l+=r,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function w1(e,r,t){var n="";if(t.biff==4)return n=ha(e,0,t),n.length===0&&(n="Sheet1"),{name:n};var a=e.read_shift(4),i=e.read_shift(1)&3,s=e.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}return n=ha(e,0,t),n.length===0&&(n="Sheet1"),{pos:a,hs:i,dt:s,name:n}}function y1(e,r){for(var t=e.l+r,n=e.read_shift(4),a=e.read_shift(4),i=[],s=0;s!=a&&e.l<t;++s)i.push(r1(e));return i.Count=n,i.Unique=a,i}function S1(e,r){var t={};return t.dsst=e.read_shift(2),e.l+=r-2,t}function k1(e){var r={};r.r=e.read_shift(2),r.c=e.read_shift(2),r.cnt=e.read_shift(2)-r.c;var t=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(r.level=n&7),n&32&&(r.hidden=!0),n&64&&(r.hpt=t/20),r}function E1(e){var r=c1(e);if(r.type!=2211)throw new Error("Invalid Future Record "+r.type);var t=e.read_shift(4);return t!==0}function C1(e){return e.read_shift(2),e.read_shift(4)}function cc(e,r,t){var n=0;t&&t.biff==2||(n=e.read_shift(2));var a=e.read_shift(2);t&&t.biff==2&&(n=1-(a>>15),a&=32767);var i={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[i,a]}function T1(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),o=e.read_shift(2),c=e.read_shift(2),l=e.read_shift(2);return{Pos:[r,t],Dim:[n,a],Flags:i,CurTab:s,FirstTab:o,Selected:c,TabRatio:l}}function b1(e,r,t){if(t&&t.biff>=2&&t.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function F1(){}function A1(e,r,t){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(t&&t.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=ha(e,0,t),n}function D1(e,r,t){var n=Gr(e,r,t);return n.isst=e.read_shift(4),n}function R1(e,r,t){t.biffguess&&t.biff==2&&(t.biff=5);var n=e.l+r,a=Gr(e,r,t),i=Za(e,n-e.l,t);return a.val=i,a}function O1(e,r,t){var n=e.read_shift(2),a=Gn(e,0,t);return[n,a]}var P1=Gn;function lc(e,r,t){var n=e.l+r,a=t.biff==8||!t.biff?4:2,i=e.read_shift(a),s=e.read_shift(a),o=e.read_shift(2),c=e.read_shift(2);return e.l=n,{s:{r:i,c:o},e:{r:s,c}}}function N1(e){var r=e.read_shift(2),t=e.read_shift(2),n=kl(e);return{r,c:t,ixfe:n[0],rknum:n[1]}}function I1(e,r){for(var t=e.l+r-2,n=e.read_shift(2),a=e.read_shift(2),i=[];e.l<t;)i.push(kl(e));if(e.l!==t)throw new Error("MulRK read error");var s=e.read_shift(2);if(i.length!=s-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:s,rkrec:i}}function M1(e,r){for(var t=e.l+r-2,n=e.read_shift(2),a=e.read_shift(2),i=[];e.l<t;)i.push(e.read_shift(2));if(e.l!==t)throw new Error("MulBlank read error");var s=e.read_shift(2);if(i.length!=s-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:s,ixfe:i}}function B1(e,r,t,n){var a={},i=e.read_shift(4),s=e.read_shift(4),o=e.read_shift(4),c=e.read_shift(2);return a.patternType=Nd[o>>26],n.cellStyles&&(a.alc=i&7,a.fWrap=i>>3&1,a.alcV=i>>4&7,a.fJustLast=i>>7&1,a.trot=i>>8&255,a.cIndent=i>>16&15,a.fShrinkToFit=i>>20&1,a.iReadOrder=i>>22&2,a.fAtrNum=i>>26&1,a.fAtrFnt=i>>27&1,a.fAtrAlc=i>>28&1,a.fAtrBdr=i>>29&1,a.fAtrPat=i>>30&1,a.fAtrProt=i>>31&1,a.dgLeft=s&15,a.dgRight=s>>4&15,a.dgTop=s>>8&15,a.dgBottom=s>>12&15,a.icvLeft=s>>16&127,a.icvRight=s>>23&127,a.grbitDiag=s>>30&3,a.icvTop=o&127,a.icvBottom=o>>7&127,a.icvDiag=o>>14&127,a.dgDiag=o>>21&15,a.icvFore=c&127,a.icvBack=c>>7&127,a.fsxButton=c>>14&1),a}function L1(e,r,t){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,r-=6,n.data=B1(e,r,n.fStyle,t),n}function U1(e){var r={};return r.ifnt=e.read_shift(1),e.l++,r.flags=e.read_shift(1),r.numFmtId=r.flags&63,r.flags>>=6,r.fStyle=0,r.data={},r}function W1(e){var r={};return r.ifnt=e.read_shift(1),r.numFmtId=e.read_shift(1),r.flags=e.read_shift(2),r.fStyle=r.flags>>2&1,r.data={},r}function V1(e){var r={};return r.ifnt=e.read_shift(1),r.numFmtId=e.read_shift(1),r.flags=e.read_shift(2),r.fStyle=r.flags>>2&1,r.data={},r}function H1(e){e.l+=4;var r=[e.read_shift(2),e.read_shift(2)];if(r[0]!==0&&r[0]--,r[1]!==0&&r[1]--,r[0]>7||r[1]>7)throw new Error("Bad Gutters: "+r.join("|"));return r}function z1(e,r,t){var n=Gr(e,6,t),a=wl(e,2);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function X1(e,r,t){t.biffguess&&t.biff==2&&(t.biff=5);var n=Gr(e,6,t),a=tr(e,8);return n.val=a,n}var fc=l1;function G1(e,r,t){var n=e.l+r,a=e.read_shift(2),i=e.read_shift(2);if(t.sbcch=i,i==1025||i==14849)return[i,a];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var s=Vn(e,i),o=[];n>e.l;)o.push(Za(e));return[i,a,s,o]}function uc(e,r,t){var n=e.read_shift(2),a,i={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return t.sbcch===14849&&(a=u1(e,r-2,t)),i.body=a||e.read_shift(r-2),typeof a=="string"&&(i.Name=a),i}function hc(e,r,t){var n=e.l+r,a=e.read_shift(2),i=e.read_shift(1),s=e.read_shift(1),o=e.read_shift(t&&t.biff==2?1:2),c=0;(!t||t.biff>=5)&&(t.biff!=5&&(e.l+=2),c=e.read_shift(2),t.biff==5&&(e.l+=2),e.l+=4);var l=Vn(e,s,t);a&32&&(l=pl[l.charCodeAt(0)]);var f=n-e.l;t&&t.biff==2&&--f;var d=n==e.l||o===0||!(f>0)?[]:wg(e,f,t,o);return{chKey:i,Name:l,itab:c,rgce:d}}function Tl(e,r,t){if(t.biff<8||!(t.biff>8)&&r==e[e.l]+(e[e.l+1]==3?1:0)+1)return dc(e,r,t);for(var n=[],a=e.l+r,i=e.read_shift(t.biff>8?4:2);i--!==0;)n.push(f1(e,t.biff>8?12:6,t));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function dc(e,r,t){e[e.l+1]==3&&e[e.l]++;var n=ha(e,r,t);return n.charCodeAt(0)==3?n.slice(1):n}function j1(e,r,t){if(t.biff<8){e.l+=r;return}var n=e.read_shift(2),a=e.read_shift(2),i=Vn(e,n,t),s=Vn(e,a,t);return[i,s]}function $1(e,r,t){var n=El(e,6);e.l++;var a=e.read_shift(1);return r-=8,[yg(e,r,t),a,n]}function pc(e,r,t){var n=h1(e,6);switch(t.biff){case 2:e.l++,r-=7;break;case 3:case 4:e.l+=2,r-=8;break;default:e.l+=6,r-=12}return[n,_g(e,r,t,n)]}function Y1(e){var r=e.read_shift(4)!==0,t=e.read_shift(4)!==0,n=e.read_shift(4);return[r,t,n]}function K1(e,r,t){var n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),o=Gn(e,0,t);return[{r:n,c:a},o,s,i]}function Z1(e,r,t){if(t&&t.biff<8){var n=e.read_shift(2),a=e.read_shift(2);if(n==65535||n==-1)return;var i=e.read_shift(2),s=e.read_shift(Math.min(i,2048),"cpstr");return[{r:n,c:a},s]}return K1(e,r,t)}function q1(e,r){for(var t=[],n=e.read_shift(2);n--;)t.push(ss(e,r));return t}function J1(e,r,t){if(t&&t.biff<8)return ep(e,r,t);var n=Cl(e,22),a=x1(e,r-22,n[1]);return{cmo:n,ft:a}}var Q1={8:function(e,r){var t=e.l+r;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=t,{fmt:n}}};function ep(e,r,t){e.l+=4;var n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,r-=36;var s=[];return s.push((Q1[n]||ar)(e,r,t)),{cmo:[a,n,i],ft:s}}function tp(e,r,t){var n=e.l,a="";try{e.l+=4;var i=(t.lastobj||{cmo:[0,0]}).cmo[1],s;[0,5,7,11,12,14].indexOf(i)==-1?e.l+=6:s=n1(e,6,t);var o=e.read_shift(2);e.read_shift(2),wt(e,2);var c=e.read_shift(2);e.l+=c;for(var l=1;l<e.lens.length-1;++l){if(e.l-n!=e.lens[l])throw new Error("TxO: bad continue record");var f=e[e.l],d=Vn(e,e.lens[l+1]-e.lens[l]-1);if(a+=d,a.length>=(f?o:2*o))break}if(a.length!==o&&a.length!==o*2)throw new Error("cchText: "+o+" != "+a.length);return e.l=n+r,{t:a}}catch{return e.l=n+r,{t:a}}}function rp(e,r){var t=ss(e,8);e.l+=16;var n=o1(e,r-24);return[t,n]}function np(e,r){e.read_shift(2);var t=ss(e,8),n=e.read_shift((r-10)/2,"dbcs-cont");return n=n.replace(lr,""),[t,n]}function ap(e){var r=[0,0],t;return t=e.read_shift(2),r[0]=rc[t]||t,t=e.read_shift(2),r[1]=rc[t]||t,r}function ip(e){for(var r=e.read_shift(2),t=[];r-- >0;)t.push(Sl(e,8));return t}function sp(e){for(var r=e.read_shift(2),t=[];r-- >0;)t.push(Sl(e,8));return t}function op(e){e.l+=2;var r={cxfs:0,crc:0};return r.cxfs=e.read_shift(2),r.crc=e.read_shift(4),r}function bl(e,r,t){if(!t.cellStyles)return ar(e,r);var n=t&&t.biff>=12?4:2,a=e.read_shift(n),i=e.read_shift(n),s=e.read_shift(n),o=e.read_shift(n),c=e.read_shift(2);n==2&&(e.l+=2);var l={s:a,e:i,w:s,ixfe:o,flags:c};return(t.biff>=5||!t.biff)&&(l.level=c>>8&7),l}function cp(e,r){var t={};return r<32||(e.l+=16,t.header=tr(e,8),t.footer=tr(e,8),e.l+=2),t}function lp(e,r,t){var n={area:!1};if(t.biff!=5)return e.l+=r,n;var a=e.read_shift(1);return e.l+=3,a&16&&(n.area=!0),n}var fp=Gr,up=vl,hp=Za;function dp(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(4),a={fmt:r,env:t,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,a}function pp(e,r,t){t.biffguess&&t.biff==5&&(t.biff=2);var n=Gr(e,7,t),a=Gn(e,r-7,t);return n.t="str",n.val=a,n}function mp(e,r,t){var n=Gr(e,7,t),a=tr(e,8);return n.t="n",n.val=a,n}function xp(e,r,t){var n=Gr(e,7,t),a=e.read_shift(2);return n.t="n",n.val=a,n}function gp(e){var r=e.read_shift(1);return r===0?(e.l++,""):e.read_shift(r,"sbcs-cont")}function _p(e,r,t){var n=e.l+7,a=Gr(e,6,t);e.l=n;var i=wl(e,2);return a.val=i,a.t=i===!0||i===!1?"b":"e",a}function vp(e,r){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=r-13}function wp(e,r,t){var n=e.l+r,a=Gr(e,6,t),i=e.read_shift(2),s=Vn(e,i,t);return e.l=n,a.t="str",a.val=s,a}function yp(e){var r=e.read_shift(4),t=e.read_shift(1),n=e.read_shift(t,"sbcs");return n.length===0&&(n="Sheet1"),{flags:r,name:n}}var Sp=[2,3,48,49,131,139,140,245],mc=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},r=lo({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(o,c){var l=[],f=_n(1);switch(c.type){case"base64":f=wr(Sr(o));break;case"binary":f=wr(o);break;case"buffer":case"array":f=o;break}It(f,0);var d=f.read_shift(1),h=!!(d&136),u=!1,x=!1;switch(d){case 2:break;case 3:break;case 48:u=!0,h=!0;break;case 49:u=!0,h=!0;break;case 131:break;case 139:break;case 140:x=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+d.toString(16))}var g=0,p=521;d==2&&(g=f.read_shift(2)),f.l+=3,d!=2&&(g=f.read_shift(4)),g>1048576&&(g=1e6),d!=2&&(p=f.read_shift(2));var m=f.read_shift(2),w=c.codepage||1252;d!=2&&(f.l+=16,f.read_shift(1),f[f.l]!==0&&(w=e[f[f.l]]),f.l+=1,f.l+=2),x&&(f.l+=36);for(var _=[],F={},N=Math.min(f.length,d==2?521:p-10-(u?264:0)),j=x?32:11;f.l<N&&f[f.l]!=13;)switch(F={},F.name=(typeof Le<"u"?Le.utils.decode(w,f.slice(f.l,f.l+j)):on(f.slice(f.l,f.l+j))).replace(/[\u0000\r\n][\S\s]*$/g,""),f.l+=j,F.type=String.fromCharCode(f.read_shift(1)),d!=2&&!x&&(F.offset=f.read_shift(4)),F.len=f.read_shift(1),d==2&&(F.offset=f.read_shift(2)),F.dec=f.read_shift(1),F.name.length&&_.push(F),d!=2&&(f.l+=x?13:14),F.type){case"B":(!u||F.len!=8)&&c.WTF&&console.log("Skipping "+F.name+":"+F.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+F.name+":"+F.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+F.type)}if(f[f.l]!==13&&(f.l=p-1),f.read_shift(1)!==13)throw new Error("DBF Terminator not found "+f.l+" "+f[f.l]);f.l=p;var O=0,P=0;for(l[0]=[],P=0;P!=_.length;++P)l[0][P]=_[P].name;for(;g-- >0;){if(f[f.l]===42){f.l+=m;continue}for(++f.l,l[++O]=[],P=0,P=0;P!=_.length;++P){var D=f.slice(f.l,f.l+_[P].len);f.l+=_[P].len,It(D,0);var W=typeof Le<"u"?Le.utils.decode(w,D):on(D);switch(_[P].type){case"C":W.trim().length&&(l[O][P]=W.replace(/([^\s])\s+$/,"$1"));break;case"D":W.length===8?(l[O][P]=new Date(Date.UTC(+W.slice(0,4),+W.slice(4,6)-1,+W.slice(6,8),0,0,0,0)),c&&c.UTC||(l[O][P]=Wn(l[O][P]))):l[O][P]=W;break;case"F":l[O][P]=parseFloat(W.trim());break;case"+":case"I":l[O][P]=x?D.read_shift(-4,"i")^2147483648:D.read_shift(4,"i");break;case"L":switch(W.trim().toUpperCase()){case"Y":case"T":l[O][P]=!0;break;case"N":case"F":l[O][P]=!1;break;case"":case"\0":case"?":break;default:throw new Error("DBF Unrecognized L:|"+W+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+d.toString(16));l[O][P]="##MEMO##"+(x?parseInt(W.trim(),10):D.read_shift(4));break;case"N":W=W.replace(/\u0000/g,"").trim(),W&&W!="."&&(l[O][P]=+W||0);break;case"@":l[O][P]=new Date(D.read_shift(-8,"f")-621356832e5);break;case"T":{var B=D.read_shift(4),U=D.read_shift(4);if(B==0&&U==0)break;l[O][P]=new Date((B-2440588)*864e5+U),c&&c.UTC||(l[O][P]=Wn(l[O][P]))}break;case"Y":l[O][P]=D.read_shift(4,"i")/1e4+D.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":l[O][P]=-D.read_shift(-8,"f");break;case"B":if(u&&_[P].len==8){l[O][P]=D.read_shift(8,"f");break}case"G":case"P":D.l+=_[P].len;break;case"0":if(_[P].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+_[P].type)}}}if(d!=2&&f.l<f.length&&f[f.l++]!=26)throw new Error("DBF EOF Marker missing "+(f.l-1)+" of "+f.length+" "+f[f.l-1].toString(16));return c&&c.sheetRows&&(l=l.slice(0,c.sheetRows)),c.DBF=_,l}function n(o,c){var l=c||{};l.dateNF||(l.dateNF="yyyymmdd");var f=ma(t(o,l),l);return f["!cols"]=l.DBF.map(function(d){return{wch:d.len,DBF:d}}),delete l.DBF,f}function a(o,c){try{var l=Sn(n(o,c),c);return l.bookType="dbf",l}catch(f){if(c&&c.WTF)throw f}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function s(o,c){if(!o["!ref"])throw new Error("Cannot export empty sheet to DBF");var l=c||{},f=er;if(+l.codepage>=0&&Hr(+l.codepage),l.type=="string")throw new Error("Cannot write DBF to JS string");var d=qs(),h=no(o,{header:1,raw:!0,cellDates:!0}),u=h[0],x=h.slice(1),g=o["!cols"]||[],p=0,m=0,w=0,_=1;for(p=0;p<u.length;++p){if(((g[p]||{}).DBF||{}).name){u[p]=g[p].DBF.name,++w;continue}if(u[p]!=null){if(++w,typeof u[p]=="number"&&(u[p]=u[p].toString(10)),typeof u[p]!="string")throw new Error("DBF Invalid column name "+u[p]+" |"+typeof u[p]+"|");if(u.indexOf(u[p])!==p){for(m=0;m<1024;++m)if(u.indexOf(u[p]+"_"+m)==-1){u[p]+="_"+m;break}}}}var F=Ct(o["!ref"]),N=[],j=[],O=[];for(p=0;p<=F.e.c-F.s.c;++p){var P="",D="",W=0,B=[];for(m=0;m<x.length;++m)x[m][p]!=null&&B.push(x[m][p]);if(B.length==0||u[p]==null){N[p]="?";continue}for(m=0;m<B.length;++m){switch(typeof B[m]){case"number":D="B";break;case"string":D="C";break;case"boolean":D="L";break;case"object":D=B[m]instanceof Date?"D":"C";break;default:D="C"}W=Math.max(W,(typeof Le<"u"&&typeof B[m]=="string"?Le.utils.encode(ua,B[m]):String(B[m])).length),P=P&&P!=D?"C":D}W>250&&(W=250),D=((g[p]||{}).DBF||{}).type,D=="C"&&g[p].DBF.len>W&&(W=g[p].DBF.len),P=="B"&&D=="N"&&(P="N",O[p]=g[p].DBF.dec,W=g[p].DBF.len),j[p]=P=="C"||D=="N"?W:i[P]||0,_+=j[p],N[p]=P}var U=d.next(32);for(U.write_shift(4,318902576),U.write_shift(4,x.length),U.write_shift(2,296+32*w),U.write_shift(2,_),p=0;p<4;++p)U.write_shift(4,0);var K=+r[er]||3;for(U.write_shift(4,0|K<<8),e[K]!=+l.codepage&&(l.codepage&&console.error("DBF Unsupported codepage "+er+", using 1252"),er=1252),p=0,m=0;p<u.length;++p)if(u[p]!=null){var he=d.next(32),re=(u[p].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);he.write_shift(1,re,"sbcs"),he.write_shift(1,N[p]=="?"?"C":N[p],"sbcs"),he.write_shift(4,m),he.write_shift(1,j[p]||i[N[p]]||0),he.write_shift(1,O[p]||0),he.write_shift(1,2),he.write_shift(4,0),he.write_shift(1,0),he.write_shift(4,0),he.write_shift(4,0),m+=j[p]||i[N[p]]||0}var Ee=d.next(264);for(Ee.write_shift(4,13),p=0;p<65;++p)Ee.write_shift(4,0);for(p=0;p<x.length;++p){var te=d.next(_);for(te.write_shift(1,0),m=0;m<u.length;++m)if(u[m]!=null)switch(N[m]){case"L":te.write_shift(1,x[p][m]==null?63:x[p][m]?84:70);break;case"B":te.write_shift(8,x[p][m]||0,"f");break;case"N":var ve="0";for(typeof x[p][m]=="number"&&(ve=x[p][m].toFixed(O[m]||0)),ve.length>j[m]&&(ve=ve.slice(0,j[m])),w=0;w<j[m]-ve.length;++w)te.write_shift(1,32);te.write_shift(1,ve,"sbcs");break;case"D":x[p][m]?(te.write_shift(4,("0000"+x[p][m].getFullYear()).slice(-4),"sbcs"),te.write_shift(2,("00"+(x[p][m].getMonth()+1)).slice(-2),"sbcs"),te.write_shift(2,("00"+x[p][m].getDate()).slice(-2),"sbcs")):te.write_shift(8,"00000000","sbcs");break;case"C":var Te=te.l,se=String(x[p][m]!=null?x[p][m]:"").slice(0,j[m]);for(te.write_shift(1,se,"cpstr"),Te+=j[m]-te.l,w=0;w<Te;++w)te.write_shift(1,32);break}}return er=f,d.next(1).write_shift(1,26),d.end()}return{to_workbook:a,to_sheet:n,from_sheet:s}})(),kp=(function(){var e={AA:"\xC0",BA:"\xC1",CA:"\xC2",DA:195,HA:"\xC4",JA:197,AE:"\xC8",BE:"\xC9",CE:"\xCA",HE:"\xCB",AI:"\xCC",BI:"\xCD",CI:"\xCE",HI:"\xCF",AO:"\xD2",BO:"\xD3",CO:"\xD4",DO:213,HO:"\xD6",AU:"\xD9",BU:"\xDA",CU:"\xDB",HU:"\xDC",Aa:"\xE0",Ba:"\xE1",Ca:"\xE2",Da:227,Ha:"\xE4",Ja:229,Ae:"\xE8",Be:"\xE9",Ce:"\xEA",He:"\xEB",Ai:"\xEC",Bi:"\xED",Ci:"\xEE",Hi:"\xEF",Ao:"\xF2",Bo:"\xF3",Co:"\xF4",Do:245,Ho:"\xF6",Au:"\xF9",Bu:"\xFA",Cu:"\xFB",Hu:"\xFC",KC:"\xC7",Kc:"\xE7",q:"\xE6",z:"\u0153",a:"\xC6",j:"\u0152",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},r=new RegExp("\x1BN("+Pr(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1").replace("{","\\{")+"|\\|)","gm");try{r=new RegExp("\x1BN("+Pr(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm")}catch{}var t=function(u,x){var g=e[x];return typeof g=="number"?D0(g):g},n=function(u,x,g){var p=x.charCodeAt(0)-32<<4|g.charCodeAt(0)-48;return p==59?u:D0(p)};e["|"]=254;var a=function(u){return u.replace(/\n/g,"\x1B :").replace(/\r/g,"\x1B =")};function i(u,x){switch(x.type){case"base64":return s(Sr(u),x);case"binary":return s(u,x);case"buffer":return s(He&&Buffer.isBuffer(u)?u.toString("binary"):on(u),x);case"array":return s(Un(u),x)}throw new Error("Unrecognized type "+x.type)}function s(u,x){var g=u.split(/[\n\r]+/),p=-1,m=-1,w=0,_=0,F=[],N=[],j=null,O={},P=[],D=[],W=[],B=0,U,K={Workbook:{WBProps:{},Names:[]}};for(+x.codepage>=0&&Hr(+x.codepage);w!==g.length;++w){B=0;var he=g[w].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(r,t),re=he.replace(/;;/g,"\0").split(";").map(function(A){return A.replace(/\u0000/g,";")}),Ee=re[0],te;if(he.length>0)switch(Ee){case"ID":break;case"E":break;case"B":break;case"O":for(_=1;_<re.length;++_)switch(re[_].charAt(0)){case"V":{var ve=parseInt(re[_].slice(1),10);ve>=1&&ve<=4&&(K.Workbook.WBProps.date1904=!0)}break}break;case"W":break;case"P":switch(re[1].charAt(0)){case"P":N.push(he.slice(3).replace(/;;/g,";"));break}break;case"NN":{var Te={Sheet:0};for(_=1;_<re.length;++_)switch(re[_].charAt(0)){case"N":Te.Name=re[_].slice(1);break;case"E":Te.Ref=(x&&x.sheet||"Sheet1")+"!"+Mn(re[_].slice(1));break}K.Workbook.Names.push(Te)}break;case"C":var se=!1,Pe=!1,J=!1,ke=!1,ge=-1,Ue=-1,we="",be="z",b="";for(_=1;_<re.length;++_)switch(re[_].charAt(0)){case"A":b=re[_].slice(1);break;case"X":m=parseInt(re[_].slice(1),10)-1,Pe=!0;break;case"Y":for(p=parseInt(re[_].slice(1),10)-1,Pe||(m=0),U=F.length;U<=p;++U)F[U]=[];break;case"K":te=re[_].slice(1),te.charAt(0)==='"'?(te=te.slice(1,te.length-1),be="s"):te==="TRUE"||te==="FALSE"?(te=te==="TRUE",be="b"):te.charAt(0)=="#"&&zt[te]!=null?(be="e",te=zt[te]):isNaN(yr(te))||(te=yr(te),be="n",j!==null&&Xr(j)&&x.cellDates&&(te=gn(K.Workbook.WBProps.date1904?te+1462:te),be=typeof te=="number"?"n":"d")),typeof Le<"u"&&typeof te=="string"&&(x||{}).type!="string"&&(x||{}).codepage&&(te=Le.utils.decode(x.codepage,te)),se=!0;break;case"E":ke=!0,we=Mn(re[_].slice(1),{r:p,c:m});break;case"S":J=!0;break;case"G":break;case"R":ge=parseInt(re[_].slice(1),10)-1;break;case"C":Ue=parseInt(re[_].slice(1),10)-1;break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+he)}if(se&&(F[p][m]?(F[p][m].t=be,F[p][m].v=te):F[p][m]={t:be,v:te},j&&(F[p][m].z=j),x.cellText!==!1&&j&&(F[p][m].w=kr(F[p][m].z,F[p][m].v,{date1904:K.Workbook.WBProps.date1904})),j=null),J){if(ke)throw new Error("SYLK shared formula cannot have own formula");var I=ge>-1&&F[ge][Ue];if(!I||!I[1])throw new Error("SYLK shared formula cannot find base");we=Ml(I[1],{r:p-ge,c:m-Ue})}we&&(F[p][m]?F[p][m].f=we:F[p][m]={t:"n",f:we}),b&&(F[p][m]||(F[p][m]={t:"z"}),F[p][m].c=[{a:"SheetJSYLK",t:b}]);break;case"F":var R=0;for(_=1;_<re.length;++_)switch(re[_].charAt(0)){case"X":m=parseInt(re[_].slice(1),10)-1,++R;break;case"Y":for(p=parseInt(re[_].slice(1),10)-1,U=F.length;U<=p;++U)F[U]=[];break;case"M":B=parseInt(re[_].slice(1),10)/20;break;case"F":break;case"G":break;case"P":j=N[parseInt(re[_].slice(1),10)];break;case"S":break;case"D":break;case"N":break;case"W":for(W=re[_].slice(1).split(" "),U=parseInt(W[0],10);U<=parseInt(W[1],10);++U)B=parseInt(W[2],10),D[U-1]=B===0?{hidden:!0}:{wch:B};break;case"C":m=parseInt(re[_].slice(1),10)-1,D[m]||(D[m]={});break;case"R":p=parseInt(re[_].slice(1),10)-1,P[p]||(P[p]={}),B>0?(P[p].hpt=B,P[p].hpx=ja(B)):B===0&&(P[p].hidden=!0);break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+he)}R<1&&(j=null);break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+he)}}return P.length>0&&(O["!rows"]=P),D.length>0&&(O["!cols"]=D),D.forEach(function(A){da(A)}),x&&x.sheetRows&&(F=F.slice(0,x.sheetRows)),[F,O,K]}function o(u,x){var g=i(u,x),p=g[0],m=g[1],w=g[2],_=Nt(x);_.date1904=(((w||{}).Workbook||{}).WBProps||{}).date1904;var F=ma(p,_);Pr(m).forEach(function(j){F[j]=m[j]});var N=Sn(F,x);return Pr(w).forEach(function(j){N[j]=w[j]}),N.bookType="sylk",N}function c(u,x,g,p,m,w){var _="C;Y"+(g+1)+";X"+(p+1)+";K";switch(u.t){case"n":_+=isFinite(u.v)?u.v||0:pr[isNaN(u.v)?36:7],u.f&&!u.F&&(_+=";E"+nx(u.f,{r:g,c:p}));break;case"b":_+=u.v?"TRUE":"FALSE";break;case"e":_+=u.w||pr[u.v]||u.v;break;case"d":_+=Mt(Gt(u.v,w),w);break;case"s":_+='"'+(u.v==null?"":String(u.v)).replace(/"/g,"").replace(/;/g,";;")+'"';break}return _}function l(u,x,g){var p="C;Y"+(x+1)+";X"+(g+1)+";A";return p+=a(u.map(function(m){return m.t}).join("")),p}function f(u,x){x.forEach(function(g,p){var m="F;W"+(p+1)+" "+(p+1)+" ";g.hidden?m+="0":(typeof g.width=="number"&&!g.wpx&&(g.wpx=qi(g.width)),typeof g.wpx=="number"&&!g.wch&&(g.wch=Ji(g.wpx)),typeof g.wch=="number"&&(m+=Math.round(g.wch))),m.charAt(m.length-1)!=" "&&u.push(m)})}function d(u,x){x.forEach(function(g,p){var m="F;";g.hidden?m+="M0;":g.hpt?m+="M"+20*g.hpt+";":g.hpx&&(m+="M"+20*Nl(g.hpx)+";"),m.length>2&&u.push(m+"R"+(p+1))})}function h(u,x,g){x||(x={}),x._formats=["General"];var p=["ID;PSheetJS;N;E"],m=[],w=Ct(u["!ref"]||"A1"),_,F=u["!data"]!=null,N=`\r
`,j=(((g||{}).Workbook||{}).WBProps||{}).date1904,O="General";p.push("P;PGeneral");var P=w.s.r,D=w.s.c,W=[];if(u["!ref"]){for(P=w.s.r;P<=w.e.r;++P)if(!(F&&!u["!data"][P])){for(W=[],D=w.s.c;D<=w.e.c;++D)_=F?u["!data"][P][D]:u[qe(D)+at(P)],!(!_||!_.c)&&W.push(l(_.c,P,D));W.length&&m.push(W.join(N))}}if(u["!ref"]){for(P=w.s.r;P<=w.e.r;++P)if(!(F&&!u["!data"][P])){for(W=[],D=w.s.c;D<=w.e.c;++D)if(_=F?u["!data"][P][D]:u[qe(D)+at(P)],!(!_||_.v==null&&(!_.f||_.F))){if((_.z||(_.t=="d"?De[14]:"General"))!=O){var B=x._formats.indexOf(_.z);B==-1&&(x._formats.push(_.z),B=x._formats.length-1,p.push("P;P"+_.z.replace(/;/g,";;"))),W.push("F;P"+B+";Y"+(P+1)+";X"+(D+1))}W.push(c(_,u,P,D,x,j))}m.push(W.join(N))}}return p.push("F;P0;DG0G8;M255"),u["!cols"]&&f(p,u["!cols"]),u["!rows"]&&d(p,u["!rows"]),u["!ref"]&&p.push("B;Y"+(w.e.r-w.s.r+1)+";X"+(w.e.c-w.s.c+1)+";D"+[w.s.c,w.s.r,w.e.c,w.e.r].join(" ")),p.push("O;L;D;B"+(j?";V4":"")+";K47;G100 0.001"),delete x._formats,p.join(N)+N+m.join(N)+N+"E"+N}return{to_workbook:o,from_sheet:h}})(),Ep=(function(){function e(o,c){switch(c.type){case"base64":return r(Sr(o),c);case"binary":return r(o,c);case"buffer":return r(He&&Buffer.isBuffer(o)?o.toString("binary"):on(o),c);case"array":return r(Un(o),c)}throw new Error("Unrecognized type "+c.type)}function r(o,c){for(var l=o.split(`
`),f=-1,d=-1,h=0,u=[];h!==l.length;++h){if(l[h].trim()==="BOT"){u[++f]=[],d=0;continue}if(!(f<0)){var x=l[h].trim().split(","),g=x[0],p=x[1];++h;for(var m=l[h]||"";(m.match(/["]/g)||[]).length&1&&h<l.length-1;)m+=`
`+l[++h];switch(m=m.trim(),+g){case-1:if(m==="BOT"){u[++f]=[],d=0;continue}else if(m!=="EOD")throw new Error("Unrecognized DIF special command "+m);break;case 0:m==="TRUE"?u[f][d]=!0:m==="FALSE"?u[f][d]=!1:isNaN(yr(p))?isNaN(za(p).getDate())?u[f][d]=p:(u[f][d]=Gt(p),c&&c.UTC||(u[f][d]=Wn(u[f][d]))):u[f][d]=yr(p),++d;break;case 1:m=m.slice(1,m.length-1),m=m.replace(/""/g,'"'),R0&&m&&m.match(/^=".*"$/)&&(m=m.slice(2,-1)),u[f][d++]=m!==""?m:null;break}if(m==="EOD")break}}return c&&c.sheetRows&&(u=u.slice(0,c.sheetRows)),u}function t(o,c){return ma(e(o,c),c)}function n(o,c){var l=Sn(t(o,c),c);return l.bookType="dif",l}function a(o,c){return"0,"+String(o)+`\r
`+c}function i(o){return`1,0\r
"`+o.replace(/"/g,'""')+'"'}function s(o){var c=R0;if(!o["!ref"])throw new Error("Cannot export empty sheet to DIF");for(var l=Ct(o["!ref"]),f=o["!data"]!=null,d=[`TABLE\r
0,1\r
"sheetjs"\r
`,`VECTORS\r
0,`+(l.e.r-l.s.r+1)+`\r
""\r
`,`TUPLES\r
0,`+(l.e.c-l.s.c+1)+`\r
""\r
`,`DATA\r
0,0\r
""\r
`],h=l.s.r;h<=l.e.r;++h){for(var u=f?o["!data"][h]:[],x=`-1,0\r
BOT\r
`,g=l.s.c;g<=l.e.c;++g){var p=f?u&&u[g]:o[Ye({r:h,c:g})];if(p==null){x+=`1,0\r
""\r
`;continue}switch(p.t){case"n":c?p.w!=null?x+="0,"+p.w+`\r
V`:p.v!=null?x+=a(p.v,"V"):p.f!=null&&!p.F?x+=i("="+p.f):x+=`1,0\r
""`:p.v==null?x+=`1,0\r
""`:x+=a(p.v,"V");break;case"b":x+=p.v?a(1,"TRUE"):a(0,"FALSE");break;case"s":x+=i(!c||isNaN(+p.v)?p.v:'="'+p.v+'"');break;case"d":p.w||(p.w=kr(p.z||De[14],Mt(Gt(p.v)))),c?x+=a(p.w,"V"):x+=i(p.w);break;default:x+=`1,0\r
""`}x+=`\r
`}d.push(x)}return d.join("")+`-1,0\r
EOD`}return{to_workbook:n,to_sheet:t,from_sheet:s}})(),Cp=(function(){function e(d){return d.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function r(d){return d.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(d,h){for(var u=d.split(`
`),x=-1,g=-1,p=0,m=[];p!==u.length;++p){var w=u[p].trim().split(":");if(w[0]==="cell"){var _=rr(w[1]);if(m.length<=_.r)for(x=m.length;x<=_.r;++x)m[x]||(m[x]=[]);switch(x=_.r,g=_.c,w[2]){case"t":m[x][g]=e(w[3]);break;case"v":m[x][g]=+w[3];break;case"vtf":var F=w[w.length-1];case"vtc":switch(w[3]){case"nl":m[x][g]=!!+w[4];break;default:m[x][g]=w[w.length-1].charAt(0)=="#"?{t:"e",v:zt[w[w.length-1]]}:+w[4];break}w[2]=="vtf"&&(m[x][g]=[m[x][g],F])}}}return h&&h.sheetRows&&(m=m.slice(0,h.sheetRows)),m}function n(d,h){return ma(t(d,h),h)}function a(d,h){return Sn(n(d,h),h)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),s=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function l(d){if(!d||!d["!ref"])return"";for(var h=[],u=[],x,g="",p=Hn(d["!ref"]),m=d["!data"]!=null,w=p.s.r;w<=p.e.r;++w)for(var _=p.s.c;_<=p.e.c;++_)if(g=Ye({r:w,c:_}),x=m?(d["!data"][w]||[])[_]:d[g],!(!x||x.v==null||x.t==="z")){switch(u=["cell",g,"t"],x.t){case"s":u.push(r(x.v));break;case"b":u[2]="vt"+(x.f?"f":"c"),u[3]="nl",u[4]=x.v?"1":"0",u[5]=r(x.f||(x.v?"TRUE":"FALSE"));break;case"d":var F=Mt(Gt(x.v));u[2]="vtc",u[3]="nd",u[4]=""+F,u[5]=x.w||kr(x.z||De[14],F);break;case"n":isFinite(x.v)?x.f?(u[2]="vtf",u[3]="n",u[4]=x.v,u[5]=r(x.f)):(u[2]="v",u[3]=x.v):(u[2]="vt"+(x.f?"f":"c"),u[3]="e"+pr[isNaN(x.v)?36:7],u[4]="0",u[5]=x.f||u[3].slice(1),u[6]="e",u[7]=u[3].slice(1));break;case"e":continue}h.push(u.join(":"))}return h.push("sheet:c:"+(p.e.c-p.s.c+1)+":r:"+(p.e.r-p.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function f(d){return[i,s,o,s,l(d),c].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:f}})(),Xa=(function(){function e(f,d,h,u,x){x.raw?d[h][u]=f:f===""||(f==="TRUE"?d[h][u]=!0:f==="FALSE"?d[h][u]=!1:isNaN(yr(f))?isNaN(za(f).getDate())?f.charCodeAt(0)==35&&zt[f]!=null?d[h][u]={t:"e",v:zt[f],w:f}:d[h][u]=f:d[h][u]=Gt(f):d[h][u]=yr(f))}function r(f,d){var h=d||{},u=[];if(!f||f.length===0)return u;for(var x=f.split(/[\r\n]/),g=x.length-1;g>=0&&x[g].length===0;)--g;for(var p=10,m=0,w=0;w<=g;++w)m=x[w].indexOf(" "),m==-1?m=x[w].length:m++,p=Math.max(p,m);for(w=0;w<=g;++w){u[w]=[];var _=0;for(e(x[w].slice(0,p).trim(),u,w,_,h),_=1;_<=(x[w].length-p)/10+1;++_)e(x[w].slice(p+(_-1)*10,p+_*10).trim(),u,w,_,h)}return h.sheetRows&&(u=u.slice(0,h.sheetRows)),u}var t={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(f){for(var d={},h=!1,u=0,x=0;u<f.length;++u)(x=f.charCodeAt(u))==34?h=!h:!h&&x in t&&(d[x]=(d[x]||0)+1);x=[];for(u in d)Object.prototype.hasOwnProperty.call(d,u)&&x.push([d[u],u]);if(!x.length){d=n;for(u in d)Object.prototype.hasOwnProperty.call(d,u)&&x.push([d[u],u])}return x.sort(function(g,p){return g[0]-p[0]||n[g[1]]-n[p[1]]}),t[x.pop()[1]]||44}function i(f,d){var h=d||{},u="";Et!=null&&h.dense==null&&(h.dense=Et);var x={};h.dense&&(x["!data"]=[]);var g={s:{c:0,r:0},e:{c:0,r:0}};f.slice(0,4)=="sep="?f.charCodeAt(5)==13&&f.charCodeAt(6)==10?(u=f.charAt(4),f=f.slice(7)):f.charCodeAt(5)==13||f.charCodeAt(5)==10?(u=f.charAt(4),f=f.slice(6)):u=a(f.slice(0,1024)):h&&h.FS?u=h.FS:u=a(f.slice(0,1024));var p=0,m=0,w=0,_=0,F=0,N=u.charCodeAt(0),j=!1,O=0,P=f.charCodeAt(0),D=h.dateNF!=null?wh(h.dateNF):null;function W(){var B=f.slice(_,F);B.slice(-1)=="\r"&&(B=B.slice(0,-1));var U={};if(B.charAt(0)=='"'&&B.charAt(B.length-1)=='"'&&(B=B.slice(1,-1).replace(/""/g,'"')),h.cellText!==!1&&(U.w=B),B.length===0)U.t="z";else if(h.raw)U.t="s",U.v=B;else if(B.trim().length===0)U.t="s",U.v=B;else if(B.charCodeAt(0)==61)B.charCodeAt(1)==34&&B.charCodeAt(B.length-1)==34?(U.t="s",U.v=B.slice(2,-1).replace(/""/g,'"')):ax(B)?(U.t="s",U.f=B.slice(1),U.v=B):(U.t="s",U.v=B);else if(B=="TRUE")U.t="b",U.v=!0;else if(B=="FALSE")U.t="b",U.v=!1;else if(!isNaN(w=yr(B)))U.t="n",U.v=w;else if(!isNaN((w=za(B)).getDate())||D&&B.match(D)){if(U.z=h.dateNF||De[14],D&&B.match(D)){var K=yh(B,h.dateNF,B.match(D)||[]);w=Gt(K),h&&h.UTC===!1&&(w=Wn(w))}else h&&h.UTC===!1?w=Wn(w):h.cellText!==!1&&h.dateNF&&(U.w=kr(U.z,w));h.cellDates?(U.t="d",U.v=w):(U.t="n",U.v=Mt(w)),h.cellNF||delete U.z}else B.charCodeAt(0)==35&&zt[B]!=null?(U.t="e",U.w=B,U.v=zt[B]):(U.t="s",U.v=B);if(U.t=="z"||(h.dense?(x["!data"][p]||(x["!data"][p]=[]),x["!data"][p][m]=U):x[Ye({c:m,r:p})]=U),_=F+1,P=f.charCodeAt(_),g.e.c<m&&(g.e.c=m),g.e.r<p&&(g.e.r=p),O==N)++m;else if(m=0,++p,h.sheetRows&&h.sheetRows<=p)return!0}e:for(;F<f.length;++F)switch(O=f.charCodeAt(F)){case 34:P===34&&(j=!j);break;case 13:if(j)break;f.charCodeAt(F+1)==10&&++F;case N:case 10:if(!j&&W())break e;break;default:break}return F-_>0&&W(),x["!ref"]=Xe(g),x}function s(f,d){return!(d&&d.PRN)||d.FS||f.slice(0,4)=="sep="||f.indexOf("	")>=0||f.indexOf(",")>=0||f.indexOf(";")>=0?i(f,d):ma(r(f,d),d)}function o(f,d){var h="",u=d.type=="string"?[0,0,0,0]:Do(f,d);switch(d.type){case"base64":h=Sr(f);break;case"binary":h=f;break;case"buffer":d.codepage==65001?h=f.toString("utf8"):d.codepage&&typeof Le<"u"?h=Le.utils.decode(d.codepage,f):h=He&&Buffer.isBuffer(f)?f.toString("binary"):on(f);break;case"array":h=Un(f);break;case"string":h=f;break;default:throw new Error("Unrecognized type "+d.type)}return u[0]==239&&u[1]==187&&u[2]==191?h=ft(h.slice(3)):d.type!="string"&&d.type!="buffer"&&d.codepage==65001?h=ft(h):d.type=="binary"&&typeof Le<"u"&&d.codepage&&(h=Le.utils.decode(d.codepage,Le.utils.encode(28591,h))),h.slice(0,19)=="socialcalc:version:"?Cp.to_sheet(d.type=="string"?h:ft(h),d):s(h,d)}function c(f,d){return Sn(o(f,d),d)}function l(f){var d=[];if(!f["!ref"])return"";for(var h=Ct(f["!ref"]),u,x=f["!data"]!=null,g=h.s.r;g<=h.e.r;++g){for(var p=[],m=h.s.c;m<=h.e.c;++m){var w=Ye({r:g,c:m});if(u=x?(f["!data"][g]||[])[m]:f[w],!u||u.v==null){p.push("          ");continue}for(var _=(u.w||(vn(u),u.w)||"").slice(0,10);_.length<10;)_+=" ";p.push(_+(m===0?" ":""))}d.push(p.join(""))}return d.join(`
`)}return{to_workbook:c,to_sheet:o,from_sheet:l}})();function Tp(e,r){var t=r||{},n=!!t.WTF;t.WTF=!0;try{var a=kp.to_workbook(e,t);return t.WTF=n,a}catch(i){if(t.WTF=n,i.message.indexOf("SYLK bad record ID")==-1&&n)throw i;return Xa.to_workbook(e,r)}}var Ma=(function(){function e(b,I,R){if(b){It(b,b.l||0);for(var A=R.Enum||ke;b.l<b.length;){var q=b.read_shift(2),C=A[q]||A[65535],ye=b.read_shift(2),ue=b.l+ye,ee=C.f&&C.f(b,ye,R);if(b.l=ue,I(ee,C,q))return}}}function r(b,I){switch(I.type){case"base64":return n(wr(Sr(b)),I);case"binary":return n(wr(b),I);case"buffer":case"array":return n(b,I)}throw"Unsupported type "+I.type}var t=["mmmm","dd-mmm-yyyy","dd-mmm","mmm-yyyy","@","mm/dd","hh:mm:ss AM/PM","hh:mm AM/PM","mm/dd/yyyy","mm/dd","hh:mm:ss","hh:mm"];function n(b,I){if(!b)return b;var R=I||{};Et!=null&&R.dense==null&&(R.dense=Et);var A={},q="Sheet1",C="",ye=0,ue={},ee=[],Ce=[],Ne=[];R.dense&&(Ne=A["!data"]=[]);var de={s:{r:0,c:0},e:{r:0,c:0}},et=R.sheetRows||0,ct={};if(b[4]==81&&b[5]==80&&b[6]==87)return be(b,I);if(b[2]==0&&(b[3]==8||b[3]==9)&&b.length>=16&&b[14]==5&&b[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(b[2]==2)R.Enum=ke,e(b,function(fe,Er,Yt){switch(Yt){case 0:R.vers=fe,fe>=4096&&(R.qpro=!0);break;case 255:R.vers=fe,R.works=!0;break;case 6:de=fe;break;case 204:fe&&(C=fe);break;case 222:C=fe;break;case 15:case 51:(!R.qpro&&!R.works||Yt==51)&&fe[1].v.charCodeAt(0)<48&&(fe[1].v=fe[1].v.slice(1)),(R.works||R.works2)&&(fe[1].v=fe[1].v.replace(/\r\n/g,`
`));case 13:case 14:case 16:(fe[2]&112)==112&&(fe[2]&15)>1&&(fe[2]&15)<15&&(fe[1].z=R.dateNF||t[(fe[2]&15)-1]||De[14],R.cellDates&&(fe[1].v=gn(fe[1].v),fe[1].t=typeof fe[1].v=="number"?"n":"d")),R.qpro&&fe[3]>ye&&(A["!ref"]=Xe(de),ue[q]=A,ee.push(q),A={},R.dense&&(Ne=A["!data"]=[]),de={s:{r:0,c:0},e:{r:0,c:0}},ye=fe[3],q=C||"Sheet"+(ye+1),C="");var bt=R.dense?(Ne[fe[0].r]||[])[fe[0].c]:A[Ye(fe[0])];if(bt){bt.t=fe[1].t,bt.v=fe[1].v,fe[1].z!=null&&(bt.z=fe[1].z),fe[1].f!=null&&(bt.f=fe[1].f),ct=bt;break}R.dense?(Ne[fe[0].r]||(Ne[fe[0].r]=[]),Ne[fe[0].r][fe[0].c]=fe[1]):A[Ye(fe[0])]=fe[1],ct=fe[1];break;case 21509:R.works2=!0;break;case 21506:fe==5281&&(ct.z="hh:mm:ss",R.cellDates&&ct.t=="n"&&(ct.v=gn(ct.v),ct.t=typeof ct.v=="number"?"n":"d"));break}},R);else if(b[2]==26||b[2]==14)R.Enum=ge,b[2]==14&&(R.qpro=!0,b.l=0),e(b,function(fe,Er,Yt){switch(Yt){case 204:q=fe;break;case 22:fe[1].v.charCodeAt(0)<48&&(fe[1].v=fe[1].v.slice(1)),fe[1].v=fe[1].v.replace(/\x0F./g,function(bt){return String.fromCharCode(bt.charCodeAt(1)-32)}).replace(/\r\n/g,`
`);case 23:case 24:case 25:case 37:case 39:case 40:if(fe[3]>ye&&(A["!ref"]=Xe(de),ue[q]=A,ee.push(q),A={},R.dense&&(Ne=A["!data"]=[]),de={s:{r:0,c:0},e:{r:0,c:0}},ye=fe[3],q="Sheet"+(ye+1)),et>0&&fe[0].r>=et)break;R.dense?(Ne[fe[0].r]||(Ne[fe[0].r]=[]),Ne[fe[0].r][fe[0].c]=fe[1]):A[Ye(fe[0])]=fe[1],de.e.c<fe[0].c&&(de.e.c=fe[0].c),de.e.r<fe[0].r&&(de.e.r=fe[0].r);break;case 27:fe[14e3]&&(Ce[fe[14e3][0]]=fe[14e3][1]);break;case 1537:Ce[fe[0]]=fe[1],fe[0]==ye&&(q=fe[1]);break;default:break}},R);else throw new Error("Unrecognized LOTUS BOF "+b[2]);if(A["!ref"]=Xe(de),ue[C||q]=A,ee.push(C||q),!Ce.length)return{SheetNames:ee,Sheets:ue};for(var _t={},$t=[],oe=0;oe<Ce.length;++oe)ue[ee[oe]]?($t.push(Ce[oe]||ee[oe]),_t[Ce[oe]]=ue[Ce[oe]]||ue[ee[oe]]):($t.push(Ce[oe]),_t[Ce[oe]]={"!ref":"A1"});return{SheetNames:$t,Sheets:_t}}function a(b,I){var R=I||{};if(+R.codepage>=0&&Hr(+R.codepage),R.type=="string")throw new Error("Cannot write WK1 to JS string");var A=qs();if(!b["!ref"])throw new Error("Cannot export empty sheet to WK1");var q=Ct(b["!ref"]),C=b["!data"]!=null,ye=[];vr(A,0,s(1030)),vr(A,6,l(q));for(var ue=Math.min(q.e.r,8191),ee=q.s.c;ee<=q.e.c;++ee)ye[ee]=qe(ee);for(var Ce=q.s.r;Ce<=ue;++Ce){var Ne=at(Ce);for(ee=q.s.c;ee<=q.e.c;++ee){var de=C?(b["!data"][Ce]||[])[ee]:b[ye[ee]+Ne];if(!(!de||de.t=="z"))switch(de.t){case"n":(de.v|0)==de.v&&de.v>=-32768&&de.v<=32767?vr(A,13,p(Ce,ee,de)):vr(A,14,w(Ce,ee,de));break;case"d":var et=Mt(de.v);(et|0)==et&&et>=-32768&&et<=32767?vr(A,13,p(Ce,ee,{t:"n",v:et,z:de.z||De[14]})):vr(A,14,w(Ce,ee,{t:"n",v:et,z:de.z||De[14]}));break;default:var ct=vn(de);vr(A,15,u(Ce,ee,ct.slice(0,239)))}}}return vr(A,1),A.end()}function i(b,I){var R=I||{};if(+R.codepage>=0&&Hr(+R.codepage),R.type=="string")throw new Error("Cannot write WK3 to JS string");var A=qs();vr(A,0,o(b));for(var q=0,C=0;q<b.SheetNames.length;++q)(b.Sheets[b.SheetNames[q]]||{})["!ref"]&&vr(A,27,J(b.SheetNames[q],C++));var ye=0;for(q=0;q<b.SheetNames.length;++q){var ue=b.Sheets[b.SheetNames[q]];if(!(!ue||!ue["!ref"])){for(var ee=Ct(ue["!ref"]),Ce=ue["!data"]!=null,Ne=[],de=Math.min(ee.e.r,8191),et=ee.s.r;et<=de;++et)for(var ct=at(et),_t=ee.s.c;_t<=ee.e.c;++_t){et===ee.s.r&&(Ne[_t]=qe(_t));var $t=Ne[_t]+ct,oe=Ce?(ue["!data"][et]||[])[_t]:ue[$t];if(!(!oe||oe.t=="z"))if(oe.t=="n")vr(A,23,K(et,_t,ye,oe.v));else{var fe=vn(oe);vr(A,22,W(et,_t,ye,fe.slice(0,239)))}}++ye}}return vr(A,1),A.end()}function s(b){var I=kt(2);return I.write_shift(2,b),I}function o(b){var I=kt(26);I.write_shift(2,4096),I.write_shift(2,4),I.write_shift(4,0);for(var R=0,A=0,q=0,C=0;C<b.SheetNames.length;++C){var ye=b.SheetNames[C],ue=b.Sheets[ye];if(!(!ue||!ue["!ref"])){++q;var ee=Hn(ue["!ref"]);R<ee.e.r&&(R=ee.e.r),A<ee.e.c&&(A=ee.e.c)}}return R>8191&&(R=8191),I.write_shift(2,R),I.write_shift(1,q),I.write_shift(1,A),I.write_shift(2,0),I.write_shift(2,0),I.write_shift(1,1),I.write_shift(1,2),I.write_shift(4,0),I.write_shift(4,0),I}function c(b,I,R){var A={s:{c:0,r:0},e:{c:0,r:0}};return I==8&&R.qpro?(A.s.c=b.read_shift(1),b.l++,A.s.r=b.read_shift(2),A.e.c=b.read_shift(1),b.l++,A.e.r=b.read_shift(2),A):(A.s.c=b.read_shift(2),A.s.r=b.read_shift(2),I==12&&R.qpro&&(b.l+=2),A.e.c=b.read_shift(2),A.e.r=b.read_shift(2),I==12&&R.qpro&&(b.l+=2),A.s.c==65535&&(A.s.c=A.e.c=A.s.r=A.e.r=0),A)}function l(b){var I=kt(8);return I.write_shift(2,b.s.c),I.write_shift(2,b.s.r),I.write_shift(2,b.e.c),I.write_shift(2,b.e.r),I}function f(b,I,R){var A=[{c:0,r:0},{t:"n",v:0},0,0];return R.qpro&&R.vers!=20768?(A[0].c=b.read_shift(1),A[3]=b.read_shift(1),A[0].r=b.read_shift(2),b.l+=2):R.works?(A[0].c=b.read_shift(2),A[0].r=b.read_shift(2),A[2]=b.read_shift(2)):(A[2]=b.read_shift(1),A[0].c=b.read_shift(2),A[0].r=b.read_shift(2)),A}function d(b){return b.z&&Xr(b.z)?240|(t.indexOf(b.z)+1||2):255}function h(b,I,R){var A=b.l+I,q=f(b,I,R);if(q[1].t="s",(R.vers&65534)==20768){b.l++;var C=b.read_shift(1);return q[1].v=b.read_shift(C,"utf8"),q}return R.qpro&&b.l++,q[1].v=b.read_shift(A-b.l,"cstr"),q}function u(b,I,R){var A=kt(7+R.length);A.write_shift(1,255),A.write_shift(2,I),A.write_shift(2,b),A.write_shift(1,39);for(var q=0;q<A.length;++q){var C=R.charCodeAt(q);A.write_shift(1,C>=128?95:C)}return A.write_shift(1,0),A}function x(b,I,R){var A=b.l+I,q=f(b,I,R);if(q[1].t="s",R.vers==20768){var C=b.read_shift(1);return q[1].v=b.read_shift(C,"utf8"),q}return q[1].v=b.read_shift(A-b.l,"cstr"),q}function g(b,I,R){var A=f(b,I,R);return A[1].v=b.read_shift(2,"i"),A}function p(b,I,R){var A=kt(7);return A.write_shift(1,d(R)),A.write_shift(2,I),A.write_shift(2,b),A.write_shift(2,R.v,"i"),A}function m(b,I,R){var A=f(b,I,R);return A[1].v=b.read_shift(8,"f"),A}function w(b,I,R){var A=kt(13);return A.write_shift(1,d(R)),A.write_shift(2,I),A.write_shift(2,b),A.write_shift(8,R.v,"f"),A}function _(b,I,R){var A=b.l+I,q=f(b,I,R);if(q[1].v=b.read_shift(8,"f"),R.qpro)b.l=A;else{var C=b.read_shift(2);O(b.slice(b.l,b.l+C),q),b.l+=C}return q}function F(b,I,R){var A=I&32768;return I&=-32769,I=(A?b:0)+(I>=8192?I-16384:I),(A?"":"$")+(R?qe(I):at(I))}var N={31:["NA",0],33:["ABS",1],34:["TRUNC",1],35:["SQRT",1],36:["LOG",1],37:["LN",1],38:["PI",0],39:["SIN",1],40:["COS",1],41:["TAN",1],42:["ATAN2",2],43:["ATAN",1],44:["ASIN",1],45:["ACOS",1],46:["EXP",1],47:["MOD",2],49:["ISNA",1],50:["ISERR",1],51:["FALSE",0],52:["TRUE",0],53:["RAND",0],54:["DATE",3],63:["ROUND",2],64:["TIME",3],68:["ISNUMBER",1],69:["ISTEXT",1],70:["LEN",1],71:["VALUE",1],73:["MID",3],74:["CHAR",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],102:["UPPER",1],103:["LOWER",1],107:["PROPER",1],109:["TRIM",1],111:["T",1]},j=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function O(b,I){It(b,0);for(var R=[],A=0,q="",C="",ye="",ue="";b.l<b.length;){var ee=b[b.l++];switch(ee){case 0:R.push(b.read_shift(8,"f"));break;case 1:C=F(I[0].c,b.read_shift(2),!0),q=F(I[0].r,b.read_shift(2),!1),R.push(C+q);break;case 2:{var Ce=F(I[0].c,b.read_shift(2),!0),Ne=F(I[0].r,b.read_shift(2),!1);C=F(I[0].c,b.read_shift(2),!0),q=F(I[0].r,b.read_shift(2),!1),R.push(Ce+Ne+":"+C+q)}break;case 3:if(b.l<b.length){console.error("WK1 premature formula end");return}break;case 4:R.push("("+R.pop()+")");break;case 5:R.push(b.read_shift(2));break;case 6:{for(var de="";ee=b[b.l++];)de+=String.fromCharCode(ee);R.push('"'+de.replace(/"/g,'""')+'"')}break;case 8:R.push("-"+R.pop());break;case 23:R.push("+"+R.pop());break;case 22:R.push("NOT("+R.pop()+")");break;case 20:case 21:ue=R.pop(),ye=R.pop(),R.push(["AND","OR"][ee-20]+"("+ye+","+ue+")");break;default:if(ee<32&&j[ee])ue=R.pop(),ye=R.pop(),R.push(ye+j[ee]+ue);else if(N[ee]){if(A=N[ee][1],A==69&&(A=b[b.l++]),A>R.length){console.error("WK1 bad formula parse 0x"+ee.toString(16)+":|"+R.join("|")+"|");return}var et=R.slice(-A);R.length-=A,R.push(N[ee][0]+"("+et.join(",")+")")}else return ee<=7?console.error("WK1 invalid opcode "+ee.toString(16)):ee<=24?console.error("WK1 unsupported op "+ee.toString(16)):ee<=30?console.error("WK1 invalid opcode "+ee.toString(16)):ee<=115?console.error("WK1 unsupported function opcode "+ee.toString(16)):console.error("WK1 unrecognized opcode "+ee.toString(16))}}R.length==1?I[1].f=""+R[0]:console.error("WK1 bad formula parse |"+R.join("|")+"|")}function P(b){var I=[{c:0,r:0},{t:"n",v:0},0];return I[0].r=b.read_shift(2),I[3]=b[b.l++],I[0].c=b[b.l++],I}function D(b,I){var R=P(b,I);return R[1].t="s",R[1].v=b.read_shift(I-4,"cstr"),R}function W(b,I,R,A){var q=kt(6+A.length);q.write_shift(2,b),q.write_shift(1,R),q.write_shift(1,I),q.write_shift(1,39);for(var C=0;C<A.length;++C){var ye=A.charCodeAt(C);q.write_shift(1,ye>=128?95:ye)}return q.write_shift(1,0),q}function B(b,I){var R=P(b,I);R[1].v=b.read_shift(2);var A=R[1].v>>1;if(R[1].v&1)switch(A&7){case 0:A=(A>>3)*5e3;break;case 1:A=(A>>3)*500;break;case 2:A=(A>>3)/20;break;case 3:A=(A>>3)/200;break;case 4:A=(A>>3)/2e3;break;case 5:A=(A>>3)/2e4;break;case 6:A=(A>>3)/16;break;case 7:A=(A>>3)/64;break}return R[1].v=A,R}function U(b,I){var R=P(b,I),A=b.read_shift(4),q=b.read_shift(4),C=b.read_shift(2);if(C==65535)return A===0&&q===3221225472?(R[1].t="e",R[1].v=15):A===0&&q===3489660928?(R[1].t="e",R[1].v=42):R[1].v=0,R;var ye=C&32768;return C=(C&32767)-16446,R[1].v=(1-ye*2)*(q*Math.pow(2,C+32)+A*Math.pow(2,C)),R}function K(b,I,R,A){var q=kt(14);if(q.write_shift(2,b),q.write_shift(1,R),q.write_shift(1,I),A==0)return q.write_shift(4,0),q.write_shift(4,0),q.write_shift(2,65535),q;var C=0,ye=0,ue=0,ee=0;return A<0&&(C=1,A=-A),ye=Math.log2(A)|0,A/=Math.pow(2,ye-31),ee=A>>>0,(ee&2147483648)==0&&(A/=2,++ye,ee=A>>>0),A-=ee,ee|=2147483648,ee>>>=0,A*=Math.pow(2,32),ue=A>>>0,q.write_shift(4,ue),q.write_shift(4,ee),ye+=16383+(C?32768:0),q.write_shift(2,ye),q}function he(b,I){var R=U(b,14);return b.l+=I-14,R}function re(b,I){var R=P(b,I),A=b.read_shift(4);return R[1].v=A>>6,R}function Ee(b,I){var R=P(b,I),A=b.read_shift(8,"f");return R[1].v=A,R}function te(b,I){var R=Ee(b,12);return b.l+=I-12,R}function ve(b,I){return b[b.l+I-1]==0?b.read_shift(I,"cstr"):""}function Te(b,I){var R=b[b.l++];R>I-1&&(R=I-1);for(var A="";A.length<R;)A+=String.fromCharCode(b[b.l++]);return A}function se(b,I,R){if(!(!R.qpro||I<21)){var A=b.read_shift(1);b.l+=17,b.l+=1,b.l+=2;var q=b.read_shift(I-21,"cstr");return[A,q]}}function Pe(b,I){for(var R={},A=b.l+I;b.l<A;){var q=b.read_shift(2);if(q==14e3){for(R[q]=[0,""],R[q][0]=b.read_shift(2);b[b.l];)R[q][1]+=String.fromCharCode(b[b.l]),b.l++;b.l++}}return R}function J(b,I){var R=kt(5+b.length);R.write_shift(2,14e3),R.write_shift(2,I);for(var A=0;A<b.length;++A){var q=b.charCodeAt(A);R[R.l++]=q>127?95:q}return R[R.l++]=0,R}var ke={0:{n:"BOF",f:wt},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:c},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:g},14:{n:"NUMBER",f:m},15:{n:"LABEL",f:h},16:{n:"FORMULA",f:_},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:x},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ve},222:{n:"SHEETNAMELP",f:Te},255:{n:"BOF",f:wt},21506:{n:"WKSNF",f:wt},65535:{n:""}},ge={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:D},23:{n:"NUMBER17",f:U},24:{n:"NUMBER18",f:B},25:{n:"FORMULA19",f:he},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Pe},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:re},38:{n:"??"},39:{n:"NUMBER27",f:Ee},40:{n:"FORMULA28",f:te},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ve},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:se},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}},Ue={5:"dd-mmm-yy",6:"dd-mmm",7:"mmm-yy",8:"mm/dd/yy",10:"hh:mm:ss AM/PM",11:"hh:mm AM/PM",14:"dd-mmm-yyyy",15:"mmm-yyyy",34:"0.00",50:"0.00;[Red]0.00",66:"0.00;(0.00)",82:"0.00;[Red](0.00)",162:'"$"#,##0.00;\\("$"#,##0.00\\)',288:"0%",304:"0E+00",320:"# ?/?"};function we(b){var I=b.read_shift(2),R=b.read_shift(1);if(R!=0)throw"unsupported QPW string type "+R.toString(16);return b.read_shift(I,"sbcs-cont")}function be(b,I){It(b,0);var R=I||{};Et!=null&&R.dense==null&&(R.dense=Et);var A={};R.dense&&(A["!data"]=[]);var q=[],C="",ye=[],ue={s:{r:-1,c:-1},e:{r:-1,c:-1}},ee=0,Ce=0,Ne=0,de=0,et={SheetNames:[],Sheets:{}},ct=[];e:for(;b.l<b.length;){var _t=b.read_shift(2),$t=b.read_shift(2),oe=b.slice(b.l,b.l+$t);switch(It(oe,0),_t){case 1:if(oe.read_shift(4)!=962023505)throw"Bad QPW9 BOF!";break;case 2:break e;case 8:break;case 10:for(var fe=oe.read_shift(4),Er=(oe.length-oe.l)/fe|0,Yt=0;Yt<fe;++Yt){var bt=oe.l+Er,ir={};oe.l+=2,ir.numFmtId=oe.read_shift(2),Ue[ir.numFmtId]&&(ir.z=Ue[ir.numFmtId]),oe.l=bt,ct.push(ir)}break;case 1025:break;case 1026:break;case 1031:for(oe.l+=12;oe.l<oe.length;)ee=oe.read_shift(2),Ce=oe.read_shift(1),q.push(oe.read_shift(ee,"cstr"));break;case 1032:break;case 1537:{var mr=oe.read_shift(2);A={},R.dense&&(A["!data"]=[]),ue.s.c=oe.read_shift(2),ue.e.c=oe.read_shift(2),ue.s.r=oe.read_shift(4),ue.e.r=oe.read_shift(4),oe.l+=4,oe.l+2<oe.length&&(ee=oe.read_shift(2),Ce=oe.read_shift(1),C=ee==0?"":oe.read_shift(ee,"cstr")),C||(C=qe(mr))}break;case 1538:{if(ue.s.c>255||ue.s.r>999999)break;ue.e.c<ue.s.c&&(ue.e.c=ue.s.c),ue.e.r<ue.s.r&&(ue.e.r=ue.s.r),A["!ref"]=Xe(ue),ei(et,A,C)}break;case 2561:Ne=oe.read_shift(2),ue.e.c<Ne&&(ue.e.c=Ne),ue.s.c>Ne&&(ue.s.c=Ne),de=oe.read_shift(4),ue.s.r>de&&(ue.s.r=de),de=oe.read_shift(4),ue.e.r<de&&(ue.e.r=de);break;case 3073:{de=oe.read_shift(4),ee=oe.read_shift(4),ue.s.r>de&&(ue.s.r=de),ue.e.r<de+ee-1&&(ue.e.r=de+ee-1);for(var Re=qe(Ne);oe.l<oe.length;){var Fe={t:"z"},lt=oe.read_shift(1),xt=-1;lt&128&&(xt=oe.read_shift(2));var ii=lt&64?oe.read_shift(2)-1:0;switch(lt&31){case 0:break;case 1:break;case 2:Fe={t:"n",v:oe.read_shift(2)};break;case 3:Fe={t:"n",v:oe.read_shift(2,"i")};break;case 4:Fe={t:"n",v:is(oe)};break;case 5:Fe={t:"n",v:oe.read_shift(8,"f")};break;case 7:Fe={t:"s",v:q[Ce=oe.read_shift(4)-1]};break;case 8:Fe={t:"n",v:oe.read_shift(8,"f")},oe.l+=2,oe.l+=4,isNaN(Fe.v)&&(Fe={t:"e",v:15});break;default:throw"Unrecognized QPW cell type "+(lt&31)}xt!=-1&&(ct[xt-1]||{}).z&&(Fe.z=ct[xt-1].z);var ln=0;if(lt&32)switch(lt&31){case 2:ln=oe.read_shift(2);break;case 3:ln=oe.read_shift(2,"i");break;case 7:ln=oe.read_shift(2);break;default:throw"Unsupported delta for QPW cell type "+(lt&31)}if(!(!R.sheetStubs&&Fe.t=="z")){var kn=Nt(Fe);Fe.t=="n"&&Fe.z&&Xr(Fe.z)&&R.cellDates&&(kn.v=gn(Fe.v),kn.t=typeof kn.v=="number"?"n":"d"),A["!data"]!=null?(A["!data"][de]||(A["!data"][de]=[]),A["!data"][de][Ne]=kn):A[Re+at(de)]=kn}for(++de,--ee;ii-- >0&&ee>=0;){if(lt&32)switch(lt&31){case 2:Fe={t:"n",v:Fe.v+ln&65535};break;case 3:Fe={t:"n",v:Fe.v+ln&65535},Fe.v>32767&&(Fe.v-=65536);break;case 7:Fe={t:"s",v:q[Ce=Ce+ln>>>0]};break;default:throw"Cannot apply delta for QPW cell type "+(lt&31)}else switch(lt&31){case 1:Fe={t:"z"};break;case 2:Fe={t:"n",v:oe.read_shift(2)};break;case 7:Fe={t:"s",v:q[Ce=oe.read_shift(4)-1]};break;default:throw"Cannot apply repeat for QPW cell type "+(lt&31)}xt!=-1,!R.sheetStubs&&Fe.t=="z"||(A["!data"]!=null?(A["!data"][de]||(A["!data"][de]=[]),A["!data"][de][Ne]=Fe):A[Re+at(de)]=Fe),++de,--ee}}}break;case 3074:{Ne=oe.read_shift(2),de=oe.read_shift(4);var _a=we(oe);A["!data"]!=null?(A["!data"][de]||(A["!data"][de]=[]),A["!data"][de][Ne]={t:"s",v:_a}):A[qe(Ne)+at(de)]={t:"s",v:_a}}break;default:break}b.l+=$t}return et}return{sheet_to_wk1:a,book_to_wk3:i,to_workbook:r}})();function bp(e){var r={},t=e.match(jt),n=0,a=!1;if(t)for(;n!=t.length;++n){var i=xe(t[n]);switch(i[0].replace(/<\w*:/g,"<")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":r.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;r.cp=ao[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":r.outline=1;break;case"</outline>":break;case"<rFont":r.name=i.val;break;case"<sz":r.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":r.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":r.uval="double";break;case"singleAccounting":r.uval="single-accounting";break;case"doubleAccounting":r.uval="double-accounting";break}case"<u>":case"<u/>":r.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":r.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":r.i=1;break;case"</i>":break;case"<color":i.rgb&&(r.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":r.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":r.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(i[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+i[0])}}return r}var Fp=(function(){function e(n){var a=Ht(n,"t");if(!a)return{t:"s",v:""};var i={t:"s",v:ze(a[1])},s=Ht(n,"rPr");return s&&(i.s=bp(s[1])),i}var r=/<(?:\w+:)?r>/g,t=/<\/(?:\w+:)?r>/;return function(a){return a.replace(r,"").split(t).map(e).filter(function(i){return i.v})}})(),Ap=(function(){var r=/(\r\n|\n)/g;function t(a,i,s){var o=[];a.u&&o.push("text-decoration: underline;"),a.uval&&o.push("text-underline-style:"+a.uval+";"),a.sz&&o.push("font-size:"+a.sz+"pt;"),a.outline&&o.push("text-effect: outline;"),a.shadow&&o.push("text-shadow: auto;"),i.push('<span style="'+o.join("")+'">'),a.b&&(i.push("<b>"),s.push("</b>")),a.i&&(i.push("<i>"),s.push("</i>")),a.strike&&(i.push("<s>"),s.push("</s>"));var c=a.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(i.push("<"+c+">"),s.push("</"+c+">")),s.push("</span>"),a}function n(a){var i=[[],a.v,[]];return a.v?(a.s&&t(a.s,i[0],i[2]),i[0].join("")+i[1].replace(r,"<br/>")+i[2].join("")):""}return function(i){return i.map(n).join("")}})(),Dp=/<(?:\w+:)?t\b[^<>]*>([^<]*)<\/(?:\w+:)?t>/g,Rp=/<(?:\w+:)?r\b[^<>]*>/;function Eo(e,r){var t=r?r.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=ze(ft(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||""),!0),n.r=ft(e),t&&(n.h=Da(n.t))):e.match(Rp)&&(n.r=ft(e),n.t=ze(ft((Lh(e,"rPh").match(Dp)||[]).join("").replace(jt,"")),!0),t&&(n.h=Ap(Fp(n.r)))),n):{t:""}}var Op=/<(?:\w+:)?(?:si|sstItem)>/g,Pp=/<\/(?:\w+:)?(?:si|sstItem)>/;function Np(e,r){var t=[],n="";if(!e)return t;var a=Ht(e,"sst");if(a){n=a[1].replace(Op,"").split(Pp);for(var i=0;i!=n.length;++i){var s=Eo(n[i].trim(),r);s!=null&&(t[t.length]=s)}a=xe(a[0].slice(0,a[0].indexOf(">"))),t.Count=a.count,t.Unique=a.uniqueCount}return t}function Ip(e){return[e.read_shift(4),e.read_shift(4)]}function Mp(e,r){var t=[],n=!1;return cn(e,function(i,s,o){switch(o){case 159:t.Count=i[0],t.Unique=i[1];break;case 19:t.push(i);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(s.T,!n||r.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),t}function Fl(e){if(typeof Le<"u")return Le.utils.encode(ua,e);for(var r=[],t=e.split(""),n=0;n<t.length;++n)r[n]=t[n].charCodeAt(0);return r}function sn(e,r){var t={};return t.Major=e.read_shift(2),t.Minor=e.read_shift(2),r>=4&&(e.l+=r-4),t}function Bp(e){var r={};return r.id=e.read_shift(0,"lpp4"),r.R=sn(e,4),r.U=sn(e,4),r.W=sn(e,4),r}function Lp(e){for(var r=e.read_shift(4),t=e.l+r-4,n={},a=e.read_shift(4),i=[];a-- >0;)i.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=i,e.l!=t)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+t);return n}function Up(e){var r=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)r.push(Lp(e));return r}function Wp(e){var r=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)r.push(e.read_shift(0,"lpp4"));return r}function Vp(e){var r={};return e.read_shift(4),e.l+=4,r.id=e.read_shift(0,"lpp4"),r.name=e.read_shift(0,"lpp4"),r.R=sn(e,4),r.U=sn(e,4),r.W=sn(e,4),r}function Hp(e){var r=Vp(e);if(r.ename=e.read_shift(0,"8lpp4"),r.blksz=e.read_shift(4),r.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return r}function Al(e,r){var t=e.l+r,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(t-e.l>>1,"utf16le"),e.l=t,n}function Dl(e,r){var t={},n=e.l+r;return e.l+=4,t.Salt=e.slice(e.l,e.l+16),e.l+=16,t.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),t.VerifierHash=e.slice(e.l,n),e.l=n,t}function zp(e){var r=sn(e);switch(r.Minor){case 2:return[r.Minor,Xp(e,r)];case 3:return[r.Minor,Gp(e,r)];case 4:return[r.Minor,jp(e,r)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+r.Minor)}function Xp(e){var r=e.read_shift(4);if((r&63)!=36)throw new Error("EncryptionInfo mismatch");var t=e.read_shift(4),n=Al(e,t),a=Dl(e,e.length-e.l);return{t:"Std",h:n,v:a}}function Gp(){throw new Error("File is password-protected: ECMA-376 Extensible")}function jp(e){var r=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var t=e.read_shift(e.length-e.l,"utf8"),n={};return t.replace(jt,function(i){var s=xe(i);switch(Nr(s[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":r.forEach(function(o){n[o]=s[o]});break;case"<dataIntegrity":n.encryptedHmacKey=s.encryptedHmacKey,n.encryptedHmacValue=s.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=s.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(s);break;default:throw s[0]}}),n}function $p(e,r){var t={},n=t.EncryptionVersionInfo=sn(e,4);if(r-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);t.Flags=e.read_shift(4),r-=4;var a=e.read_shift(4);return r-=4,t.EncryptionHeader=Al(e,a),r-=a,t.EncryptionVerifier=Dl(e,r),t}function Yp(e){var r={},t=r.EncryptionVersionInfo=sn(e,4);if(t.Major!=1||t.Minor!=1)throw"unrecognized version code "+t.Major+" : "+t.Minor;return r.Salt=e.read_shift(16),r.EncryptedVerifier=e.read_shift(16),r.EncryptedVerifierHash=e.read_shift(16),r}function Kp(e){var r=0,t,n=Fl(e),a=n.length+1,i,s,o,c,l;for(t=_n(a),t[0]=n.length,i=1;i!=a;++i)t[i]=n[i-1];for(i=a-1;i>=0;--i)s=t[i],o=(r&16384)===0?0:1,c=r<<1&32767,l=o|c,r=l^s;return r^52811}var Rl=(function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],r=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],t=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(s){return(s/2|s*128)&255},a=function(s,o){return n(s^o)},i=function(s){for(var o=r[s.length-1],c=104,l=s.length-1;l>=0;--l)for(var f=s[l],d=0;d!=7;++d)f&64&&(o^=t[c]),f*=2,--c;return o};return function(s){for(var o=Fl(s),c=i(o),l=o.length,f=_n(16),d=0;d!=16;++d)f[d]=0;var h,u,x;for((l&1)===1&&(h=c>>8,f[l]=a(e[0],h),--l,h=c&255,u=o[o.length-1],f[l]=a(u,h));l>0;)--l,h=c>>8,f[l]=a(o[l],h),--l,h=c&255,f[l]=a(o[l],h);for(l=15,x=15-o.length;x>0;)h=c>>8,f[l]=a(e[x],h),--l,--x,h=c&255,f[l]=a(o[l],h),--l,--x;return f}})(),Zp=function(e,r,t,n,a){a||(a=r),n||(n=Rl(e));var i,s;for(i=0;i!=r.length;++i)s=r[i],s^=n[t],s=(s>>5|s<<3)&255,a[i]=s,++t;return[a,t,n]},qp=function(e){var r=0,t=Rl(e);return function(n){var a=Zp("",n,r,t);return r=a[1],a[0]}};function Jp(e,r,t,n){var a={key:wt(e),verificationBytes:wt(e)};return t.password&&(a.verifier=Kp(t.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=qp(t.password)),a}function Qp(e,r,t){var n=t||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=Yp(e,r):n.Data=$p(e,r),n}function em(e,r,t){var n={Type:t.biff>=8?e.read_shift(2):0};return n.Type?Qp(e,r-2,n):Jp(e,t.biff>=8?r:r-2,t,n),n}function tm(e,r){switch(r.type){case"base64":return Ui(Sr(e),r);case"binary":return Ui(e,r);case"buffer":return Ui(He&&Buffer.isBuffer(e)?e.toString("binary"):on(e),r);case"array":return Ui(Un(e),r)}throw new Error("Unrecognized type "+r.type)}function Ui(e,r){var t=r||{},n={},a=t.dense;a&&(n["!data"]=[]);var i=uo(e,"\\trowd","\\row");if(!i)throw new Error("RTF missing table");var s={s:{c:0,r:0},e:{c:0,r:i.length-1}},o=[];return i.forEach(function(c,l){a&&(o=n["!data"][l]=[]);for(var f=/\\[\w\-]+\b/g,d=0,h,u=-1,x=[];(h=f.exec(c))!=null;){var g=c.slice(d,f.lastIndex-h[0].length);switch(g.charCodeAt(0)==32&&(g=g.slice(1)),g.length&&x.push(g),h[0]){case"\\cell":if(++u,x.length){var p={v:x.join(""),t:"s"};p.v=="TRUE"||p.v=="FALSE"?(p.v=p.v=="TRUE",p.t="b"):isNaN(yr(p.v))?zt[p.v]!=null&&(p.t="e",p.w=p.v,p.v=zt[p.v]):(p.t="n",t.cellText!==!1&&(p.w=p.v),p.v=yr(p.v)),a?o[u]=p:n[Ye({r:l,c:u})]=p}x=[];break;case"\\par":x.push(`
`);break}d=f.lastIndex}u>s.e.c&&(s.e.c=u)}),n["!ref"]=Xe(s),n}function rm(e,r){var t=Sn(tm(e,r),r);return t.bookType="rtf",t}function nm(e){var r=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(r.slice(0,2),16),parseInt(r.slice(2,4),16),parseInt(r.slice(4,6),16)]}function Ga(e){for(var r=0,t=1;r!=3;++r)t=t*256+(e[r]>255?255:e[r]<0?0:e[r]);return t.toString(16).toUpperCase().slice(1)}function am(e){var r=e[0]/255,t=e[1]/255,n=e[2]/255,a=Math.max(r,t,n),i=Math.min(r,t,n),s=a-i;if(s===0)return[0,0,r];var o=0,c=0,l=a+i;switch(c=s/(l>1?2-l:l),a){case r:o=((t-n)/s+6)%6;break;case t:o=(n-r)/s+2;break;case n:o=(r-t)/s+4;break}return[o/6,c,l/2]}function im(e){var r=e[0],t=e[1],n=e[2],a=t*2*(n<.5?n:1-n),i=n-a/2,s=[i,i,i],o=6*r,c;if(t!==0)switch(o|0){case 0:case 6:c=a*o,s[0]+=a,s[1]+=c;break;case 1:c=a*(2-o),s[0]+=c,s[1]+=a;break;case 2:c=a*(o-2),s[1]+=a,s[2]+=c;break;case 3:c=a*(4-o),s[1]+=c,s[2]+=a;break;case 4:c=a*(o-4),s[2]+=a,s[0]+=c;break;case 5:c=a*(6-o),s[2]+=c,s[0]+=a;break}for(var l=0;l!=3;++l)s[l]=Math.round(s[l]*255);return s}function Zi(e,r){if(r===0)return e;var t=am(nm(e));return r<0?t[2]=t[2]*(1+r):t[2]=1-(1-t[2])*(1-r),Ga(im(t))}var Ol=6,sm=15,om=1,or=Ol;function qi(e){return Math.floor((e+Math.round(128/or)/256)*or)}function Ji(e){return Math.floor((e-5)/or*100+.5)/100}function eo(e){return Math.round((e*or+5)/or*256)/256}function zs(e){return eo(Ji(qi(e)))}function Co(e){var r=Math.abs(e-zs(e)),t=or;if(r>.005)for(or=om;or<sm;++or)Math.abs(e-zs(e))<=r&&(r=Math.abs(e-zs(e)),t=or);or=t}function da(e){e.width?(e.wpx=qi(e.width),e.wch=Ji(e.wpx),e.MDW=or):e.wpx?(e.wch=Ji(e.wpx),e.width=eo(e.wch),e.MDW=or):typeof e.wch=="number"&&(e.width=eo(e.wch),e.wpx=qi(e.width),e.MDW=or),e.customWidth&&delete e.customWidth}var cm=96,Pl=cm;function Nl(e){return e*96/Pl}function ja(e){return e*Pl/96}var lm={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function fm(e,r,t,n){r.Borders=[];var a={},i=!1;(e.match(jt)||[]).forEach(function(s){var o=xe(s);switch(Nr(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},o.diagonalUp&&(a.diagonalUp=nt(o.diagonalUp)),o.diagonalDown&&(a.diagonalDown=nt(o.diagonalDown)),r.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in borders")}})}function um(e,r,t,n){r.Fills=[];var a={},i=!1;(e.match(jt)||[]).forEach(function(s){var o=xe(s);switch(Nr(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},r.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":r.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":o.patternType&&(a.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),o.indexed&&(a.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(a.bgColor.theme=parseInt(o.theme,10)),o.tint&&(a.bgColor.tint=parseFloat(o.tint)),o.rgb&&(a.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),o.theme&&(a.fgColor.theme=parseInt(o.theme,10)),o.tint&&(a.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(a.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in fills")}})}function hm(e,r,t,n){r.Fonts=[];var a={},i=!1;(e.match(jt)||[]).forEach(function(s){var o=xe(s);switch(Nr(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":r.Fonts.push(a),a={};break;case"<name":o.val&&(a.name=ft(o.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=o.val?nt(o.val):1;break;case"<b/>":a.bold=1;break;case"</b>":case"</b":break;case"<i":a.italic=o.val?nt(o.val):1;break;case"<i/>":a.italic=1;break;case"</i>":case"</i":break;case"<u":switch(o.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"</u>":case"</u":break;case"<strike":a.strike=o.val?nt(o.val):1;break;case"<strike/>":a.strike=1;break;case"</strike>":case"</strike":break;case"<outline":a.outline=o.val?nt(o.val):1;break;case"<outline/>":a.outline=1;break;case"</outline>":case"</outline":break;case"<shadow":a.shadow=o.val?nt(o.val):1;break;case"<shadow/>":a.shadow=1;break;case"</shadow>":case"</shadow":break;case"<condense":a.condense=o.val?nt(o.val):1;break;case"<condense/>":a.condense=1;break;case"</condense>":case"</condense":break;case"<extend":a.extend=o.val?nt(o.val):1;break;case"<extend/>":a.extend=1;break;case"</extend>":case"</extend":break;case"<sz":o.val&&(a.sz=+o.val);break;case"<sz/>":case"</sz>":case"</sz":break;case"<vertAlign":o.val&&(a.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":case"</vertAlign":break;case"<family":o.val&&(a.family=parseInt(o.val,10));break;case"<family/>":case"</family>":case"</family":break;case"<scheme":o.val&&(a.scheme=o.val);break;case"<scheme/>":case"</scheme>":case"</scheme":break;case"<charset":if(o.val=="1")break;o.codepage=ao[parseInt(o.val,10)];break;case"<charset/>":case"</charset>":case"</charset":break;case"<color":if(a.color||(a.color={}),o.auto&&(a.color.auto=nt(o.auto)),o.rgb)a.color.rgb=o.rgb.slice(-6);else if(o.indexed){a.color.index=parseInt(o.indexed,10);var c=In[a.color.index];a.color.index==81&&(c=In[1]),c||(c=In[1]),a.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else o.theme&&(a.color.theme=parseInt(o.theme,10),o.tint&&(a.color.tint=parseFloat(o.tint)),o.theme&&t.themeElements&&t.themeElements.clrScheme&&(a.color.rgb=Zi(t.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":case"</color":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":case"</AlternateContent":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in fonts")}})}function dm(e,r,t){r.NumberFmt=[];for(var n=Pr(De),a=0;a<n.length;++a)r.NumberFmt[n[a]]=De[n[a]];var i=e.match(jt);if(i)for(a=0;a<i.length;++a){var s=xe(i[a]);switch(Nr(s[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=ze(ft(s.formatCode)),c=parseInt(s.numFmtId,10);if(r.NumberFmt[c]=o,c>0){if(c>392){for(c=392;c>60&&r.NumberFmt[c]!=null;--c);r.NumberFmt[c]=o}Pn(o,c)}}break;case"</numFmt>":break;default:if(t.WTF)throw new Error("unrecognized "+s[0]+" in numFmts")}}}var Wi=["numFmtId","fillId","fontId","borderId","xfId"],Vi=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function pm(e,r,t){r.CellXf=[];var n,a=!1;(e.match(jt)||[]).forEach(function(i){var s=xe(i),o=0;switch(Nr(s[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":case"<xf>":for(n=s,delete n[0],o=0;o<Wi.length;++o)n[Wi[o]]&&(n[Wi[o]]=parseInt(n[Wi[o]],10));for(o=0;o<Vi.length;++o)n[Vi[o]]&&(n[Vi[o]]=nt(n[Vi[o]]));if(r.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(r.NumberFmt[n.numFmtId]==r.NumberFmt[o]){n.numFmtId=o;break}}r.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":case"<alignment>":var c={};s.vertical&&(c.vertical=s.vertical),s.horizontal&&(c.horizontal=s.horizontal),s.textRotation!=null&&(c.textRotation=s.textRotation),s.indent&&(c.indent=s.indent),s.wrapText&&(c.wrapText=nt(s.wrapText)),n.alignment=c;break;case"</alignment>":break;case"<protection":case"<protection>":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":case"<AlternateContent>":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(t&&t.WTF&&!a)throw new Error("unrecognized "+s[0]+" in cellXfs")}})}var mm=(function(){return function(t,n,a){var i={};if(!t)return i;t=fo(Ka(t,"<!--","-->"));var s;return(s=Ht(t,"numFmts"))&&dm(s[0],i,a),(s=Ht(t,"fonts"))&&hm(s[0],i,n,a),(s=Ht(t,"fills"))&&um(s[0],i,n,a),(s=Ht(t,"borders"))&&fm(s[0],i,n,a),(s=Ht(t,"cellXfs"))&&pm(s[0],i,a),i}})();function xm(e,r){var t=e.read_shift(2),n=nr(e,r-2);return[t,n]}function gm(e,r,t){var n={};n.sz=e.read_shift(2)/20;var a=Ed(e,2,t);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var i=e.read_shift(2);switch(i===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var s=e.read_shift(1);s!=0&&(n.underline=s);var o=e.read_shift(1);o>0&&(n.family=o);var c=e.read_shift(1);switch(c>0&&(n.charset=c),e.l++,n.color=kd(e,8),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=nr(e,r-21),n}var _m=ar;function vm(e,r){var t=e.l+r,n=e.read_shift(2),a=e.read_shift(2);return e.l=t,{ixfe:n,numFmtId:a}}var wm=ar;function ym(e,r,t){var n={};n.NumberFmt=[];for(var a in De)n.NumberFmt[a]=De[a];n.CellXf=[],n.Fonts=[];var i=[],s=!1;return cn(e,function(c,l,f){switch(f){case 44:n.NumberFmt[c[0]]=c[1],Pn(c[1],c[0]);break;case 43:n.Fonts.push(c),c.color.theme!=null&&r&&r.themeElements&&r.themeElements.clrScheme&&(c.color.rgb=Zi(r.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&n.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:i.push(f),s=!0;break;case 38:i.pop(),s=!1;break;default:if(l.T>0)i.push(f);else if(l.T<0)i.pop();else if(!s||t.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+f.toString(16))}}),n}var Sm=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function km(e,r,t){r.themeElements.clrScheme=[];var n={};(e[0].match(jt)||[]).forEach(function(a){var i=xe(a);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=i.val;break;case"</a:srgbClr>":break;case"<a:sysClr":n.rgb=i.lastClr;break;case"</a:sysClr>":break;case"</a:dk1>":case"</a:lt1>":case"<a:dk1>":case"<a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(r.themeElements.clrScheme[Sm.indexOf(i[0])]=n,n={}):n.name=i[0].slice(3,i[0].length-1);break;default:if(t&&t.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function Em(e,r,t){r.themeElements={};var n;if(!(n=Nn(e,"a:clrScheme")))throw new Error("clrScheme not found in themeElements");if(km(n,r,t),!(n=Nn(e,"a:fontScheme")))throw new Error("fontScheme not found in themeElements");if(!(n=Nn(e,"a:fmtScheme")))throw new Error("fmtScheme not found in themeElements");}function Il(e,r){(!e||e.length===0)&&(e=Cm());var t,n={};if(!(t=Nn(e,"a:themeElements")))throw new Error("themeElements not found in theme");return Em(t[0],n,r),n.raw=e,n}function Cm(e,r){if(r&&r.themeXLSX)return r.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var t=[qc];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="\uFF2D\uFF33 \uFF30\u30B4\u30B7\u30C3\u30AF"/>',t[t.length]='<a:font script="Hang" typeface="\uB9D1\uC740 \uACE0\uB515"/>',t[t.length]='<a:font script="Hans" typeface="\u5B8B\u4F53"/>',t[t.length]='<a:font script="Hant" typeface="\u65B0\u7D30\u660E\u9AD4"/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="\uFF2D\uFF33 \uFF30\u30B4\u30B7\u30C3\u30AF"/>',t[t.length]='<a:font script="Hang" typeface="\uB9D1\uC740 \uACE0\uB515"/>',t[t.length]='<a:font script="Hans" typeface="\u5B8B\u4F53"/>',t[t.length]='<a:font script="Hant" typeface="\u65B0\u7D30\u660E\u9AD4"/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function Tm(e,r,t){var n=e.l+r,a=e.read_shift(4);if(a!==124226){if(!t.cellStyles){e.l=n;return}var i=e.slice(e.l);e.l=n;var s;try{s=Zc(i,{type:"array"})}catch{return}var o=cr(s,"theme/theme/theme1.xml",!0);if(o)return Il(o,t)}}function bm(e){return e.read_shift(4)}function Fm(e){var r={};switch(r.xclrType=e.read_shift(2),r.nTintShade=e.read_shift(2),r.xclrType){case 0:e.l+=4;break;case 1:r.xclrValue=Am(e,4);break;case 2:r.xclrValue=yl(e,4);break;case 3:r.xclrValue=bm(e,4);break;case 4:e.l+=4;break}return e.l+=8,r}function Am(e,r){return ar(e,r)}function Dm(e,r){return ar(e,r)}function Rm(e){var r=e.read_shift(2),t=e.read_shift(2)-4,n=[r];switch(r){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=Fm(e,t);break;case 6:n[1]=Dm(e,t);break;case 14:case 15:n[1]=e.read_shift(t===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+r+" "+t)}return n}function Om(e,r){var t=e.l+r;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var a=e.read_shift(2),i=[];a-- >0;)i.push(Rm(e,t-e.l));return{ixfe:n,ext:i}}function Pm(e,r){r.forEach(function(t){switch(t[0]){case 4:break;case 5:break;case 6:break;case 7:break;case 8:break;case 9:break;case 10:break;case 11:break;case 13:break;case 14:break;case 15:break}})}function Nm(e,r){return{flags:e.read_shift(4),version:e.read_shift(4),name:nr(e,r-8)}}function Im(e){for(var r=[],t=e.read_shift(4);t-- >0;)r.push([e.read_shift(4),e.read_shift(4)]);return r}function Mm(e){return e.l+=4,e.read_shift(4)!=0}function Bm(e,r,t){var n={Types:[],Cell:[],Value:[]},a=t||{},i=[],s=!1,o=2;return cn(e,function(c,l,f){switch(f){case 335:n.Types.push({name:c.name});break;case 51:c.forEach(function(d){o==1?n.Cell.push({type:n.Types[d[0]-1].name,index:d[1]}):o==0&&n.Value.push({type:n.Types[d[0]-1].name,index:d[1]})});break;case 337:o=c?1:0;break;case 338:o=2;break;case 35:i.push(f),s=!0;break;case 36:i.pop(),s=!1;break;default:if(!l.T){if(!s||a.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}}),n}function Lm(e,r,t){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var a=!1,i=2,s;return e.replace(jt,function(o){var c=xe(o);switch(Nr(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var l=0;l<n.Types.length;++l)n.Types[l].name==c.name&&(s=n.Types[l]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?n.Cell.push({type:n.Types[c.t-1].name,index:+c.v}):i==0&&n.Value.push({type:n.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!s)break;s.offsets||(s.offsets=[]),s.offsets.push(+c.i);break;default:if(!a&&t?.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return o}),n}function Um(e){var r=[];if(!e)return r;var t=1;return(e.match(jt)||[]).forEach(function(n){var a=xe(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?t=a.i:a.i=t,r.push(a);break}}),r}function Wm(e){var r={};r.i=e.read_shift(4);var t={};t.r=e.read_shift(4),t.c=e.read_shift(4),r.r=Ye(t);var n=e.read_shift(1);return n&2&&(r.l="1"),n&8&&(r.a="1"),r}function Vm(e,r,t){var n=[],a=!1;return cn(e,function(s,o,c){switch(c){case 63:n.push(s);break;default:if(!o.T){if(!a||t.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}),n}function Hm(e,r,t,n){if(!e)return e;var a=n||{},i=!1,s=!1;cn(e,function(c,l,f){if(!s)switch(f){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!l.T){if(!i||a.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}},a)}function zm(e,r){if(!e)return"??";var t=(e.match(/<c:chart [^<>]*r:id="([^<>"]*)"/)||["",""])[1];return r["!id"][t].Target}function Xm(e,r,t){var n=0;(jc(e,"shape")||[]).forEach(function(a){var i="",s=!0,o=-1,c=-1,l=-1;switch(a.replace(jt,function(d,h){var u=xe(d);switch(Nr(u[0])){case"<ClientData":u.ObjectType&&(i=u.ObjectType);break;case"<Visible":case"<Visible/>":s=!1;break;case"<Row":case"<Row>":o=h+d.length;break;case"</Row>":c=+a.slice(o,h).trim();break;case"<Column":case"<Column>":o=h+d.length;break;case"</Column>":l=+a.slice(o,h).trim();break}return""}),i){case"Note":var f=Ya(r,c>=0&&l>=0?Ye({r:c,c:l}):t[n].ref);f.c&&(f.c.hidden=s),++n;break}})}function xc(e,r,t,n){var a=e["!data"]!=null,i;r.forEach(function(s){var o=rr(s.ref);if(!(o.r<0||o.c<0)){if(a?(e["!data"][o.r]||(e["!data"][o.r]=[]),i=e["!data"][o.r][o.c]):i=e[s.ref],!i){i={t:"z"},a?e["!data"][o.r][o.c]=i:e[s.ref]=i;var c=Ct(e["!ref"]||"BDWGO1000001:A1");c.s.r>o.r&&(c.s.r=o.r),c.e.r<o.r&&(c.e.r=o.r),c.s.c>o.c&&(c.s.c=o.c),c.e.c<o.c&&(c.e.c=o.c);var l=Xe(c);e["!ref"]=l}i.c||(i.c=[]);var f={a:s.author,t:s.t,r:s.r,T:t};s.h&&(f.h=s.h);for(var d=i.c.length-1;d>=0;--d){if(!t&&i.c[d].T)return;t&&!i.c[d].T&&i.c.splice(d,1)}if(t&&n){for(d=0;d<n.length;++d)if(f.a==n[d].id){f.a=n[d].name||f.a;break}}i.c.push(f)}})}function Gm(e,r){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var t=[],n=[],a=Ht(e,"authors");a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(s){if(!(s===""||s.trim()==="")){var o=s.match(/<(?:\w+:)?author[^<>]*>(.*)/);o&&t.push(o[1])}});var i=Ht(e,"commentList");return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(s){if(!(s===""||s.trim()==="")){var o=s.match(/<(?:\w+:)?comment[^<>]*>/);if(o){var c=xe(o[0]),l={author:c.authorId&&t[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},f=rr(c.ref);if(!(r.sheetRows&&r.sheetRows<=f.r)){var d=Ht(s,"text"),h=!!d&&!!d[1]&&Eo(d[1])||{r:"",t:"",h:""};l.r=h.r,h.r=="<t></t>"&&(h.t=h.h=""),l.t=(h.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),r.cellHTML&&(l.h=h.h),n.push(l)}}}}),n}function jm(e,r){var t=[],n=!1,a={},i=0;return e.replace(jt,function(o,c){var l=xe(o);switch(Nr(l[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:l.personId,guid:l.id,ref:l.ref,T:1};break;case"</threadedComment>":a.t!=null&&t.push(a);break;case"<text>":case"<text":i=c+o.length;break;case"</text>":a.t=e.slice(i,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&r.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return o}),t}function $m(e,r){var t=[],n=!1;return e.replace(jt,function(i){var s=xe(i);switch(Nr(s[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":t.push({name:s.displayname,id:s.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&r.WTF)throw new Error("unrecognized "+s[0]+" in threaded comments")}return i}),t}function Ym(e){var r={};r.iauthor=e.read_shift(4);var t=Xn(e,16);return r.rfx=t.s,r.ref=Ye(t.s),e.l+=16,r}var Km=nr;function Zm(e,r){var t=[],n=[],a={},i=!1;return cn(e,function(o,c,l){switch(l){case 632:n.push(o);break;case 635:a=o;break;case 637:a.t=o.t,a.h=o.h,a.r=o.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,r.sheetRows&&a.rfx&&r.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,t.push(a);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!i||r.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}}),t}var qm="application/vnd.ms-office.vbaProject";function Jm(e){var r=je.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(t,n){if(!(t.slice(-1)==="/"||!t.match(/_VBA_PROJECT_CUR/))){var a=t.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");je.utils.cfb_add(r,a,e.FileIndex[n].content)}}),je.write(r)}function Qm(){return{"!type":"dialog"}}function ex(){return{"!type":"dialog"}}function tx(){return{"!type":"macro"}}function rx(){return{"!type":"macro"}}var Mn=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,r={r:0,c:0};function t(n,a,i,s){var o=!1,c=!1;i.length==0?c=!0:i.charAt(0)=="["&&(c=!0,i=i.slice(1,-1)),s.length==0?o=!0:s.charAt(0)=="["&&(o=!0,s=s.slice(1,-1));var l=i.length>0?parseInt(i,10)|0:0,f=s.length>0?parseInt(s,10)|0:0;return o?f+=r.c:--f,c?l+=r.r:--l,a+(o?"":"$")+qe(f)+(c?"":"$")+at(l)}return function(a,i){return r=i,a.replace(e,t)}})(),To=/(^|[^._A-Z0-9])(\$?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])(\$?)(\d{1,7})(?![_.\(A-Za-z0-9])/g;try{To=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g}catch{}var nx=(function(){return function(r,t){return r.replace(To,function(n,a,i,s,o,c){var l=wo(s)-(i?0:t.c),f=vo(c)-(o?0:t.r),d=o=="$"?f+1:f==0?"":"["+f+"]",h=i=="$"?l+1:l==0?"":"["+l+"]";return a+"R"+d+"C"+h})}})();function Ml(e,r){return e.replace(To,function(t,n,a,i,s,o){return n+(a=="$"?a+i:qe(wo(i)+r.c))+(s=="$"?s+o:at(vo(o)+r.r))})}function gc(e,r,t){var n=Hn(r),a=n.s,i=rr(t),s={r:i.r-a.r,c:i.c-a.c};return Ml(e,s)}function ax(e){return e.length!=1}function _c(e){return e.replace(/_xlfn\./g,"")}function Rt(e){e.l+=1}function wn(e,r){var t=e.read_shift(r==1?1:2);return[t&16383,t>>14&1,t>>15&1]}function Bl(e,r,t){var n=2;if(t){if(t.biff>=2&&t.biff<=5)return Ll(e,r,t);t.biff==12&&(n=4)}var a=e.read_shift(n),i=e.read_shift(n),s=wn(e,2),o=wn(e,2);return{s:{r:a,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function Ll(e){var r=wn(e,2),t=wn(e,2),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:r[0],c:n,cRel:r[1],rRel:r[2]},e:{r:t[0],c:a,cRel:t[1],rRel:t[2]}}}function ix(e,r,t){if(t.biff<8)return Ll(e,r,t);var n=e.read_shift(t.biff==12?4:2),a=e.read_shift(t.biff==12?4:2),i=wn(e,2),s=wn(e,2);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:s[0],cRel:s[1],rRel:s[2]}}}function Ul(e,r,t){if(t&&t.biff>=2&&t.biff<=5)return sx(e,r,t);var n=e.read_shift(t&&t.biff==12?4:2),a=wn(e,2);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function sx(e){var r=wn(e,2),t=e.read_shift(1);return{r:r[0],c:t,cRel:r[1],rRel:r[2]}}function ox(e){var r=e.read_shift(2),t=e.read_shift(2);return{r,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function cx(e,r,t){var n=t&&t.biff?t.biff:8;if(n>=2&&n<=5)return lx(e,r,t);var a=e.read_shift(n>=12?4:2),i=e.read_shift(2),s=(i&16384)>>14,o=(i&32768)>>15;if(i&=16383,o==1)for(;a>524287;)a-=1048576;if(s==1)for(;i>8191;)i=i-16384;return{r:a,c:i,cRel:s,rRel:o}}function lx(e){var r=e.read_shift(2),t=e.read_shift(1),n=(r&32768)>>15,a=(r&16384)>>14;return r&=16383,n==1&&r>=8192&&(r=r-16384),a==1&&t>=128&&(t=t-256),{r,c:t,cRel:a,rRel:n}}function fx(e,r,t){var n=(e[e.l++]&96)>>5,a=Bl(e,t.biff>=2&&t.biff<=5?6:8,t);return[n,a]}function ux(e,r,t){var n=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),i=8;if(t)switch(t.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}var s=Bl(e,i,t);return[n,a,s]}function hx(e,r,t){var n=(e[e.l++]&96)>>5;return e.l+=t&&t.biff>8?12:t.biff<8?6:8,[n]}function dx(e,r,t){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),i=8;if(t)switch(t.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}return e.l+=i,[n,a]}function px(e,r,t){var n=(e[e.l++]&96)>>5,a=ix(e,r-1,t);return[n,a]}function mx(e,r,t){var n=(e[e.l++]&96)>>5;return e.l+=t.biff==2?6:t.biff==12?14:7,[n]}function vc(e){var r=e[e.l+1]&1,t=1;return e.l+=4,[r,t]}function xx(e,r,t){e.l+=2;for(var n=e.read_shift(t&&t.biff==2?1:2),a=[],i=0;i<=n;++i)a.push(e.read_shift(t&&t.biff==2?1:2));return a}function gx(e,r,t){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(t&&t.biff==2?1:2)]}function _x(e,r,t){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(t&&t.biff==2?1:2)]}function vx(e){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(2)]}function wx(e,r,t){var n=e[e.l+1]&255?1:0;return e.l+=t&&t.biff==2?3:4,[n]}function Wl(e){var r=e.read_shift(1),t=e.read_shift(1);return[r,t]}function yx(e){return e.read_shift(2),Wl(e,2)}function Sx(e){return e.read_shift(2),Wl(e,2)}function kx(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var a=Ul(e,0,t);return[n,a]}function Ex(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var a=cx(e,0,t);return[n,a]}function Cx(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);t&&t.biff==5&&(e.l+=12);var i=Ul(e,0,t);return[n,a,i]}function Tx(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(t&&t.biff<=3?1:2);return[bg[a],zl[a],n]}function bx(e,r,t){var n=e[e.l++],a=e.read_shift(1),i=t&&t.biff<=3?[n==88?-1:0,e.read_shift(1)]:Fx(e);return[a,(i[0]===0?zl:Tg)[i[1]]]}function Fx(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function Ax(e,r,t){e.l+=t&&t.biff==2?3:4}function Dx(e,r,t){if(e.l++,t&&t.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),a=e.read_shift(t&&t.biff==2?1:2);return[n,a]}function Rx(e){return e.l++,pr[e.read_shift(1)]}function Ox(e){return e.l++,e.read_shift(2)}function Px(e){return e.l++,e.read_shift(1)!==0}function Nx(e){return e.l++,tr(e,8)}function Ix(e,r,t){return e.l++,ha(e,r-1,t)}function Mx(e,r){var t=[e.read_shift(1)];if(r==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=St(e,1)?"TRUE":"FALSE",r!=12&&(e.l+=7);break;case 37:case 16:t[1]=pr[e[e.l]],e.l+=r==12?4:8;break;case 0:e.l+=8;break;case 1:t[1]=tr(e,8);break;case 2:t[1]=Gn(e,0,{biff:r>0&&r<8?2:r});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function Bx(e,r,t){for(var n=e.read_shift(t.biff==12?4:2),a=[],i=0;i!=n;++i)a.push((t.biff==12?Xn:ss)(e,8));return a}function Lx(e,r,t){var n=0,a=0;t.biff==12?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),t.biff>=2&&t.biff<8&&(--n,--a==0&&(a=256));for(var i=0,s=[];i!=n&&(s[i]=[]);++i)for(var o=0;o!=a;++o)s[i][o]=Mx(e,t.biff);return s}function Ux(e,r,t){var n=e.read_shift(1)>>>5&3,a=!t||t.biff>=8?4:2,i=e.read_shift(a);switch(t.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,i]}function Wx(e,r,t){if(t.biff==5)return Vx(e,r,t);var n=e.read_shift(1)>>>5&3,a=e.read_shift(2),i=e.read_shift(4);return[n,a,i]}function Vx(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[r,t,n]}function Hx(e,r,t){var n=e.read_shift(1)>>>5&3;e.l+=t&&t.biff==2?3:4;var a=e.read_shift(t&&t.biff==2?1:2);return[n,a]}function zx(e,r,t){var n=e.read_shift(1)>>>5&3,a=e.read_shift(t&&t.biff==2?1:2);return[n,a]}function Xx(e,r,t){var n=e.read_shift(1)>>>5&3;return e.l+=4,t.biff<8&&e.l--,t.biff==12&&(e.l+=2),[n]}function Gx(e,r,t){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),i=4;if(t)switch(t.biff){case 5:i=15;break;case 12:i=6;break}return e.l+=i,[n,a]}var jx=ar,$x=ar,Yx=ar;function qa(e,r,t){return e.l+=2,[ox(e,4,t)]}function bo(e){return e.l+=6,[]}var Kx=qa,Zx=bo,qx=bo,Jx=qa;function Vl(e){return e.l+=2,[wt(e),e.read_shift(2)&1]}var Qx=qa,eg=Vl,tg=bo,rg=qa,ng=qa,ag=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function ig(e){e.l+=2;var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),i=e.read_shift(2),s=ag[t>>2&31];return{ixti:r,coltype:t&3,rt:s,idx:n,c:a,C:i}}function sg(e){return e.l+=2,[e.read_shift(4)]}function og(e,r,t){return e.l+=5,e.l+=2,e.l+=t.biff==2?1:4,["PTGSHEET"]}function cg(e,r,t){return e.l+=t.biff==2?4:5,["PTGENDSHEET"]}function lg(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[r,t]}function fg(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[r,t]}function ug(e){return e.l+=4,[0,0]}var wc={1:{n:"PtgExp",f:Dx},2:{n:"PtgTbl",f:Yx},3:{n:"PtgAdd",f:Rt},4:{n:"PtgSub",f:Rt},5:{n:"PtgMul",f:Rt},6:{n:"PtgDiv",f:Rt},7:{n:"PtgPower",f:Rt},8:{n:"PtgConcat",f:Rt},9:{n:"PtgLt",f:Rt},10:{n:"PtgLe",f:Rt},11:{n:"PtgEq",f:Rt},12:{n:"PtgGe",f:Rt},13:{n:"PtgGt",f:Rt},14:{n:"PtgNe",f:Rt},15:{n:"PtgIsect",f:Rt},16:{n:"PtgUnion",f:Rt},17:{n:"PtgRange",f:Rt},18:{n:"PtgUplus",f:Rt},19:{n:"PtgUminus",f:Rt},20:{n:"PtgPercent",f:Rt},21:{n:"PtgParen",f:Rt},22:{n:"PtgMissArg",f:Rt},23:{n:"PtgStr",f:Ix},26:{n:"PtgSheet",f:og},27:{n:"PtgEndSheet",f:cg},28:{n:"PtgErr",f:Rx},29:{n:"PtgBool",f:Px},30:{n:"PtgInt",f:Ox},31:{n:"PtgNum",f:Nx},32:{n:"PtgArray",f:mx},33:{n:"PtgFunc",f:Tx},34:{n:"PtgFuncVar",f:bx},35:{n:"PtgName",f:Ux},36:{n:"PtgRef",f:kx},37:{n:"PtgArea",f:fx},38:{n:"PtgMemArea",f:Hx},39:{n:"PtgMemErr",f:jx},40:{n:"PtgMemNoMem",f:$x},41:{n:"PtgMemFunc",f:zx},42:{n:"PtgRefErr",f:Xx},43:{n:"PtgAreaErr",f:hx},44:{n:"PtgRefN",f:Ex},45:{n:"PtgAreaN",f:px},46:{n:"PtgMemAreaN",f:lg},47:{n:"PtgMemNoMemN",f:fg},57:{n:"PtgNameX",f:Wx},58:{n:"PtgRef3d",f:Cx},59:{n:"PtgArea3d",f:ux},60:{n:"PtgRefErr3d",f:Gx},61:{n:"PtgAreaErr3d",f:dx},255:{}},hg={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},dg={1:{n:"PtgElfLel",f:Vl},2:{n:"PtgElfRw",f:rg},3:{n:"PtgElfCol",f:Kx},6:{n:"PtgElfRwV",f:ng},7:{n:"PtgElfColV",f:Jx},10:{n:"PtgElfRadical",f:Qx},11:{n:"PtgElfRadicalS",f:tg},13:{n:"PtgElfColS",f:Zx},15:{n:"PtgElfColSV",f:qx},16:{n:"PtgElfRadicalLel",f:eg},25:{n:"PtgList",f:ig},29:{n:"PtgSxName",f:sg},255:{}},pg={0:{n:"PtgAttrNoop",f:ug},1:{n:"PtgAttrSemi",f:wx},2:{n:"PtgAttrIf",f:_x},4:{n:"PtgAttrChoose",f:xx},8:{n:"PtgAttrGoto",f:gx},16:{n:"PtgAttrSum",f:Ax},32:{n:"PtgAttrBaxcel",f:vc},33:{n:"PtgAttrBaxcel",f:vc},64:{n:"PtgAttrSpace",f:yx},65:{n:"PtgAttrSpaceSemi",f:Sx},128:{n:"PtgAttrIfError",f:vx},255:{}};function Ja(e,r,t,n){if(n.biff<8)return ar(e,r);for(var a=e.l+r,i=[],s=0;s!==t.length;++s)switch(t[s][0]){case"PtgArray":t[s][1]=Lx(e,0,n),i.push(t[s][1]);break;case"PtgMemArea":t[s][2]=Bx(e,t[s][1],n),i.push(t[s][2]);break;case"PtgExp":n&&n.biff==12&&(t[s][1][1]=e.read_shift(4),i.push(t[s][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[s][0];default:break}return r=a-e.l,r!==0&&i.push(ar(e,r)),i}function Qa(e,r,t){for(var n=e.l+r,a,i,s=[];n!=e.l;)r=n-e.l,i=e[e.l],a=wc[i]||wc[hg[i]],(i===24||i===25)&&(a=(i===24?dg:pg)[e[e.l+1]]),!a||!a.f?ar(e,r):s.push([a.n,a.f(e,r,t)]);return s}function mg(e){for(var r=[],t=0;t<e.length;++t){for(var n=e[t],a=[],i=0;i<n.length;++i){var s=n[i];if(s)switch(s[0]){case 2:a.push('"'+s[1].replace(/"/g,'""')+'"');break;default:a.push(s[1])}else a.push("")}r.push(a.join(","))}return r.join(";")}var xg={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function gg(e,r){var t=e.lastIndexOf("!"),n=r.lastIndexOf("!");return t==-1&&n==-1?e+":"+r:t>0&&n>0&&e.slice(0,t).toLowerCase()==r.slice(0,n).toLowerCase()?e+":"+r.slice(n+1):(console.error("Cannot hydrate range",e,r),e+":"+r)}function Hl(e,r,t){if(!e)return"SH33TJSERR0";if(t.biff>8&&(!e.XTI||!e.XTI[r]))return e.SheetNames[r];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[r];if(t.biff<8)return r>1e4&&(r-=65536),r<0&&(r=-r),r==0?"":e.XTI[r-1];if(!n)return"SH33TJSERR1";var a="";if(t.biff>8)switch(e[n[0]][0]){case 357:return a=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return t.SID!=null?e.SheetNames[t.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return e[n[0]][0][3]?(a=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function yc(e,r,t){var n=Hl(e,r,t);return n=="#REF"?n:xd(n,t)}function Qt(e,r,t,n,a){var i=a&&a.biff||8,s={s:{c:0,r:0},e:{c:0,r:0}},o=[],c,l,f,d=0,h=0,u,x="";if(!e[0]||!e[0][0])return"";for(var g=-1,p="",m=0,w=e[0].length;m<w;++m){var _=e[0][m];switch(_[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=o.pop(),l=o.pop(),g>=0){switch(e[0][g][1][0]){case 0:p=Ge(" ",e[0][g][1][1]);break;case 1:p=Ge("\r",e[0][g][1][1]);break;default:if(p="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}l=l+p,g=-1}o.push(l+xg[_[0]]+c);break;case"PtgIsect":c=o.pop(),l=o.pop(),o.push(l+" "+c);break;case"PtgUnion":c=o.pop(),l=o.pop(),o.push(l+","+c);break;case"PtgRange":c=o.pop(),l=o.pop(),o.push(gg(l,c));break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":f=Oa(_[1][1],s,a),o.push(Pa(f,i));break;case"PtgRefN":f=t?Oa(_[1][1],t,a):_[1][1],o.push(Pa(f,i));break;case"PtgRef3d":d=_[1][1],f=Oa(_[1][2],s,a),x=yc(n,d,a);var F=x;o.push(x+"!"+Pa(f,i));break;case"PtgFunc":case"PtgFuncVar":var N=_[1][0],j=_[1][1];N||(N=0),N&=127;var O=N==0?[]:o.slice(-N);o.length-=N,j==="User"&&(j=O.shift()),o.push(j+"("+O.join(",")+")");break;case"PtgBool":o.push(_[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(_[1]);break;case"PtgNum":o.push(String(_[1]));break;case"PtgStr":o.push('"'+_[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(_[1]);break;case"PtgAreaN":u=Q0(_[1][1],t?{s:t}:s,a),o.push(Vs(u,a));break;case"PtgArea":u=Q0(_[1][1],s,a),o.push(Vs(u,a));break;case"PtgArea3d":d=_[1][1],u=_[1][2],x=yc(n,d,a),o.push(x+"!"+Vs(u,a));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=_[1][2];var P=(n.names||[])[h-1]||(n[0]||[])[h],D=P?P.Name:"SH33TJSNAME"+String(h);D&&D.slice(0,6)=="_xlfn."&&!a.xlfn&&(D=D.slice(6)),o.push(D);break;case"PtgNameX":var W=_[1][1];h=_[1][2];var B;if(a.biff<=5)W<0&&(W=-W),n[W]&&(B=n[W][h]);else{var U="";if(((n[W]||[])[0]||[])[0]==14849||(((n[W]||[])[0]||[])[0]==1025?n[W][h]&&n[W][h].itab>0&&(U=n.SheetNames[n[W][h].itab-1]+"!"):U=n.SheetNames[h-1]+"!"),n[W]&&n[W][h])U+=n[W][h].Name;else if(n[0]&&n[0][h])U+=n[0][h].Name;else{var K=(Hl(n,W,a)||"").split(";;");K[h-1]?U=K[h-1]:U+="SH33TJSERRX"}o.push(U);break}B||(B={Name:"SH33TJSERRY"}),o.push(B.Name);break;case"PtgParen":var he="(",re=")";if(g>=0){switch(p="",e[0][g][1][0]){case 2:he=Ge(" ",e[0][g][1][1])+he;break;case 3:he=Ge("\r",e[0][g][1][1])+he;break;case 4:re=Ge(" ",e[0][g][1][1])+re;break;case 5:re=Ge("\r",e[0][g][1][1])+re;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}g=-1}o.push(he+o.pop()+re);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":f={c:_[1][1],r:_[1][0]};var Ee={c:t.c,r:t.r};if(n.sharedf[Ye(f)]){var te=n.sharedf[Ye(f)];o.push(Qt(te,s,Ee,n,a))}else{var ve=!1;for(c=0;c!=n.arrayf.length;++c)if(l=n.arrayf[c],!(f.c<l[0].s.c||f.c>l[0].e.c)&&!(f.r<l[0].s.r||f.r>l[0].e.r)){o.push(Qt(l[1],s,Ee,n,a)),ve=!0;break}ve||o.push(_[1])}break;case"PtgArray":o.push("{"+mg(_[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":g=m;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+_[1].idx+"[#"+_[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(_));default:throw new Error("Unrecognized Formula Token: "+String(_))}var Te=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&g>=0&&Te.indexOf(e[0][m][0])==-1){_=e[0][g];var se=!0;switch(_[1][0]){case 4:se=!1;case 0:p=Ge(" ",_[1][1]);break;case 5:se=!1;case 1:p=Ge("\r",_[1][1]);break;default:if(p="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+_[1][0])}o.push((se?p:"")+o.pop()+(se?"":p)),g=-1}}if(o.length>1&&a.WTF)throw new Error("bad formula stack");return o[0]=="TRUE"?!0:o[0]=="FALSE"?!1:o[0]}function _g(e,r,t){var n=e.l+r,a=t.biff==2?1:2,i,s=e.read_shift(a);if(s==65535)return[[],ar(e,r-2)];var o=Qa(e,s,t);return r!==s+a&&(i=Ja(e,r-s-a,o,t)),e.l=n,[o,i]}function vg(e,r,t){var n=e.l+r,a=t.biff==2?1:2,i,s=e.read_shift(a);if(s==65535)return[[],ar(e,r-2)];var o=Qa(e,s,t);return r!==s+a&&(i=Ja(e,r-s-a,o,t)),e.l=n,[o,i]}function wg(e,r,t,n){var a=e.l+r,i=Qa(e,n,t),s;return a!==e.l&&(s=Ja(e,a-e.l,i,t)),[i,s]}function yg(e,r,t){var n=e.l+r,a,i=e.read_shift(2),s=Qa(e,i,t);return i==65535?[[],ar(e,r-2)]:(r!==i+2&&(a=Ja(e,n-i-2,s,t)),[s,a])}function Sg(e){var r;if(nn(e,e.l+6)!==65535)return[tr(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return r=e[e.l+2]===1,e.l+=8,[r,"b"];case 2:return r=e[e.l+2],e.l+=8,[r,"e"];case 3:return e.l+=8,["","s"]}return[]}function Xs(e,r,t){var n=e.l+r,a=Gr(e,6,t),i=Sg(e,8),s=e.read_shift(1);t.biff!=2&&(e.read_shift(1),t.biff>=5&&e.read_shift(4));var o=vg(e,n-e.l,t);return{cell:a,val:i[0],formula:o,shared:s>>3&1,tt:i[1]}}function os(e,r,t){var n=e.read_shift(4),a=Qa(e,n,t),i=e.read_shift(4),s=i>0?Ja(e,i,a,t):null;return[a,s]}var kg=os,cs=os,Eg=os,Cg=os;var Tg={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},zl={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},bg={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Sc(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(r,t){return t.replace(/\./g,"")}),e=e.replace(/\$'([^']|'')+'/g,function(r){return r.slice(1)}),e=e.replace(/\$([^\]\. #$]+)/g,function(r,t){return t.match(/^([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])?(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})?$/)?r:t}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function Gs(e){e=e.replace(/\$'([^']|'')+'/g,function(n){return n.slice(1)}),e=e.replace(/\$([^\]\. #$]+)/g,function(n,a){return a.match(/^([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])?(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})?$/)?n:a});var r=e.split(":"),t=r[0].split(".")[0];return[t,r[0].split(".")[1]+(r.length>1?":"+(r[1].split(".")[1]||r[1].split(".")[0]):"")]}var Ba={},la={};function La(e,r){if(e){var t=[.7,.7,.75,.75,.3,.3];r=="xlml"&&(t=[1,1,1,1,.5,.5]),e.left==null&&(e.left=t[0]),e.right==null&&(e.right=t[1]),e.top==null&&(e.top=t[2]),e.bottom==null&&(e.bottom=t[3]),e.header==null&&(e.header=t[4]),e.footer==null&&(e.footer=t[5])}}function Xl(e,r,t,n,a,i,s){try{n.cellNF&&(e.z=De[r])}catch(c){if(n.WTF)throw c}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Gt(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(De[r]==null&&Pn(vh[r]||"General",r),e.t==="e")e.w=e.w||pr[e.v];else if(r===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Ha(e.v);else if(e.t==="d"){var o=Mt(e.v,!!s);(o|0)===o?e.w=o.toString(10):e.w=Ha(o)}else{if(e.v===void 0)return"";e.w=Ln(e.v,la)}else e.t==="d"?e.w=kr(r,Mt(e.v,!!s),la):e.w=kr(r,e.v,la)}catch(c){if(n.WTF)throw c}if(n.cellStyles&&t!=null)try{e.s=i.Fills[t],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Zi(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Zi(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(c){if(n.WTF&&i.Fills)throw c}}}function Fg(e,r){var t=Ct(r);t.s.r<=t.e.r&&t.s.c<=t.e.c&&t.s.r>=0&&t.s.c>=0&&(e["!ref"]=Xe(t))}var Ag=/<(?:\w+:)?mergeCell ref=["'][A-Z0-9:]+['"]\s*[\/]?>/g,Dg=/<(?:\w+:)?hyperlink [^<>]*>/mg,Rg=/"(\w*:\w*)"/,Og=/<(?:\w+:)?col\b[^<>]*[\/]?>/g,Pg=/<(?:\w+:)?autoFilter[^>]*/g,Ng=/<(?:\w+:)?pageMargins[^<>]*\/>/g,Gl=/<(?:\w+:)?sheetPr\b[^<>]*?\/>/;function Ig(e,r,t,n,a,i,s){if(!e)return e;n||(n={"!id":{}}),Et!=null&&r.dense==null&&(r.dense=Et);var o={};r.dense&&(o["!data"]=[]);var c={s:{r:2e6,c:2e6},e:{r:0,c:0}},l="",f="",d=Ht(e,"sheetData");d?(l=e.slice(0,d.index),f=e.slice(d.index+d[0].length)):l=f=e;var h=l.match(Gl);h?Fo(h[0],o,a,t):(h=Ht(l,"sheetPr"))&&Mg(h[0],h[1]||"",o,a,t,s,i);var u=(l.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(u>0){var x=l.slice(u,u+50).match(Rg);x&&!(r&&r.nodim)&&Fg(o,x[1])}var g=Ht(l,"sheetViews");g&&g[1]&&Hg(g[1],a);var p=[];if(r.cellStyles){var m=l.match(Og);m&&Ug(p,m)}d&&zg(d[1],o,r,c,i,s,a);var w=f.match(Pg);w&&(o["!autofilter"]=Wg(w[0]));var _=[],F=f.match(Ag);if(F)for(u=0;u!=F.length;++u)_[u]=Ct(F[u].slice(F[u].indexOf("=")+2));var N=f.match(Dg);N&&Bg(o,N,n);var j=f.match(Ng);j&&(o["!margins"]=Lg(xe(j[0])));var O;if((O=f.match(/legacyDrawing r:id="(.*?)"/))&&(o["!legrel"]=O[1]),r&&r.nodim&&(c.s.c=c.s.r=0),!o["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(o["!ref"]=Xe(c)),r.sheetRows>0&&o["!ref"]){var P=Ct(o["!ref"]);r.sheetRows<=+P.e.r&&(P.e.r=r.sheetRows-1,P.e.r>c.e.r&&(P.e.r=c.e.r),P.e.r<P.s.r&&(P.s.r=P.e.r),P.e.c>c.e.c&&(P.e.c=c.e.c),P.e.c<P.s.c&&(P.s.c=P.e.c),o["!fullref"]=o["!ref"],o["!ref"]=Xe(P))}return p.length>0&&(o["!cols"]=p),_.length>0&&(o["!merges"]=_),n["!id"][o["!legrel"]]&&(o["!legdrawel"]=n["!id"][o["!legrel"]]),o}function Fo(e,r,t,n){var a=xe(e);t.Sheets[n]||(t.Sheets[n]={}),a.codeName&&(t.Sheets[n].CodeName=ze(ft(a.codeName)))}function Mg(e,r,t,n,a){Fo(e.slice(0,e.indexOf(">")),t,n,a)}function Bg(e,r,t){for(var n=e["!data"]!=null,a=0;a!=r.length;++a){var i=xe(ft(r[a]),!0);if(!i.ref)return;var s=((t||{})["!id"]||[])[i.id];s?(i.Target=s.Target,i.location&&(i.Target+="#"+ze(i.location))):(i.Target="#"+ze(i.location),s={Target:i.Target,TargetMode:"Internal"}),i.Rel=s,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var o=Ct(i.ref),c=o.s.r;c<=o.e.r;++c)for(var l=o.s.c;l<=o.e.c;++l){var f=qe(l)+at(c);n?(e["!data"][c]||(e["!data"][c]=[]),e["!data"][c][l]||(e["!data"][c][l]={t:"z",v:void 0}),e["!data"][c][l].l=i):(e[f]||(e[f]={t:"z",v:void 0}),e[f].l=i)}}}function Lg(e){var r={};return["left","right","top","bottom","header","footer"].forEach(function(t){e[t]&&(r[t]=parseFloat(e[t]))}),r}function Ug(e,r){for(var t=!1,n=0;n!=r.length;++n){var a=xe(r[n],!0);a.hidden&&(a.hidden=nt(a.hidden));var i=parseInt(a.min,10)-1,s=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!t&&a.width&&(t=!0,Co(a.width)),da(a);i<=s;)e[i++]=Nt(a)}}function Wg(e){var r={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return r}var Vg=/<(?:\w:)?sheetView(?:[^<>a-z][^<>]*)?\/?>/g;function Hg(e,r){r.Views||(r.Views=[{}]),(e.match(Vg)||[]).forEach(function(t,n){var a=xe(t);r.Views[n]||(r.Views[n]={}),+a.zoomScale&&(r.Views[n].zoom=+a.zoomScale),a.rightToLeft&&nt(a.rightToLeft)&&(r.Views[n].RTL=!0)})}var zg=(function(){var e=/<(?:\w+:)?c[ \/>]/,r=/<\/(?:\w+:)?row>/,t=/r=["']([^"']*)["']/,n=/ref=["']([^"']*)["']/;return function(i,s,o,c,l,f,d){for(var h=0,u="",x=[],g=[],p=0,m=0,w=0,_="",F,N,j=0,O=0,P,D,W=0,B=0,U=Array.isArray(f.CellXf),K,he=[],re=[],Ee=s["!data"]!=null,te=[],ve={},Te=!1,se=!!o.sheetStubs,Pe=!!((d||{}).WBProps||{}).date1904,J=i.split(r),ke=0,ge=J.length;ke!=ge;++ke){u=J[ke].trim();var Ue=u.length;if(Ue!==0){var we=0;e:for(h=0;h<Ue;++h)switch(u[h]){case">":if(u[h-1]!="/"){++h;break e}if(o&&o.cellStyles){if(N=xe(u.slice(we,h),!0),j=N.r!=null?parseInt(N.r,10):j+1,O=-1,o.sheetRows&&o.sheetRows<j)continue;ve={},Te=!1,N.ht&&(Te=!0,ve.hpt=parseFloat(N.ht),ve.hpx=ja(ve.hpt)),N.hidden&&nt(N.hidden)&&(Te=!0,ve.hidden=!0),N.outlineLevel!=null&&(Te=!0,ve.level=+N.outlineLevel),Te&&(te[j-1]=ve)}break;case"<":we=h;break}if(we>=h)break;if(N=xe(u.slice(we,h),!0),j=N.r!=null?parseInt(N.r,10):j+1,O=-1,!(o.sheetRows&&o.sheetRows<j)){o.nodim||(c.s.r>j-1&&(c.s.r=j-1),c.e.r<j-1&&(c.e.r=j-1)),o&&o.cellStyles&&(ve={},Te=!1,N.ht&&(Te=!0,ve.hpt=parseFloat(N.ht),ve.hpx=ja(ve.hpt)),N.hidden&&nt(N.hidden)&&(Te=!0,ve.hidden=!0),N.outlineLevel!=null&&(Te=!0,ve.level=+N.outlineLevel),Te&&(te[j-1]=ve)),x=u.slice(h).split(e);for(var be=0;be!=x.length&&x[be].trim().charAt(0)=="<";++be);for(x=x.slice(be),h=0;h!=x.length;++h)if(u=x[h].trim(),u.length!==0){if(g=u.match(t),p=h,m=0,w=0,u="<c "+(u.slice(0,1)=="<"?">":"")+u,g!=null&&g.length===2){for(p=0,_=g[1],m=0;m!=_.length&&!((w=_.charCodeAt(m)-64)<1||w>26);++m)p=26*p+w;--p,O=p}else++O;for(m=0;m!=u.length&&u.charCodeAt(m)!==62;++m);if(++m,N=xe(u.slice(0,m),!0),N.r||(N.r=Ye({r:j-1,c:O})),_=u.slice(m),F={t:""},(g=Ht(_,"v"))!=null&&g[1]!==""&&(F.v=ze(g[1])),o.cellFormula){if((g=Ht(_,"f"))!=null){if(g[1]=="")g[0].indexOf('t="shared"')>-1&&(D=xe(g[0]),re[D.si]&&(F.f=gc(re[D.si][1],re[D.si][2],N.r)));else if(F.f=ze(ft(g[1]),!0),o.xlfn||(F.f=_c(F.f)),g[0].indexOf('t="array"')>-1)F.F=(_.match(n)||[])[1],F.F.indexOf(":")>-1&&he.push([Ct(F.F),F.F]);else if(g[0].indexOf('t="shared"')>-1){D=xe(g[0]);var b=ze(ft(g[1]));o.xlfn||(b=_c(b)),re[parseInt(D.si,10)]=[D,b,N.r]}}else(g=_.match(/<f[^<>]*\/>/))&&(D=xe(g[0]),re[D.si]&&(F.f=gc(re[D.si][1],re[D.si][2],N.r)));var I=rr(N.r);for(m=0;m<he.length;++m)I.r>=he[m][0].s.r&&I.r<=he[m][0].e.r&&I.c>=he[m][0].s.c&&I.c<=he[m][0].e.c&&(F.F=he[m][1])}if(N.t==null&&F.v===void 0)if(F.f||F.F)F.v=0,F.t="n";else if(se)F.t="z";else continue;else F.t=N.t||"n";switch(c.s.c>O&&(c.s.c=O),c.e.c<O&&(c.e.c=O),F.t){case"n":if(F.v==""||F.v==null){if(!se)continue;F.t="z"}else F.v=parseFloat(F.v);break;case"s":if(typeof F.v>"u"){if(!se)continue;F.t="z"}else P=Ba[parseInt(F.v,10)],F.v=P.t,F.r=P.r,o.cellHTML&&(F.h=P.h);break;case"str":F.t="s",F.v=F.v!=null?ze(ft(F.v),!0):"",o.cellHTML&&(F.h=Da(F.v));break;case"inlineStr":g=Ht(_,"is"),F.t="s",g!=null&&(P=Eo(g[1]))?(F.v=P.t,o.cellHTML&&(F.h=P.h)):F.v="";break;case"b":F.v=nt(F.v);break;case"d":o.cellDates?F.v=Gt(F.v,Pe):(F.v=Mt(Gt(F.v,Pe),Pe),F.t="n");break;case"e":(!o||o.cellText!==!1)&&(F.w=F.v),F.v=zt[F.v];break}if(W=B=0,K=null,U&&N.s!==void 0&&(K=f.CellXf[N.s],K!=null&&(K.numFmtId!=null&&(W=K.numFmtId),o.cellStyles&&K.fillId!=null&&(B=K.fillId))),Xl(F,W,B,o,l,f,Pe),o.cellDates&&U&&F.t=="n"&&Xr(De[W])&&(F.v=gn(F.v+(Pe?1462:0)),F.t=typeof F.v=="number"?"n":"d"),N.cm&&o.xlmeta){var R=(o.xlmeta.Cell||[])[+N.cm-1];R&&R.type=="XLDAPR"&&(F.D=!0)}var A;o.nodim&&(A=rr(N.r),c.s.r>A.r&&(c.s.r=A.r),c.e.r<A.r&&(c.e.r=A.r)),Ee?(A=rr(N.r),s["!data"][A.r]||(s["!data"][A.r]=[]),s["!data"][A.r][A.c]=F):s[N.r]=F}}}}te.length>0&&(s["!rows"]=te)}})();function Xg(e,r){var t={},n=e.l+r;t.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=n,i&7&&(t.level=i&7),i&16&&(t.hidden=!0),i&32&&(t.hpt=a/20),t}var Gg=Xn;function jg(){}function $g(e,r){var t={},n=e[e.l];return++e.l,t.above=!(n&64),t.left=!(n&128),e.l+=18,t.name=yd(e,r-19),t}function Yg(e){var r=Ir(e);return[r]}function Kg(e){var r=zn(e);return[r]}function Zg(e){var r=Ir(e),t=e.read_shift(1);return[r,t,"b"]}function qg(e){var r=zn(e),t=e.read_shift(1);return[r,t,"b"]}function Jg(e){var r=Ir(e),t=e.read_shift(1);return[r,t,"e"]}function Qg(e){var r=zn(e),t=e.read_shift(1);return[r,t,"e"]}function e_(e){var r=Ir(e),t=e.read_shift(4);return[r,t,"s"]}function t_(e){var r=zn(e),t=e.read_shift(4);return[r,t,"s"]}function r_(e){var r=Ir(e),t=tr(e);return[r,t,"n"]}function jl(e){var r=zn(e),t=tr(e);return[r,t,"n"]}function n_(e){var r=Ir(e),t=is(e);return[r,t,"n"]}function a_(e){var r=zn(e),t=is(e);return[r,t,"n"]}function i_(e){var r=Ir(e),t=yo(e);return[r,t,"is"]}function s_(e){var r=Ir(e),t=nr(e);return[r,t,"str"]}function o_(e){var r=zn(e),t=nr(e);return[r,t,"str"]}function c_(e,r,t){var n=e.l+r,a=Ir(e);a.r=t["!row"];var i=e.read_shift(1),s=[a,i,"b"];if(t.cellFormula){e.l+=2;var o=cs(e,n-e.l,t);s[3]=Qt(o,null,a,t.supbooks,t)}else e.l=n;return s}function l_(e,r,t){var n=e.l+r,a=Ir(e);a.r=t["!row"];var i=e.read_shift(1),s=[a,i,"e"];if(t.cellFormula){e.l+=2;var o=cs(e,n-e.l,t);s[3]=Qt(o,null,a,t.supbooks,t)}else e.l=n;return s}function f_(e,r,t){var n=e.l+r,a=Ir(e);a.r=t["!row"];var i=tr(e),s=[a,i,"n"];if(t.cellFormula){e.l+=2;var o=cs(e,n-e.l,t);s[3]=Qt(o,null,a,t.supbooks,t)}else e.l=n;return s}function u_(e,r,t){var n=e.l+r,a=Ir(e);a.r=t["!row"];var i=nr(e),s=[a,i,"str"];if(t.cellFormula){e.l+=2;var o=cs(e,n-e.l,t);s[3]=Qt(o,null,a,t.supbooks,t)}else e.l=n;return s}var h_=Xn;function d_(e,r){var t=e.l+r,n=Xn(e,16),a=as(e),i=nr(e),s=nr(e),o=nr(e);e.l=t;var c={rfx:n,relId:a,loc:i,display:o};return s&&(c.Tooltip=s),c}function p_(){}function m_(e,r,t){var n=e.l+r,a=ul(e,16),i=e.read_shift(1),s=[a];if(s[2]=i,t.cellFormula){var o=kg(e,n-e.l,t);s[1]=o}else e.l=n;return s}function x_(e,r,t){var n=e.l+r,a=Xn(e,16),i=[a];if(t.cellFormula){var s=Cg(e,n-e.l,t);i[1]=s,e.l=n}else e.l=n;return i}var g_=["left","right","top","bottom","header","footer"];function __(e){var r={};return g_.forEach(function(t){r[t]=tr(e,8)}),r}function v_(e){var r=e.read_shift(2);return e.l+=28,{RTL:r&32}}function w_(){}function y_(){}function S_(e,r,t,n,a,i,s){if(!e)return e;var o=r||{};n||(n={"!id":{}}),Et!=null&&o.dense==null&&(o.dense=Et);var c={};o.dense&&(c["!data"]=[]);var l,f={s:{r:2e6,c:2e6},e:{r:0,c:0}},d=[],h=!1,u=!1,x,g,p,m,w,_,F,N,j,O=[];o.biff=12,o["!row"]=0;var P=0,D=!1,W=[],B={},U=o.supbooks||a.supbooks||[[]];if(U.sharedf=B,U.arrayf=W,U.SheetNames=a.SheetNames||a.Sheets.map(function(Pe){return Pe.name}),!o.supbooks&&(o.supbooks=U,a.Names))for(var K=0;K<a.Names.length;++K)U[0][K+1]=a.Names[K];var he=[],re=[],Ee=!1;Qi[16]={n:"BrtShortReal",f:jl};var te,ve,Te=1462*+!!((a||{}).WBProps||{}).date1904;if(cn(e,function(J,ke,ge){if(!u)switch(ge){case 148:l=J;break;case 0:x=J,o.sheetRows&&o.sheetRows<=x.r&&(u=!0),N=at(m=x.r),o["!row"]=x.r,(J.hidden||J.hpt||J.level!=null)&&(J.hpt&&(J.hpx=ja(J.hpt)),re[J.r]=J);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(g={t:J[2]},J[2]){case"n":g.v=J[1];break;case"s":F=Ba[J[1]],g.v=F.t,g.r=F.r;break;case"b":g.v=!!J[1];break;case"e":g.v=J[1],o.cellText!==!1&&(g.w=pr[g.v]);break;case"str":g.t="s",g.v=J[1];break;case"is":g.t="s",g.v=J[1].t;break}if((p=s.CellXf[J[0].iStyleRef])&&Xl(g,p.numFmtId,null,o,i,s,Te>0),w=J[0].c==-1?w+1:J[0].c,o.dense?(c["!data"][m]||(c["!data"][m]=[]),c["!data"][m][w]=g):c[qe(w)+N]=g,o.cellFormula){for(D=!1,P=0;P<W.length;++P){var Ue=W[P];x.r>=Ue[0].s.r&&x.r<=Ue[0].e.r&&w>=Ue[0].s.c&&w<=Ue[0].e.c&&(g.F=Xe(Ue[0]),D=!0)}!D&&J.length>3&&(g.f=J[3])}if(f.s.r>x.r&&(f.s.r=x.r),f.s.c>w&&(f.s.c=w),f.e.r<x.r&&(f.e.r=x.r),f.e.c<w&&(f.e.c=w),o.cellDates&&p&&g.t=="n"&&Xr(De[p.numFmtId])){var we=tn(g.v+Te);we&&(g.t="d",g.v=new Date(Date.UTC(we.y,we.m-1,we.d,we.H,we.M,we.S,we.u)))}te&&(te.type=="XLDAPR"&&(g.D=!0),te=void 0),ve&&(ve=void 0);break;case 1:case 12:if(!o.sheetStubs||h)break;g={t:"z",v:void 0},w=J[0].c==-1?w+1:J[0].c,o.dense?(c["!data"][m]||(c["!data"][m]=[]),c["!data"][m][w]=g):c[qe(w)+N]=g,f.s.r>x.r&&(f.s.r=x.r),f.s.c>w&&(f.s.c=w),f.e.r<x.r&&(f.e.r=x.r),f.e.c<w&&(f.e.c=w),te&&(te.type=="XLDAPR"&&(g.D=!0),te=void 0),ve&&(ve=void 0);break;case 176:O.push(J);break;case 49:te=((o.xlmeta||{}).Cell||[])[J-1];break;case 494:var be=n["!id"][J.relId];for(be?(J.Target=be.Target,J.loc&&(J.Target+="#"+J.loc),J.Rel=be):J.relId==""&&(J.Target="#"+J.loc),m=J.rfx.s.r;m<=J.rfx.e.r;++m)for(w=J.rfx.s.c;w<=J.rfx.e.c;++w)o.dense?(c["!data"][m]||(c["!data"][m]=[]),c["!data"][m][w]||(c["!data"][m][w]={t:"z",v:void 0}),c["!data"][m][w].l=J):(_=qe(w)+at(m),c[_]||(c[_]={t:"z",v:void 0}),c[_].l=J);break;case 426:if(!o.cellFormula)break;W.push(J),j=o.dense?c["!data"][m][w]:c[qe(w)+N],j.f=Qt(J[1],f,{r:x.r,c:w},U,o),j.F=Xe(J[0]);break;case 427:if(!o.cellFormula)break;B[Ye(J[0].s)]=J[1],j=o.dense?c["!data"][m][w]:c[qe(w)+N],j.f=Qt(J[1],f,{r:x.r,c:w},U,o);break;case 60:if(!o.cellStyles)break;for(;J.e>=J.s;)he[J.e--]={width:J.w/256,hidden:!!(J.flags&1),level:J.level},Ee||(Ee=!0,Co(J.w/256)),da(he[J.e+1]);break;case 551:J&&(c["!legrel"]=J);break;case 161:c["!autofilter"]={ref:Xe(J)};break;case 476:c["!margins"]=J;break;case 147:a.Sheets[t]||(a.Sheets[t]={}),J.name&&(a.Sheets[t].CodeName=J.name),(J.above||J.left)&&(c["!outline"]={above:J.above,left:J.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),J.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:h=!0;break;case 36:h=!1;break;case 37:d.push(ge),h=!0;break;case 38:d.pop(),h=!1;break;default:if(!ke.T){if(!h||o.WTF)throw new Error("Unexpected record 0x"+ge.toString(16))}}},o),delete o.supbooks,delete o["!row"],!c["!ref"]&&(f.s.r<2e6||l&&(l.e.r>0||l.e.c>0||l.s.r>0||l.s.c>0))&&(c["!ref"]=Xe(l||f)),o.sheetRows&&c["!ref"]){var se=Ct(c["!ref"]);o.sheetRows<=+se.e.r&&(se.e.r=o.sheetRows-1,se.e.r>f.e.r&&(se.e.r=f.e.r),se.e.r<se.s.r&&(se.s.r=se.e.r),se.e.c>f.e.c&&(se.e.c=f.e.c),se.e.c<se.s.c&&(se.s.c=se.e.c),c["!fullref"]=c["!ref"],c["!ref"]=Xe(se))}return O.length>0&&(c["!merges"]=O),he.length>0&&(c["!cols"]=he),re.length>0&&(c["!rows"]=re),n["!id"][c["!legrel"]]&&(c["!legdrawel"]=n["!id"][c["!legrel"]]),c}function k_(e){var r=[],t=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)"[^<>\/]*><c:v>([^<])<\/c:v><\/c:pt>/mg)||[]).forEach(function(i){var s=i.match(/<c:pt idx="(\d*)"[^<>\/]*><c:v>([^<]*)<\/c:v><\/c:pt>/);s&&(r[+s[1]]=t?+s[2]:s[2])});var a=ze((Nn(e,"c:formatCode")||["","General"])[1]);return(uo(e,"<c:f>","</c:f>")||[]).forEach(function(i){n=i.replace(/<[^<>]*>/g,"")}),[r,a,n]}function E_(e,r,t,n,a,i){var s=i||{"!type":"chart"};if(!e)return i;var o=0,c=0,l="A",f={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(uo(e,"<c:numCache>","</c:numCache>")||[]).forEach(function(d){var h=k_(d);f.s.r=f.s.c=0,f.e.c=o,l=qe(o),h[0].forEach(function(u,x){s["!data"]?(s["!data"][x]||(s["!data"][x]=[]),s["!data"][x][o]={t:"n",v:u,z:h[1]}):s[l+at(x)]={t:"n",v:u,z:h[1]},c=x}),f.e.r<c&&(f.e.r=c),++o}),o>0&&(s["!ref"]=Xe(f)),s}function C_(e,r,t,n,a){if(!e)return e;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},s,o=e.match(Gl);return o&&Fo(o[0],i,a,t),(s=e.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=s[1]),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}function T_(e,r){e.l+=10;var t=nr(e,r-10);return{name:t}}function b_(e,r,t,n,a){if(!e)return e;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},s=[],o=!1;return cn(e,function(l,f,d){switch(d){case 550:i["!rel"]=l;break;case 651:a.Sheets[t]||(a.Sheets[t]={}),l.name&&(a.Sheets[t].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:s.push(d);break;case 38:s.pop();break;default:if(f.T>0)s.push(d);else if(f.T<0)s.pop();else if(!o||r.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}},r),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}var $l=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],F_=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],A_=[],D_=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function kc(e,r){for(var t=0;t!=e.length;++t)for(var n=e[t],a=0;a!=r.length;++a){var i=r[a];if(n[i[0]]==null)n[i[0]]=i[1];else switch(i[2]){case"bool":typeof n[i[0]]=="string"&&(n[i[0]]=nt(n[i[0]]));break;case"int":typeof n[i[0]]=="string"&&(n[i[0]]=parseInt(n[i[0]],10));break}}}function Ec(e,r){for(var t=0;t!=r.length;++t){var n=r[t];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=nt(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function Yl(e){Ec(e.WBProps,$l),Ec(e.CalcPr,D_),kc(e.WBView,F_),kc(e.Sheets,A_),la.date1904=nt(e.WBProps.date1904)}var R_=":][*?/\\".split("");function O_(e,r){try{if(e=="")throw new Error("Sheet name cannot be blank");if(e.length>31)throw new Error("Sheet name cannot exceed 31 chars");if(e.charCodeAt(0)==39||e.charCodeAt(e.length-1)==39)throw new Error("Sheet name cannot start or end with apostrophe (')");if(e.toLowerCase()=="history")throw new Error("Sheet name cannot be 'History'");R_.forEach(function(t){if(e.indexOf(t)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")})}catch(t){if(r)return!1;throw t}return!0}var P_=/<\w+:workbook/;function N_(e,r){if(!e)throw new Error("Could not find file");var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",i={},s=0;if(e.replace(jt,function(c,l){var f=xe(c);switch(Nr(f[0])){case"<?xml":break;case"<workbook":c.match(P_)&&(a="xmlns"+c.match(/<(\w+):/)[1]),t.xmlns=f[a];break;case"</workbook>":break;case"<fileVersion":delete f[0],t.AppVersion=f;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":$l.forEach(function(d){if(f[d[0]]!=null)switch(d[2]){case"bool":t.WBProps[d[0]]=nt(f[d[0]]);break;case"int":t.WBProps[d[0]]=parseInt(f[d[0]],10);break;default:t.WBProps[d[0]]=f[d[0]]}}),f.codeName&&(t.WBProps.CodeName=ft(f.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete f[0],t.WBView.push(f);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(f.state){case"hidden":f.Hidden=1;break;case"veryHidden":f.Hidden=2;break;default:f.Hidden=0}delete f.state,f.name=ze(ft(f.name)),delete f[0],t.Sheets.push(f);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":i={},i.Name=ft(f.name),f.comment&&(i.Comment=f.comment),f.localSheetId&&(i.Sheet=+f.localSheetId),nt(f.hidden||"0")&&(i.Hidden=!0),s=l+c.length;break;case"</definedName>":i.Ref=ze(ft(e.slice(s,l))),t.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete f[0],t.CalcPr=f;break;case"<calcPr/>":delete f[0],t.CalcPr=f;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&r.WTF)throw new Error("unrecognized "+f[0]+" in workbook")}return c}),td.indexOf(t.xmlns)===-1)throw new Error("Unknown Namespace: "+t.xmlns);return Yl(t),t}function I_(e,r){var t={};return t.Hidden=e.read_shift(4),t.iTabID=e.read_shift(4),t.strRelID=Js(e,r-8),t.name=nr(e),t}function M_(e,r){var t={},n=e.read_shift(4);t.defaultThemeVersion=e.read_shift(4);var a=r>8?nr(e):"";return a.length>0&&(t.CodeName=a),t.autoCompressPictures=!!(n&65536),t.backupFile=!!(n&64),t.checkCompatibility=!!(n&4096),t.date1904=!!(n&1),t.filterPrivacy=!!(n&8),t.hidePivotFieldList=!!(n&1024),t.promptedSolutions=!!(n&16),t.publishItems=!!(n&2048),t.refreshAllConnections=!!(n&262144),t.saveExternalLinkValues=!!(n&128),t.showBorderUnselectedTables=!!(n&4),t.showInkAnnotation=!!(n&32),t.showObjects=["all","placeholders","none"][n>>13&3],t.showPivotChartFilter=!!(n&32768),t.updateLinks=["userSet","never","always"][n>>8&3],t}function B_(e,r){var t={};return e.read_shift(4),t.ArchID=e.read_shift(4),e.l+=r-8,t}function L_(e,r,t){var n=e.l+r,a=e.read_shift(4);e.l+=1;var i=e.read_shift(4),s=Sd(e),o,c="";try{o=Eg(e,0,t);try{c=as(e)}catch{}}catch{console.error("Could not parse defined name "+s)}a&32&&(s="_xlnm."+s),e.l=n;var l={Name:s,Ptg:o,Flags:a};return i<268435455&&(l.Sheet=i),c&&(l.Comment=c),l}function U_(e,r){var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;r||(r={}),r.biff=12;var i=[],s=[[]];return s.SheetNames=[],s.XTI=[],Qi[16]={n:"BrtFRTArchID$",f:B_},cn(e,function(c,l,f){switch(f){case 156:s.SheetNames.push(c.name),t.Sheets.push(c);break;case 153:t.WBProps=c;break;case 39:c.Sheet!=null&&(r.SID=c.Sheet),c.Ref=c.Ptg?Qt(c.Ptg,null,null,s,r):"#REF!",delete r.SID,delete c.Ptg,i.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:s[0].length?s.push([f,c]):s[0]=[f,c],s[s.length-1].XTI=[];break;case 362:s.length===0&&(s[0]=[],s[0].XTI=[]),s[s.length-1].XTI=s[s.length-1].XTI.concat(c),s.XTI=s.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(f),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(f),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!l.T){if(!a||r.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}},r),Yl(t),t.Names=i,t.supbooks=s,t}function W_(e,r,t){return r.slice(-4)===".bin"?U_(e,t):N_(e,t)}function V_(e,r,t,n,a,i,s,o){return r.slice(-4)===".bin"?S_(e,n,t,a,i,s,o):Ig(e,n,t,a,i,s,o)}function H_(e,r,t,n,a,i,s,o){return r.slice(-4)===".bin"?b_(e,n,t,a,i,s,o):C_(e,n,t,a,i,s,o)}function z_(e,r,t,n,a,i,s,o){return r.slice(-4)===".bin"?tx(e,n,t,a,i,s,o):rx(e,n,t,a,i,s,o)}function X_(e,r,t,n,a,i,s,o){return r.slice(-4)===".bin"?Qm(e,n,t,a,i,s,o):ex(e,n,t,a,i,s,o)}function G_(e,r,t,n){return r.slice(-4)===".bin"?ym(e,t,n):mm(e,t,n)}function j_(e,r,t){return r.slice(-4)===".bin"?Mp(e,t):Np(e,t)}function $_(e,r,t){return r.slice(-4)===".bin"?Zm(e,t):Gm(e,t)}function Y_(e,r,t){return r.slice(-4)===".bin"?Vm(e,r,t):Um(e,r,t)}function K_(e,r,t,n){return t.slice(-4)===".bin"?Hm(e,r,t,n):void 0}function Z_(e,r,t){return r.slice(-4)===".bin"?Bm(e,r,t):Lm(e,r,t)}var Kl=/\b((?:\w+:)?[\w]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,Zl=/\b((?:\w+:)?[\w]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Vr(e,r){var t=e.split(/\s+/),n=[];if(r||(n[0]=t[0]),t.length===1)return n;var a=e.match(Kl),i,s,o,c;if(a)for(c=0;c!=a.length;++c)i=a[c].match(Zl),(s=i[1].indexOf(":"))===-1?n[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?o="xmlns"+i[1].slice(6):o=i[1].slice(s+1),n[o]=i[2].slice(1,i[2].length-1));return n}function q_(e){var r=e.split(/\s+/),t={};if(r.length===1)return t;var n=e.match(Kl),a,i,s,o;if(n)for(o=0;o!=n.length;++o)a=n[o].match(Zl),(i=a[1].indexOf(":"))===-1?t[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?s="xmlns"+a[1].slice(6):s=a[1].slice(i+1),t[s]=a[2].slice(1,a[2].length-1));return t}var Ua;function J_(e,r,t){var n=Ua[e]||ze(e);return n==="General"?Ln(r):kr(n,r,{date1904:!!t})}function Q_(e,r,t,n){var a=n;switch((t[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=nt(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=Gt(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+t[0])}e[ze(r)]=a}function ev(e,r,t,n){if(e.t!=="z"){if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||pr[e.v]:r==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Ha(e.v):e.w=Ln(e.v):e.w=J_(r||"General",e.v,n)}catch(s){if(t.WTF)throw s}try{var a=Ua[r]||r||"General";if(t.cellNF&&(e.z=a),t.cellDates&&e.t=="n"&&Xr(a)){var i=tn(e.v+(n?1462:0));i&&(e.t="d",e.v=new Date(Date.UTC(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u)))}}catch(s){if(t.WTF)throw s}}}function tv(e,r,t){if(t.cellStyles&&r.Interior){var n=r.Interior;n.Pattern&&(n.patternType=lm[n.Pattern]||n.Pattern)}e[r.ID]=r}function rv(e,r,t,n,a,i,s,o,c,l,f){var d="General",h=n.StyleID,u={};l=l||{};var x=[],g=0;for(h===void 0&&o&&(h=o.StyleID),h===void 0&&s&&(h=s.StyleID);i[h]!==void 0;){var p=i[h];if(p.nf&&(d=p.nf),p.Interior&&x.push(p.Interior),!p.Parent)break;h=p.Parent}switch(t.Type){case"Boolean":n.t="b",n.v=nt(e);break;case"String":n.t="s",n.r=X0(ze(e)),n.v=e.indexOf("<")>-1?ze(r||e).replace(/<[^<>]*>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=Mt(Gt(e,f),f),n.v!==n.v&&(n.v=ze(e)),(!d||d=="General")&&(d="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=zt[e],l.cellText!==!1&&(n.w=e);break;default:e==""&&r==""?n.t="z":(n.t="s",n.v=X0(r||e));break}if(ev(n,d,l,f),l.cellFormula!==!1)if(n.Formula){var m=ze(n.Formula);m.charCodeAt(0)==61&&(m=m.slice(1)),n.f=Mn(m,a),delete n.Formula,n.ArrayRange=="RC"?n.F=Mn("RC:RC",a):n.ArrayRange&&(n.F=Mn(n.ArrayRange,a),c.push([Ct(n.F),n.F]))}else for(g=0;g<c.length;++g)a.r>=c[g][0].s.r&&a.r<=c[g][0].e.r&&a.c>=c[g][0].s.c&&a.c<=c[g][0].e.c&&(n.F=c[g][1]);l.cellStyles&&(x.forEach(function(w){!u.patternType&&w.patternType&&(u.patternType=w.patternType)}),n.s=u),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function nv(e){return pl.indexOf("_xlnm."+e)>-1?"_xlnm."+e:e}function av(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function js(e,r){var t=r||{};zc();var n=ba(rs(e));(t.type=="binary"||t.type=="array"||t.type=="base64")&&(typeof Le<"u"?n=Le.utils.decode(65001,Ks(n)):n=ft(n));var a=n.slice(0,1024).toLowerCase(),i=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var s=Nt(t);return s.type="string",Xa.to_workbook(n,s)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Ne){a.indexOf("<"+Ne)>=0&&(i=!0)}),i)return dv(n,t);Ua={"General Number":"General","General Date":De[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":De[15],"Short Date":De[14],"Long Time":De[19],"Medium Time":De[18],"Short Time":De[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:De[2],Standard:De[4],Percent:De[10],Scientific:De[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,c=[],l;Et!=null&&t.dense==null&&(t.dense=Et);var f={},d=[],h={},u="";t.dense&&(h["!data"]=[]);var x={},g={},p=Vr('<Data ss:Type="String">'),m=0,w=0,_=0,F={s:{r:2e6,c:2e6},e:{r:0,c:0}},N={},j={},O="",P=0,D=[],W={},B={},U=0,K=[],he=[],re={},Ee=[],te,ve=!1,Te=[],se=[],Pe={},J=0,ke=0,ge={Sheets:[],WBProps:{date1904:!1}},Ue={};Pt.lastIndex=0,n=Ka(n,"<!--","-->");for(var we="";o=Pt.exec(n);)switch(o[3]=(we=o[3]).toLowerCase()){case"data":if(we=="data"){if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break}if(c[c.length-1][1])break;o[1]==="/"?rv(n.slice(m,o.index),O,p,c[c.length-1][0]=="comment"?re:x,{c:w,r:_},N,Ee[w],g,Te,t,ge.WBProps.date1904):(O="",p=Vr(o[0]),m=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(he.length>0&&(x.c=he),(!t.sheetRows||t.sheetRows>_)&&x.v!==void 0&&(t.dense?(h["!data"][_]||(h["!data"][_]=[]),h["!data"][_][w]=x):h[qe(w)+at(_)]=x),x.HRef&&(x.l={Target:ze(x.HRef)},x.HRefScreenTip&&(x.l.Tooltip=x.HRefScreenTip),delete x.HRef,delete x.HRefScreenTip),(x.MergeAcross||x.MergeDown)&&(J=w+(parseInt(x.MergeAcross,10)|0),ke=_+(parseInt(x.MergeDown,10)|0),(J>w||ke>_)&&D.push({s:{c:w,r:_},e:{c:J,r:ke}})),!t.sheetStubs)x.MergeAcross?w=J+1:++w;else if(x.MergeAcross||x.MergeDown){for(var be=w;be<=J;++be)for(var b=_;b<=ke;++b)(be>w||b>_)&&(t.dense?(h["!data"][b]||(h["!data"][b]=[]),h["!data"][b][be]={t:"z"}):h[qe(be)+at(b)]={t:"z"});w=J+1}else++w;else x=q_(o[0]),x.Index&&(w=+x.Index-1),w<F.s.c&&(F.s.c=w),w>F.e.c&&(F.e.c=w),o[0].slice(-2)==="/>"&&++w,he=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(_<F.s.r&&(F.s.r=_),_>F.e.r&&(F.e.r=_),o[0].slice(-2)==="/>"&&(g=Vr(o[0]),g.Index&&(_=+g.Index-1)),w=0,++_):(g=Vr(o[0]),g.Index&&(_=+g.Index-1),Pe={},(g.AutoFitHeight=="0"||g.Height)&&(Pe.hpx=parseInt(g.Height,10),Pe.hpt=Nl(Pe.hpx),se[_]=Pe),g.Hidden=="1"&&(Pe.hidden=!0,se[_]=Pe));break;case"worksheet":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"));d.push(u),F.s.r<=F.e.r&&F.s.c<=F.e.c&&(h["!ref"]=Xe(F),t.sheetRows&&t.sheetRows<=F.e.r&&(h["!fullref"]=h["!ref"],F.e.r=t.sheetRows-1,h["!ref"]=Xe(F))),D.length&&(h["!merges"]=D),Ee.length>0&&(h["!cols"]=Ee),se.length>0&&(h["!rows"]=se),f[u]=h}else F={s:{r:2e6,c:2e6},e:{r:0,c:0}},_=w=0,c.push([o[3],!1]),l=Vr(o[0]),u=ze(l.Name),h={},t.dense&&(h["!data"]=[]),D=[],Te=[],se=[],Ue={name:u,Hidden:0},ge.Sheets.push(Ue);break;case"table":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else{if(o[0].slice(-2)=="/>")break;c.push([o[3],!1]),Ee=[],ve=!1}break;case"style":o[1]==="/"?tv(N,j,t):j=Vr(o[0]);break;case"numberformat":j.nf=ze(Vr(o[0]).Format||"General"),Ua[j.nf]&&(j.nf=Ua[j.nf]);for(var I=0;I!=392&&De[I]!=j.nf;++I);if(I==392){for(I=57;I!=392;++I)if(De[I]==null){Pn(j.nf,I);break}}break;case"column":if(c[c.length-1][0]!=="table"||o[1]==="/")break;if(te=Vr(o[0]),te.Hidden&&(te.hidden=!0,delete te.Hidden),te.Width&&(te.wpx=parseInt(te.Width,10)),!ve&&te.wpx>10){ve=!0,or=Ol;for(var R=0;R<Ee.length;++R)Ee[R]&&da(Ee[R])}ve&&da(te),Ee[te.Index-1||Ee.length]=te;for(var A=0;A<+te.Span;++A)Ee[Ee.length]=Nt(te);break;case"namedrange":if(o[1]==="/")break;ge.Names||(ge.Names=[]);var q=xe(o[0]),C={Name:nv(q.Name),Ref:Mn(q.RefersTo.slice(1),{r:0,c:0})};ge.Sheets.length>0&&(C.Sheet=ge.Sheets.length-1),ge.Names.push(C);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?O+=n.slice(P,o.index):P=o.index+o[0].length;break;case"interior":if(!t.cellStyles)break;j.Interior=Vr(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?jd(W,we,n.slice(U,o.index)):U=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else c.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"));av(re),he.push(re)}else c.push([o[3],!1]),l=Vr(o[0]),nt(l.ShowAlways||"0")||(he.hidden=!0),re={a:l.Author};break;case"autofilter":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var ye=Vr(o[0]);h["!autofilter"]={ref:Mn(ye.Range).replace(/\$/g,"")},c.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"null":break;default:if(c.length==0&&o[3]=="document"||c.length==0&&o[3]=="uof")return Ac(n,t);var ue=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:ue=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:ue=!1}break;case"excelworkbook":switch(o[3]){case"date1904":ge.WBProps.date1904=!0;break;case"hidehorizontalscrollbar":break;case"hideverticalscrollbar":break;case"hideworkbooktabs":break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:ue=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:ue=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(U,o.index)){case"SheetHidden":Ue.Hidden=1;break;case"SheetVeryHidden":Ue.Hidden=2;break}else U=o.index+o[0].length;break;case"header":h["!margins"]||La(h["!margins"]={},"xlml"),isNaN(+xe(o[0]).Margin)||(h["!margins"].header=+xe(o[0]).Margin);break;case"footer":h["!margins"]||La(h["!margins"]={},"xlml"),isNaN(+xe(o[0]).Margin)||(h["!margins"].footer=+xe(o[0]).Margin);break;case"pagemargins":var ee=xe(o[0]);h["!margins"]||La(h["!margins"]={},"xlml"),isNaN(+ee.Top)||(h["!margins"].top=+ee.Top),isNaN(+ee.Left)||(h["!margins"].left=+ee.Left),isNaN(+ee.Right)||(h["!margins"].right=+ee.Right),isNaN(+ee.Bottom)||(h["!margins"].bottom=+ee.Bottom);break;case"displayrighttoleft":ge.Views||(ge.Views=[]),ge.Views[0]||(ge.Views[0]={}),ge.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:ue=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:ue=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:ue=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:ue=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:ue=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:ue=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:ue=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:ue=!1}break;case"smarttags":break;default:ue=!1;break}if(ue||o[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?Q_(B,we,K,n.slice(U,o.index)):(K=o,U=o.index+o[0].length);break}if(t.WTF)throw"Unrecognized tag: "+o[3]+"|"+c.join("|")}var Ce={};return!t.bookSheets&&!t.bookProps&&(Ce.Sheets=f),Ce.SheetNames=d,Ce.Workbook=ge,Ce.SSF=Nt(De),Ce.Props=W,Ce.Custprops=B,Ce.bookType="xlml",Ce}function to(e,r){switch(Ao(r=r||{}),r.type||"base64"){case"base64":return js(Sr(e),r);case"binary":case"buffer":case"file":return js(e,r);case"array":return js(on(e),r)}}function iv(e){var r={},t=e.content;if(t.l=28,r.AnsiUserType=t.read_shift(0,"lpstr-ansi"),r.AnsiClipboardFormat=Cd(t),t.length-t.l<=4)return r;var n=t.read_shift(4);if(n==0||n>40||(t.l-=4,r.Reserved1=t.read_shift(0,"lpstr-ansi"),t.length-t.l<=4)||(n=t.read_shift(4),n!==1907505652)||(r.UnicodeClipboardFormat=Td(t),n=t.read_shift(4),n==0||n>40))return r;t.l-=4,r.Reserved2=t.read_shift(0,"lpwstr")}var sv=[60,1084,2066,2165,2175];function ov(e,r,t,n,a){var i=n,s=[],o=t.slice(t.l,t.l+i);if(a&&a.enc&&a.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(o)}s.push(o),t.l+=i;for(var c=nn(t,t.l),l=ro[c],f=0;l!=null&&sv.indexOf(c)>-1;)i=nn(t,t.l+2),f=t.l+4,c==2066?f+=4:(c==2165||c==2175)&&(f+=12),o=t.slice(f,t.l+4+i),s.push(o),t.l+=4+i,l=ro[c=nn(t,t.l)];var d=mn(s);It(d,0);var h=0;d.lens=[];for(var u=0;u<s.length;++u)d.lens.push(h),h+=s[u].length;if(d.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+d.length+" < "+n;return r.f(d,d.length,a)}function Zr(e,r,t){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,r.cellNF&&e.z==null&&(e.z=De[n])}catch(i){if(r.WTF)throw i}if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||pr[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Ha(e.v):e.w=Ln(e.v):e.w=kr(n,e.v,{date1904:!!t,dateNF:r&&r.dateNF})}catch(i){if(r.WTF)throw i}if(r.cellDates&&n&&e.t=="n"&&Xr(De[n]||String(n))){var a=tn(e.v+(t?1462:0));a&&(e.t="d",e.v=new Date(Date.UTC(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u)))}}}function Hi(e,r,t){return{v:e,ixfe:r,t}}function cv(e,r){var t={opts:{}},n={};Et!=null&&r.dense==null&&(r.dense=Et);var a={};r.dense&&(a["!data"]=[]);var i={},s={},o=null,c=[],l="",f={},d,h="",u,x,g,p,m={},w=[],_,F,N=[],j=[],O={Sheets:[],WBProps:{date1904:!1},Views:[{}]},P={},D=!1,W=function(Re){return Re<8?In[Re]:Re<64&&j[Re-8]||In[Re]},B=function(Re,Fe){var lt=Re.XF.data;if(!(!lt||!lt.patternType||!Fe||!Fe.cellStyles)){Re.s={},Re.s.patternType=lt.patternType;var xt;(xt=Ga(W(lt.icvFore)))&&(Re.s.fgColor={rgb:xt}),(xt=Ga(W(lt.icvBack)))&&(Re.s.bgColor={rgb:xt})}},U=function(Re,Fe,lt){if(!(!D&&J>1)&&!(lt.sheetRows&&Re.r>=lt.sheetRows)){if(lt.cellStyles&&Fe.XF&&Fe.XF.data&&B(Fe,lt),delete Fe.ixfe,delete Fe.XF,d=Re,h=Ye(Re),(!s||!s.s||!s.e)&&(s={s:{r:0,c:0},e:{r:0,c:0}}),Re.r<s.s.r&&(s.s.r=Re.r),Re.c<s.s.c&&(s.s.c=Re.c),Re.r+1>s.e.r&&(s.e.r=Re.r+1),Re.c+1>s.e.c&&(s.e.c=Re.c+1),lt.cellFormula&&Fe.f){for(var xt=0;xt<w.length;++xt)if(!(w[xt][0].s.c>Re.c||w[xt][0].s.r>Re.r)&&!(w[xt][0].e.c<Re.c||w[xt][0].e.r<Re.r)){Fe.F=Xe(w[xt][0]),(w[xt][0].s.c!=Re.c||w[xt][0].s.r!=Re.r)&&delete Fe.f,Fe.f&&(Fe.f=""+Qt(w[xt][1],s,Re,se,K));break}}lt.dense?(a["!data"][Re.r]||(a["!data"][Re.r]=[]),a["!data"][Re.r][Re.c]=Fe):a[h]=Fe}},K={enc:!1,sbcch:0,snames:[],sharedf:m,arrayf:w,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!r&&!!r.cellStyles,WTF:!!r&&!!r.wtf};r.password&&(K.password=r.password);var he,re=[],Ee=[],te=[],ve=[],Te=!1,se=[];se.SheetNames=K.snames,se.sharedf=K.sharedf,se.arrayf=K.arrayf,se.names=[],se.XTI=[];var Pe=0,J=0,ke=0,ge=[],Ue=[],we;K.codepage=1200,Hr(1200);for(var be=!1;e.l<e.length-1;){var b=e.l,I=e.read_shift(2);if(I===0&&Pe===10)break;var R=e.l===e.length?0:e.read_shift(2),A=ro[I];if(J==0&&[9,521,1033,2057].indexOf(I)==-1)break;if(A&&A.f){if(r.bookSheets&&Pe===133&&I!==133)break;if(Pe=I,A.r===2||A.r==12){var q=e.read_shift(2);if(R-=2,!K.enc&&q!==I&&((q&255)<<8|q>>8)!==I)throw new Error("rt mismatch: "+q+"!="+I);A.r==12&&(e.l+=10,R-=10)}var C={};if(I===10?C=A.f(e,R,K):C=ov(I,A,e,R,K),J==0&&[9,521,1033,2057].indexOf(Pe)===-1)continue;switch(I){case 34:t.opts.Date1904=O.WBProps.date1904=C;break;case 134:t.opts.WriteProtect=!0;break;case 47:if(K.enc||(e.l=0),K.enc=C,!r.password)throw new Error("File is password-protected");if(C.valid==null)throw new Error("Encryption scheme unsupported");if(!C.valid)throw new Error("Password is incorrect");break;case 92:K.lastuser=C;break;case 66:var ye=Number(C);switch(ye){case 21010:ye=1200;break;case 32768:ye=1e4;break;case 32769:ye=1252;break}Hr(K.codepage=ye),be=!0;break;case 317:K.rrtabid=C;break;case 25:K.winlocked=C;break;case 439:t.opts.RefreshAll=C;break;case 12:t.opts.CalcCount=C;break;case 16:t.opts.CalcDelta=C;break;case 17:t.opts.CalcIter=C;break;case 13:t.opts.CalcMode=C;break;case 14:t.opts.CalcPrecision=C;break;case 95:t.opts.CalcSaveRecalc=C;break;case 15:K.CalcRefMode=C;break;case 2211:t.opts.FullCalc=C;break;case 129:C.fDialog&&(a["!type"]="dialog"),C.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),C.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 67:case 579:case 1091:case 224:N.push(C);break;case 430:se.push([C]),se[se.length-1].XTI=[];break;case 35:case 547:se[se.length-1].push(C);break;case 24:case 536:we={Name:C.Name,Ref:Qt(C.rgce,s,null,se,K)},C.itab>0&&(we.Sheet=C.itab-1),se.names.push(we),se[0]||(se[0]=[],se[0].XTI=[]),se[se.length-1].push(C),C.Name=="_xlnm._FilterDatabase"&&C.itab>0&&C.rgce&&C.rgce[0]&&C.rgce[0][0]&&C.rgce[0][0][0]=="PtgArea3d"&&(Ue[C.itab-1]={ref:Xe(C.rgce[0][0][1][2])});break;case 22:K.ExternCount=C;break;case 23:se.length==0&&(se[0]=[],se[0].XTI=[]),se[se.length-1].XTI=se[se.length-1].XTI.concat(C),se.XTI=se.XTI.concat(C);break;case 2196:if(K.biff<8)break;we!=null&&(we.Comment=C[1]);break;case 18:a["!protect"]=C;break;case 19:C!==0&&K.WTF&&console.error("Password verifier: "+C);break;case 133:i[K.biff==4?K.snames.length:C.pos]=C,K.snames.push(C.name);break;case 10:{if(--J?!D:D)break;if(s.e){if(s.e.r>0&&s.e.c>0){if(s.e.r--,s.e.c--,a["!ref"]=Xe(s),r.sheetRows&&r.sheetRows<=s.e.r){var ue=s.e.r;s.e.r=r.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=Xe(s),s.e.r=ue}s.e.r++,s.e.c++}re.length>0&&(a["!merges"]=re),Ee.length>0&&(a["!objects"]=Ee),te.length>0&&(a["!cols"]=te),ve.length>0&&(a["!rows"]=ve),O.Sheets.push(P)}l===""?f=a:n[l]=a,a={},r.dense&&(a["!data"]=[])}break;case 9:case 521:case 1033:case 2057:{if(K.biff===8&&(K.biff={9:2,521:3,1033:4}[I]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[C.BIFFVer]||8),K.biffguess=C.BIFFVer==0,C.BIFFVer==0&&C.dt==4096&&(K.biff=5,be=!0,Hr(K.codepage=28591)),K.biff==4&&C.dt&256&&(D=!0),K.biff==8&&C.BIFFVer==0&&C.dt==16&&(K.biff=2),J++&&!D)break;if(a={},r.dense&&(a["!data"]=[]),K.biff<8&&!be&&(be=!0,Hr(K.codepage=r.codepage||1252)),K.biff==4&&D)l=(i[K.snames.indexOf(l)+1]||{name:""}).name;else if(K.biff<5||C.BIFFVer==0&&C.dt==4096){l===""&&(l="Sheet1"),s={s:{r:0,c:0},e:{r:0,c:0}};var ee={pos:e.l-R,name:l};i[ee.pos]=ee,K.snames.push(l)}else l=(i[b]||{name:""}).name;C.dt==32&&(a["!type"]="chart"),C.dt==64&&(a["!type"]="macro"),re=[],Ee=[],K.arrayf=w=[],te=[],ve=[],Te=!1,P={Hidden:(i[b]||{hs:0}).hs,name:l}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(r.dense?(a["!data"][C.r]||[])[C.c]:a[qe(C.c)+at(C.r)])&&++C.c,_={ixfe:C.ixfe,XF:N[C.ixfe]||{},v:C.val,t:"n"},ke>0&&(_.z=_.XF&&_.XF.numFmtId&&ge[_.XF.numFmtId]||ge[_.ixfe>>8&63]),Zr(_,r,t.opts.Date1904),U({c:C.c,r:C.r},_,r);break;case 5:case 517:_={ixfe:C.ixfe,XF:N[C.ixfe],v:C.val,t:C.t},ke>0&&(_.z=_.XF&&_.XF.numFmtId&&ge[_.XF.numFmtId]||ge[_.ixfe>>8&63]),Zr(_,r,t.opts.Date1904),U({c:C.c,r:C.r},_,r);break;case 638:_={ixfe:C.ixfe,XF:N[C.ixfe],v:C.rknum,t:"n"},ke>0&&(_.z=_.XF&&_.XF.numFmtId&&ge[_.XF.numFmtId]||ge[_.ixfe>>8&63]),Zr(_,r,t.opts.Date1904),U({c:C.c,r:C.r},_,r);break;case 189:for(var Ce=C.c;Ce<=C.C;++Ce){var Ne=C.rkrec[Ce-C.c][0];_={ixfe:Ne,XF:N[Ne],v:C.rkrec[Ce-C.c][1],t:"n"},ke>0&&(_.z=_.XF&&_.XF.numFmtId&&ge[_.XF.numFmtId]||ge[_.ixfe>>8&63]),Zr(_,r,t.opts.Date1904),U({c:Ce,r:C.r},_,r)}break;case 6:case 518:case 1030:{if(C.val=="String"){o=C;break}if(_=Hi(C.val,C.cell.ixfe,C.tt),_.XF=N[_.ixfe],r.cellFormula){var de=C.formula;if(de&&de[0]&&de[0][0]&&de[0][0][0]=="PtgExp"){var et=de[0][0][1][0],ct=de[0][0][1][1],_t=Ye({r:et,c:ct});m[_t]?_.f=""+Qt(C.formula,s,C.cell,se,K):_.F=((r.dense?(a["!data"][et]||[])[ct]:a[_t])||{}).F}else _.f=""+Qt(C.formula,s,C.cell,se,K)}ke>0&&(_.z=_.XF&&_.XF.numFmtId&&ge[_.XF.numFmtId]||ge[_.ixfe>>8&63]),Zr(_,r,t.opts.Date1904),U(C.cell,_,r),o=C}break;case 7:case 519:if(o)o.val=C,_=Hi(C,o.cell.ixfe,"s"),_.XF=N[_.ixfe],r.cellFormula&&(_.f=""+Qt(o.formula,s,o.cell,se,K)),ke>0&&(_.z=_.XF&&_.XF.numFmtId&&ge[_.XF.numFmtId]||ge[_.ixfe>>8&63]),Zr(_,r,t.opts.Date1904),U(o.cell,_,r),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{w.push(C);var $t=Ye(C[0].s);if(u=r.dense?(a["!data"][C[0].s.r]||[])[C[0].s.c]:a[$t],r.cellFormula&&u){if(!o||!$t||!u)break;u.f=""+Qt(C[1],s,C[0],se,K),u.F=Xe(C[0])}}break;case 1212:{if(!r.cellFormula)break;if(h){if(!o)break;m[Ye(o.cell)]=C[0],u=r.dense?(a["!data"][o.cell.r]||[])[o.cell.c]:a[Ye(o.cell)],(u||{}).f=""+Qt(C[0],s,d,se,K)}}break;case 253:_=Hi(c[C.isst].t,C.ixfe,"s"),c[C.isst].h&&(_.h=c[C.isst].h),_.XF=N[_.ixfe],ke>0&&(_.z=_.XF&&_.XF.numFmtId&&ge[_.XF.numFmtId]||ge[_.ixfe>>8&63]),Zr(_,r,t.opts.Date1904),U({c:C.c,r:C.r},_,r);break;case 513:r.sheetStubs&&(_={ixfe:C.ixfe,XF:N[C.ixfe],t:"z"},ke>0&&(_.z=_.XF&&_.XF.numFmtId&&ge[_.XF.numFmtId]||ge[_.ixfe>>8&63]),Zr(_,r,t.opts.Date1904),U({c:C.c,r:C.r},_,r));break;case 190:if(r.sheetStubs)for(var oe=C.c;oe<=C.C;++oe){var fe=C.ixfe[oe-C.c];_={ixfe:fe,XF:N[fe],t:"z"},ke>0&&(_.z=_.XF&&_.XF.numFmtId&&ge[_.XF.numFmtId]||ge[_.ixfe>>8&63]),Zr(_,r,t.opts.Date1904),U({c:oe,r:C.r},_,r)}break;case 214:case 516:case 4:_=Hi(C.val,C.ixfe,"s"),_.XF=N[_.ixfe],ke>0&&(_.z=_.XF&&_.XF.numFmtId&&ge[_.XF.numFmtId]||ge[_.ixfe>>8&63]),Zr(_,r,t.opts.Date1904),U({c:C.c,r:C.r},_,r);break;case 0:case 512:J===1&&(s=C);break;case 252:c=C;break;case 1054:if(K.biff>=3&&K.biff<=4){ge[ke++]=C[1];for(var Er=0;Er<ke+163&&De[Er]!=C[1];++Er);Er>=163&&Pn(C[1],ke+163)}else Pn(C[1],C[0]);break;case 30:{ge[ke++]=C;for(var Yt=0;Yt<ke+163&&De[Yt]!=C;++Yt);Yt>=163&&Pn(C,ke+163)}break;case 229:re=re.concat(C);break;case 93:Ee[C.cmo[0]]=K.lastobj=C;break;case 438:K.lastobj.TxO=C;break;case 127:K.lastobj.ImData=C;break;case 440:for(p=C[0].s.r;p<=C[0].e.r;++p)for(g=C[0].s.c;g<=C[0].e.c;++g)u=r.dense?(a["!data"][p]||[])[g]:a[Ye({c:g,r:p})],u&&(u.l=C[1]);break;case 2048:for(p=C[0].s.r;p<=C[0].e.r;++p)for(g=C[0].s.c;g<=C[0].e.c;++g)u=r.dense?(a["!data"][p]||[])[g]:a[Ye({c:g,r:p})],u&&u.l&&(u.l.Tooltip=C[1]);break;case 28:{if(u=r.dense?(a["!data"][C[0].r]||[])[C[0].c]:a[Ye(C[0])],u||(r.dense?(a["!data"][C[0].r]||(a["!data"][C[0].r]=[]),u=a["!data"][C[0].r][C[0].c]={t:"z"}):u=a[Ye(C[0])]={t:"z"},s.e.r=Math.max(s.e.r,C[0].r),s.s.r=Math.min(s.s.r,C[0].r),s.e.c=Math.max(s.e.c,C[0].c),s.s.c=Math.min(s.s.c,C[0].c)),u.c||(u.c=[]),K.biff<=5&&K.biff>=2)x={a:"SheetJ5",t:C[1]};else{var bt=Ee[C[2]];x={a:C[1],t:bt.TxO.t},C[3]!=null&&!(C[3]&2)&&(u.c.hidden=!0)}u.c.push(x)}break;case 2173:Pm(N[C.ixfe],C.ext);break;case 125:{if(!K.cellStyles)break;for(;C.e>=C.s;)te[C.e--]={width:C.w/256,level:C.level||0,hidden:!!(C.flags&1)},Te||(Te=!0,Co(C.w/256)),da(te[C.e+1])}break;case 520:{var ir={};C.level!=null&&(ve[C.r]=ir,ir.level=C.level),C.hidden&&(ve[C.r]=ir,ir.hidden=!0),C.hpt&&(ve[C.r]=ir,ir.hpt=C.hpt,ir.hpx=ja(C.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||La(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[I]]=C;break;case 161:a["!margins"]||La(a["!margins"]={}),a["!margins"].header=C.header,a["!margins"].footer=C.footer;break;case 574:C.RTL&&(O.Views[0].RTL=!0);break;case 146:j=C;break;case 2198:he=C;break;case 140:F=C;break;case 442:l?P.CodeName=C||P.name:O.WBProps.CodeName=C||"ThisWorkbook";break}}else A||console.error("Missing Info for XLS Record 0x"+I.toString(16)),e.l+=R}return t.SheetNames=Pr(i).sort(function(mr,Re){return Number(mr)-Number(Re)}).map(function(mr){return i[mr].name}),r.bookSheets||(t.Sheets=n),!t.SheetNames.length&&f["!ref"]?(t.SheetNames.push("Sheet1"),t.Sheets&&(t.Sheets.Sheet1=f)):t.Preamble=f,t.Sheets&&Ue.forEach(function(mr,Re){t.Sheets[t.SheetNames[Re]]["!autofilter"]=mr}),t.Strings=c,t.SSF=Nt(De),K.enc&&(t.Encryption=K.enc),he&&(t.Themes=he),t.Metadata={},F!==void 0&&(t.Metadata.Country=F),se.names.length>0&&(O.Names=se.names),t.Workbook=O,t}var Cc={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function lv(e,r,t){var n=je.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=oc(n,Od,Cc.DSI);for(var i in a)r[i]=a[i]}catch(l){if(t.WTF)throw l}var s=je.find(e,"/!SummaryInformation");if(s&&s.size>0)try{var o=oc(s,Pd,Cc.SI);for(var c in o)r[c]==null&&(r[c]=o[c])}catch(l){if(t.WTF)throw l}r.HeadingPairs&&r.TitlesOfParts&&(xl(r.HeadingPairs,r.TitlesOfParts,r,t),delete r.HeadingPairs,delete r.TitlesOfParts)}function ql(e,r){r||(r={}),Ao(r),Oc(),r.codepage&&io(r.codepage);var t,n;if(e.FullPaths){if(je.find(e,"/encryption"))throw new Error("File is password-protected");t=je.find(e,"!CompObj"),n=je.find(e,"/Workbook")||je.find(e,"/Book")}else{switch(r.type){case"base64":e=wr(Sr(e));break;case"binary":e=wr(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}It(e,0),n={content:e}}var a,i;if(t&&iv(t),r.bookProps&&!r.bookSheets)a={};else{var s=He?"buffer":"array";if(n&&n.content)a=cv(n.content,r);else if((i=je.find(e,"PerfectOffice_MAIN"))&&i.content)a=Ma.to_workbook(i.content,(r.type=s,r));else if((i=je.find(e,"NativeContent_MAIN"))&&i.content)a=Ma.to_workbook(i.content,(r.type=s,r));else throw(i=je.find(e,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");r.bookVBA&&e.FullPaths&&je.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=Jm(e))}var o={};return e.FullPaths&&lv(e,o,r),a.Props=a.Custprops=o,r.bookFiles&&(a.cfb=e),a}var Qi={0:{f:Xg},1:{f:Yg},2:{f:n_},3:{f:Jg},4:{f:Zg},5:{f:r_},6:{f:s_},7:{f:e_},8:{f:u_},9:{f:f_},10:{f:c_},11:{f:l_},12:{f:Kg},13:{f:a_},14:{f:Qg},15:{f:qg},16:{f:jl},17:{f:o_},18:{f:t_},19:{f:yo},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:L_},40:{},42:{},43:{f:gm},44:{f:xm},45:{f:_m},46:{f:wm},47:{f:vm},48:{},49:{f:_d},50:{},51:{f:Im},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:bl},62:{f:i_},63:{f:Wm},64:{f:w_},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:ar,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:v_},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:$g},148:{f:Gg,p:16},151:{f:p_},152:{},153:{f:M_},154:{},155:{},156:{f:I_},157:{},158:{},159:{T:1,f:Ip},160:{T:-1},161:{T:1,f:Xn},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:h_},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:Nm},336:{T:-1},337:{f:Mm,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Js},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Tl},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:m_},427:{f:x_},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:__},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:jg},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:d_},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Js},551:{f:as},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:Km},633:{T:1},634:{T:-1},635:{T:1,f:Ym},636:{T:-1},637:{f:wd},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:T_},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:y_},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},ro={6:{f:Xs},10:{f:pn},12:{f:wt},13:{f:wt},14:{f:St},15:{f:St},16:{f:tr},17:{f:St},18:{f:St},19:{f:wt},20:{f:fc},21:{f:fc},23:{f:Tl},24:{f:hc},25:{f:St},26:{},27:{},28:{f:Z1},29:{},34:{f:St},35:{f:uc},38:{f:tr},39:{f:tr},40:{f:tr},41:{f:tr},42:{f:St},43:{f:St},47:{f:em},49:{f:A1},51:{f:wt},60:{},61:{f:T1},64:{f:St},65:{f:F1},66:{f:wt},77:{},80:{},81:{},82:{},85:{f:wt},89:{},90:{},91:{},92:{f:_1},93:{f:J1},94:{},95:{f:St},96:{},97:{},99:{f:St},125:{f:bl},128:{f:H1},129:{f:v1},130:{f:wt},131:{f:St},132:{f:St},133:{f:w1},134:{},140:{f:ap},141:{f:wt},144:{},146:{f:sp},151:{},152:{},153:{},154:{},155:{},156:{f:wt},157:{},158:{},160:{f:up},161:{f:cp},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:I1},190:{f:M1},193:{f:pn},197:{},198:{},199:{},200:{},201:{},202:{f:St},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:wt},220:{},221:{f:St},222:{},224:{f:L1},225:{f:g1},226:{f:pn},227:{},229:{f:q1},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:y1},253:{f:D1},255:{f:S1},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:vl},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:St},353:{f:pn},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:G1},431:{f:St},432:{},433:{},434:{},437:{},438:{f:tp},439:{f:St},440:{f:rp},441:{},442:{f:Za},443:{},444:{f:wt},445:{},446:{},448:{f:pn},449:{f:C1,r:2},450:{f:pn},512:{f:lc},513:{f:fp},515:{f:X1},516:{f:R1},517:{f:z1},519:{f:hp},520:{f:k1},523:{},545:{f:pc},549:{f:cc},566:{},574:{f:b1},638:{f:N1},659:{},1048:{},1054:{f:O1},1084:{},1212:{f:$1},2048:{f:np},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Li},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:pn},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:op,r:12},2173:{f:Om,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:St,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:j1,r:12},2197:{},2198:{f:Tm,r:12},2199:{},2200:{},2201:{},2202:{f:Y1,r:12},2203:{f:pn},2204:{},2205:{},2206:{},2207:{},2211:{f:E1},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:wt},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:lp},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:ip},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:lc},1:{},2:{f:xp},3:{f:mp},4:{f:pp},5:{f:_p},7:{f:gp},8:{},9:{f:Li},11:{},22:{f:wt},30:{f:P1},31:{},32:{},33:{f:pc},36:{},37:{f:cc},50:{f:vp},62:{},52:{},67:{f:U1},68:{f:wt},69:{},86:{},126:{},127:{f:dp},135:{},136:{},137:{},143:{f:yp},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:wp},223:{},234:{},354:{},421:{},518:{f:Xs},521:{f:Li},536:{f:hc},547:{f:uc},561:{},579:{f:W1},1030:{f:Xs},1033:{f:Li},1091:{f:V1},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},101:{},102:{},105:{},106:{},107:{},109:{},112:{},114:{},29282:{}};function vr(e,r,t,n){var a=r;if(!isNaN(a)){var i=n||(t||[]).length||0,s=e.next(4);s.write_shift(2,a),s.write_shift(2,i),i>0&&cl(t)&&e.push(t)}}function Tc(e,r){var t=r||{},n=t.dense!=null?t.dense:Et,a={};n&&(a["!data"]=[]),e=Ka(e,"<!--","-->");var i=e.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var s=e.match(/<\/table/i),o=i.index,c=s&&s.index||e.length,l=Mh(e.slice(o,c),/(:?<tr[^<>]*>)/i,"<tr>"),f=-1,d=0,h=0,u=0,x={s:{r:1e7,c:1e7},e:{r:0,c:0}},g=[];for(o=0;o<l.length;++o){var p=l[o].trim(),m=p.slice(0,3).toLowerCase();if(m=="<tr"){if(++f,t.sheetRows&&t.sheetRows<=f){--f;break}d=0;continue}if(!(m!="<td"&&m!="<th")){var w=p.split(/<\/t[dh]>/i);for(c=0;c<w.length;++c){var _=w[c].trim();if(_.match(/<t[dh]/i)){for(var F=_,N=0;F.charAt(0)=="<"&&(N=F.indexOf(">"))>-1;)F=F.slice(N+1);for(var j=0;j<g.length;++j){var O=g[j];O.s.c==d&&O.s.r<f&&f<=O.e.r&&(d=O.e.c+1,j=-1)}var P=xe(_.slice(0,_.indexOf(">")));u=P.colspan?+P.colspan:1,((h=+P.rowspan)>1||u>1)&&g.push({s:{r:f,c:d},e:{r:f+(h||1)-1,c:d+u-1}});var D=P.t||P["data-t"]||"";if(!F.length){d+=u;continue}if(F=el(F),x.s.r>f&&(x.s.r=f),x.e.r<f&&(x.e.r=f),x.s.c>d&&(x.s.c=d),x.e.c<d&&(x.e.c=d),!F.length){d+=u;continue}var W={t:"s",v:F};t.raw||!F.trim().length||D=="s"||(F==="TRUE"?W={t:"b",v:!0}:F==="FALSE"?W={t:"b",v:!1}:isNaN(yr(F))?isNaN(za(F).getDate())?F.charCodeAt(0)==35&&zt[F]!=null&&(W.t="e",W.w=F,W.v=zt[F]):(W={t:"d",v:Gt(F)},t.UTC===!1&&(W.v=Wn(W.v)),t.cellDates||(W={t:"n",v:Mt(W.v)}),W.z=t.dateNF||De[14]):W={t:"n",v:yr(F)}),W.cellText!==!1&&(W.w=F),n?(a["!data"][f]||(a["!data"][f]=[]),a["!data"][f][d]=W):a[Ye({r:f,c:d})]=W,d+=u}}}}return a["!ref"]=Xe(x),g.length&&(a["!merges"]=g),a}function fv(e,r,t,n){for(var a=e["!merges"]||[],i=[],s={},o=e["!data"]!=null,c=r.s.c;c<=r.e.c;++c){for(var l=0,f=0,d=0;d<a.length;++d)if(!(a[d].s.r>t||a[d].s.c>c)&&!(a[d].e.r<t||a[d].e.c<c)){if(a[d].s.r<t||a[d].s.c<c){l=-1;break}l=a[d].e.r-a[d].s.r+1,f=a[d].e.c-a[d].s.c+1;break}if(!(l<0)){var h=qe(c)+at(t),u=o?(e["!data"][t]||[])[c]:e[h];u&&u.t=="n"&&u.v!=null&&!isFinite(u.v)&&(isNaN(u.v)?u={t:"e",v:36,w:pr[36]}:u={t:"e",v:7,w:pr[7]});var x=u&&u.v!=null&&(u.h||Da(u.w||(vn(u),u.w)||""))||"";s={},l>1&&(s.rowspan=l),f>1&&(s.colspan=f),n.editable?x='<span contenteditable="true">'+x+"</span>":u&&(s["data-t"]=u&&u.t||"z",u.v!=null&&(s["data-v"]=Da(u.v instanceof Date?u.v.toISOString():u.v)),u.z!=null&&(s["data-z"]=u.z),u.l&&(u.l.Target||"#").charAt(0)!="#"&&(x='<a href="'+Da(u.l.Target)+'">'+x+"</a>")),s.id=(n.id||"sjs")+"-"+h,i.push(Qh("td",x,s))}}var g="<tr>";return g+i.join("")+"</tr>"}var uv='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',hv="</body></html>";function dv(e,r){var t=Uh(e,"table");if(!t||t.length==0)throw new Error("Invalid HTML: could not find <table>");if(t.length==1){var n=Sn(Tc(t[0],r),r);return n.bookType="html",n}var a=Ro();return t.forEach(function(i,s){ei(a,Tc(i,r),"Sheet"+(s+1))}),a.bookType="html",a}function pv(e,r,t){var n=[];return n.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function mv(e,r){var t=r||{},n=t.header!=null?t.header:uv,a=t.footer!=null?t.footer:hv,i=[n],s=Hn(e["!ref"]||"A1");if(i.push(pv(e,s,t)),e["!ref"])for(var o=s.s.r;o<=s.e.r;++o)i.push(fv(e,s,o,t));return i.push("</table>"+a),i.join("")}function Jl(e,r,t){var n=r.rows;if(!n)throw"Unsupported origin when "+r.tagName+" is not a TABLE";var a=t||{},i=e["!data"]!=null,s=0,o=0;if(a.origin!=null)if(typeof a.origin=="number")s=a.origin;else{var c=typeof a.origin=="string"?rr(a.origin):a.origin;s=c.r,o=c.c}var l=Math.min(a.sheetRows||1e7,n.length),f={s:{r:0,c:0},e:{r:s,c:o}};if(e["!ref"]){var d=Hn(e["!ref"]);f.s.r=Math.min(f.s.r,d.s.r),f.s.c=Math.min(f.s.c,d.s.c),f.e.r=Math.max(f.e.r,d.e.r),f.e.c=Math.max(f.e.c,d.e.c),s==-1&&(f.e.r=s=d.e.r+1)}var h=[],u=0,x=e["!rows"]||(e["!rows"]=[]),g=0,p=0,m=0,w=0,_=0,F=0;for(e["!cols"]||(e["!cols"]=[]);g<n.length&&p<l;++g){var N=n[g];if(bc(N)){if(a.display)continue;x[p]={hidden:!0}}var j=N.cells;for(m=w=0;m<j.length;++m){var O=j[m];if(!(a.display&&bc(O))){var P=O.hasAttribute("data-v")?O.getAttribute("data-v"):O.hasAttribute("v")?O.getAttribute("v"):el(O.innerHTML),D=O.getAttribute("data-z")||O.getAttribute("z");for(u=0;u<h.length;++u){var W=h[u];W.s.c==w+o&&W.s.r<p+s&&p+s<=W.e.r&&(w=W.e.c+1-o,u=-1)}F=+O.getAttribute("colspan")||1,((_=+O.getAttribute("rowspan")||1)>1||F>1)&&h.push({s:{r:p+s,c:w+o},e:{r:p+s+(_||1)-1,c:w+o+(F||1)-1}});var B={t:"s",v:P},U=O.getAttribute("data-t")||O.getAttribute("t")||"";P!=null&&(P.length==0?B.t=U||"z":a.raw||P.trim().length==0||U=="s"||(U=="e"&&pr[+P]?B={t:"e",v:+P,w:pr[+P]}:P==="TRUE"?B={t:"b",v:!0}:P==="FALSE"?B={t:"b",v:!1}:isNaN(yr(P))?isNaN(za(P).getDate())?P.charCodeAt(0)==35&&zt[P]!=null&&(B={t:"e",v:zt[P],w:P}):(B={t:"d",v:Gt(P)},a.UTC&&(B.v=ts(B.v)),a.cellDates||(B={t:"n",v:Mt(B.v)}),B.z=a.dateNF||De[14]):B={t:"n",v:yr(P)})),B.z===void 0&&D!=null&&(B.z=D);var K="",he=O.getElementsByTagName("A");if(he&&he.length)for(var re=0;re<he.length&&!(he[re].hasAttribute("href")&&(K=he[re].getAttribute("href"),K.charAt(0)!="#"));++re);K&&K.charAt(0)!="#"&&K.slice(0,11).toLowerCase()!="javascript:"&&(B.l={Target:K}),i?(e["!data"][p+s]||(e["!data"][p+s]=[]),e["!data"][p+s][w+o]=B):e[Ye({c:w+o,r:p+s})]=B,f.e.c<w+o&&(f.e.c=w+o),w+=F}}++p}return h.length&&(e["!merges"]=(e["!merges"]||[]).concat(h)),f.e.r=Math.max(f.e.r,p-1+s),e["!ref"]=Xe(f),p>=l&&(e["!fullref"]=Xe((f.e.r=n.length-g+p-1+s,f))),e}function Ql(e,r){var t=r||{},n={};return t.dense&&(n["!data"]=[]),Jl(n,e,r)}function xv(e,r){var t=Sn(Ql(e,r),r);return t}function bc(e){var r="",t=gv(e);return t&&(r=t(e).getPropertyValue("display")),r||(r=e.style&&e.style.display),r==="none"}function gv(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function _v(e){var r=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^<>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),t=ze(r.replace(/<[^<>]*>/g,""));return[t]}function ef(e,r,t){var n=t||{},a=rs(e);Pt.lastIndex=0,a=fo(Ka(a,"<!--","-->"));for(var i,s,o="",c="",l,f=0,d=-1,h=!1,u="";i=Pt.exec(a);)switch(i[3]=i[3].replace(/_[\s\S]*$/,"")){case"number-style":case"currency-style":case"percentage-style":case"date-style":case"time-style":case"text-style":i[1]==="/"?(h=!1,s["truncate-on-overflow"]=="false"&&(o.match(/h/)?o=o.replace(/h+/,"[$&]"):o.match(/m/)?o=o.replace(/m+/,"[$&]"):o.match(/s/)&&(o=o.replace(/s+/,"[$&]"))),n[s.name]=o,o=""):i[0].charAt(i[0].length-2)!=="/"&&(h=!0,o="",s=xe(i[0],!1));break;case"boolean-style":i[1]==="/"?(h=!1,n[s.name]="General",o=""):i[0].charAt(i[0].length-2)!=="/"&&(h=!0,o="",s=xe(i[0],!1));break;case"boolean":o+="General";break;case"text":i[1]==="/"?(u=a.slice(d,Pt.lastIndex-i[0].length),u=="%"&&s[0]=="<number:percentage-style"?o+="%":o+='"'+u.replace(/"/g,'""')+'"'):i[0].charAt(i[0].length-2)!=="/"&&(d=Pt.lastIndex);break;case"day":switch(l=xe(i[0],!1),l.style){case"short":o+="d";break;case"long":o+="dd";break;default:o+="dd";break}break;case"day-of-week":switch(l=xe(i[0],!1),l.style){case"short":o+="ddd";break;case"long":o+="dddd";break;default:o+="ddd";break}break;case"era":switch(l=xe(i[0],!1),l.style){case"short":o+="ee";break;case"long":o+="eeee";break;default:o+="eeee";break}break;case"hours":switch(l=xe(i[0],!1),l.style){case"short":o+="h";break;case"long":o+="hh";break;default:o+="hh";break}break;case"minutes":switch(l=xe(i[0],!1),l.style){case"short":o+="m";break;case"long":o+="mm";break;default:o+="mm";break}break;case"month":switch(l=xe(i[0],!1),l.textual&&(o+="mm"),l.style){case"short":o+="m";break;case"long":o+="mm";break;default:o+="m";break}break;case"seconds":{switch(l=xe(i[0],!1),l.style){case"short":o+="s";break;case"long":o+="ss";break;default:o+="ss";break}l["decimal-places"]&&(o+="."+Ge("0",+l["decimal-places"]))}break;case"year":switch(l=xe(i[0],!1),l.style){case"short":o+="yy";break;case"long":o+="yyyy";break;default:o+="yy";break}break;case"am-pm":o+="AM/PM";break;case"week-of-year":case"quarter":console.error("Excel does not support ODS format token "+i[3]);break;case"fill-character":i[1]==="/"?(u=a.slice(d,Pt.lastIndex-i[0].length),o+='"'+u.replace(/"/g,'""')+'"*'):i[0].charAt(i[0].length-2)!=="/"&&(d=Pt.lastIndex);break;case"scientific-number":l=xe(i[0],!1),o+="0."+Ge("0",+l["min-decimal-places"]||+l["decimal-places"]||2)+Ge("?",+l["decimal-places"]-+l["min-decimal-places"]||0)+"E"+(nt(l["forced-exponent-sign"])?"+":"")+Ge("0",+l["min-exponent-digits"]||2);break;case"fraction":l=xe(i[0],!1),+l["min-integer-digits"]?o+=Ge("0",+l["min-integer-digits"]):o+="#",o+=" ",o+=Ge("?",+l["min-numerator-digits"]||1),o+="/",+l["denominator-value"]?o+=l["denominator-value"]:o+=Ge("?",+l["min-denominator-digits"]||1);break;case"currency-symbol":i[1]==="/"?o+='"'+a.slice(d,Pt.lastIndex-i[0].length).replace(/"/g,'""')+'"':i[0].charAt(i[0].length-2)!=="/"?d=Pt.lastIndex:o+="$";break;case"text-properties":switch(l=xe(i[0],!1),(l.color||"").toLowerCase().replace("#","")){case"ff0000":case"red":o="[Red]"+o;break}break;case"text-content":o+="@";break;case"map":l=xe(i[0],!1),ze(l.condition)=="value()>=0"?o=n[l["apply-style-name"]]+";"+o:console.error("ODS number format may be incorrect: "+l.condition);break;case"number":if(i[1]==="/")break;l=xe(i[0],!1),c="",c+=Ge("0",+l["min-integer-digits"]||1),nt(l.grouping)&&(c=rn(Ge("#",Math.max(0,4-c.length))+c)),(+l["min-decimal-places"]||+l["decimal-places"])&&(c+="."),+l["min-decimal-places"]&&(c+=Ge("0",+l["min-decimal-places"]||1)),+l["decimal-places"]-(+l["min-decimal-places"]||0)&&(c+=Ge("0",+l["decimal-places"]-(+l["min-decimal-places"]||0))),o+=c;break;case"embedded-text":i[1]==="/"?f==0?o+='"'+a.slice(d,Pt.lastIndex-i[0].length).replace(/"/g,'""')+'"':o=o.slice(0,f)+'"'+a.slice(d,Pt.lastIndex-i[0].length).replace(/"/g,'""')+'"'+o.slice(f):i[0].charAt(i[0].length-2)!=="/"&&(d=Pt.lastIndex,f=-+xe(i[0],!1).position||0);break}return n}function tf(e,r,t){var n=r||{};Et!=null&&n.dense==null&&(n.dense=Et);var a=rs(e),i=[],s,o,c,l="",f=0,d,h,u={},x=[],g={};n.dense&&(g["!data"]=[]);var p,m,w={value:""},_={},F="",N=0,j,O="",P=0,D=[],W=[],B=-1,U=-1,K={s:{r:1e6,c:1e7},e:{r:0,c:0}},he=0,re=t||{},Ee={},te=[],ve={},Te=0,se=0,Pe=[],J=1,ke=1,ge=[],Ue={Names:[],WBProps:{}},we={},be=["",""],b=[],I={},R="",A=0,q=!1,C=!1,ye=0;for(Pt.lastIndex=0,a=fo(Ka(a,"<!--","-->"));p=Pt.exec(a);)switch(p[3]=p[3].replace(/_[\s\S]*$/,"")){case"table":case"\u5DE5\u4F5C\u8868":p[1]==="/"?(K.e.c>=K.s.c&&K.e.r>=K.s.r?g["!ref"]=Xe(K):g["!ref"]="A1:A1",n.sheetRows>0&&n.sheetRows<=K.e.r&&(g["!fullref"]=g["!ref"],K.e.r=n.sheetRows-1,g["!ref"]=Xe(K)),te.length&&(g["!merges"]=te),Pe.length&&(g["!rows"]=Pe),d.name=d.\u540D\u79F0||d.name,typeof JSON<"u"&&JSON.stringify(d),x.push(d.name),u[d.name]=g,C=!1):p[0].charAt(p[0].length-2)!=="/"&&(d=xe(p[0],!1),B=U=-1,K.s.r=K.s.c=1e7,K.e.r=K.e.c=0,g={},n.dense&&(g["!data"]=[]),te=[],Pe=[],C=!0);break;case"table-row-group":p[1]==="/"?--he:++he;break;case"table-row":case"\u884C":if(p[1]==="/"){B+=J,J=1;break}if(h=xe(p[0],!1),h.\u884C\u53F7?B=h.\u884C\u53F7-1:B==-1&&(B=0),J=+h["number-rows-repeated"]||1,J<10)for(ye=0;ye<J;++ye)he>0&&(Pe[B+ye]={level:he});U=-1;break;case"covered-table-cell":if(p[1]!=="/")if(++U,w=xe(p[0],!1),ke=parseInt(w["number-columns-repeated"]||"1",10)||1,n.sheetStubs){for(;ke-- >0;)n.dense?(g["!data"][B]||(g["!data"][B]=[]),g["!data"][B][U]={t:"z"}):g[Ye({r:B,c:U})]={t:"z"},++U;--U}else U+=ke-1;F="",D=[];break;case"table-cell":case"\u6570\u636E":if(p[0].charAt(p[0].length-2)==="/")++U,w=xe(p[0],!1),ke=parseInt(w["number-columns-repeated"]||"1",10)||1,m={t:"z",v:null},w.formula&&n.cellFormula!=!1&&(m.f=Sc(ze(w.formula))),w["style-name"]&&Ee[w["style-name"]]&&(m.z=Ee[w["style-name"]]),(w.\u6570\u636E\u7C7B\u578B||w["value-type"])=="string"&&(m.t="s",m.v=ze(w["string-value"]||""),n.dense?(g["!data"][B]||(g["!data"][B]=[]),g["!data"][B][U]=m):g[qe(U)+at(B)]=m),U+=ke-1;else if(p[1]!=="/"){++U,F=O="",N=P=0,D=[],W=[],ke=1;var ue=J?B+J-1:B;if(U>K.e.c&&(K.e.c=U),U<K.s.c&&(K.s.c=U),B<K.s.r&&(K.s.r=B),ue>K.e.r&&(K.e.r=ue),w=xe(p[0],!1),_=Gh(p[0],!0),b=[],I={},m={t:w.\u6570\u636E\u7C7B\u578B||w["value-type"],v:null},w["style-name"]&&Ee[w["style-name"]]&&(m.z=Ee[w["style-name"]]),n.cellFormula)if(w.formula&&(w.formula=ze(w.formula)),w["number-matrix-columns-spanned"]&&w["number-matrix-rows-spanned"]&&(Te=parseInt(w["number-matrix-rows-spanned"],10)||0,se=parseInt(w["number-matrix-columns-spanned"],10)||0,ve={s:{r:B,c:U},e:{r:B+Te-1,c:U+se-1}},m.F=Xe(ve),ge.push([ve,m.F])),w.formula)m.f=Sc(w.formula);else for(ye=0;ye<ge.length;++ye)B>=ge[ye][0].s.r&&B<=ge[ye][0].e.r&&U>=ge[ye][0].s.c&&U<=ge[ye][0].e.c&&(m.F=ge[ye][1]);switch((w["number-columns-spanned"]||w["number-rows-spanned"])&&(Te=parseInt(w["number-rows-spanned"]||"1",10)||1,se=parseInt(w["number-columns-spanned"]||"1",10)||1,Te*se>1&&(ve={s:{r:B,c:U},e:{r:B+Te-1,c:U+se-1}},te.push(ve))),w["number-columns-repeated"]&&(ke=parseInt(w["number-columns-repeated"],10)),m.t){case"boolean":m.t="b",m.v=nt(w["boolean-value"])||+w["boolean-value"]>=1;break;case"float":m.t="n",m.v=parseFloat(w.value),n.cellDates&&m.z&&Xr(m.z)&&(m.v=gn(m.v+(Ue.WBProps.date1904?1462:0)),m.t=typeof m.v=="number"?"n":"d");break;case"percentage":m.t="n",m.v=parseFloat(w.value);break;case"currency":m.t="n",m.v=parseFloat(w.value);break;case"date":m.t="d",m.v=Gt(w["date-value"],Ue.WBProps.date1904),n.cellDates||(m.t="n",m.v=Mt(m.v,Ue.WBProps.date1904)),m.z||(m.z="m/d/yy");break;case"time":m.t="n",m.v=Th(w["time-value"])/86400,n.cellDates&&(m.v=gn(m.v),m.t=typeof m.v=="number"?"n":"d"),m.z||(m.z="HH:MM:SS");break;case"number":m.t="n",m.v=parseFloat(w.\u6570\u636E\u6570\u503C);break;default:if(m.t==="string"||m.t==="text"||!m.t)m.t="s",w["string-value"]!=null&&(F=ze(w["string-value"]),D=[]);else throw new Error("Unsupported value type "+m.t)}}else{if(q=!1,_["calcext:value-type"]=="error"&&zt[F]!=null&&(m.t="e",m.w=F,m.v=zt[F]),m.t==="s"&&(m.v=F||"",D.length&&(m.R=D),q=N==0),we.Target&&(m.l=we),b.length>0&&(m.c=b,b=[]),F&&n.cellText!==!1&&(m.w=F),q&&(m.t="z",delete m.v),(!q||n.sheetStubs)&&!(n.sheetRows&&n.sheetRows<=B))for(var ee=0;ee<J;++ee){if(ke=parseInt(w["number-columns-repeated"]||"1",10),n.dense)for(g["!data"][B+ee]||(g["!data"][B+ee]=[]),g["!data"][B+ee][U]=ee==0?m:Nt(m);--ke>0;)g["!data"][B+ee][U+ke]=Nt(m);else for(g[Ye({r:B+ee,c:U})]=m;--ke>0;)g[Ye({r:B+ee,c:U+ke})]=Nt(m);K.e.c<=U&&(K.e.c=U)}ke=parseInt(w["number-columns-repeated"]||"1",10),U+=ke-1,ke=0,m={},F="",D=[]}we={};break;case"document":case"document-content":case"\u7535\u5B50\u8868\u683C\u6587\u6863":case"spreadsheet":case"\u4E3B\u4F53":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(p[1]==="/"){if((s=i.pop())[0]!==p[3])throw"Bad state: "+s}else p[0].charAt(p[0].length-2)!=="/"&&i.push([p[3],!0]);break;case"annotation":if(p[1]==="/"){if((s=i.pop())[0]!==p[3])throw"Bad state: "+s;I.t=F,D.length&&(I.R=D),I.a=R,b.push(I),F=O,N=P,D=W}else if(p[0].charAt(p[0].length-2)!=="/"){i.push([p[3],!1]);var Ce=xe(p[0],!0);Ce.display&&nt(Ce.display)||(b.hidden=!0),O=F,P=N,W=D,F="",N=0,D=[]}R="",A=0;break;case"creator":p[1]==="/"?R=a.slice(A,p.index):A=p.index+p[0].length;break;case"meta":case"\u5143\u6570\u636E":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(p[1]==="/"){if((s=i.pop())[0]!==p[3])throw"Bad state: "+s}else p[0].charAt(p[0].length-2)!=="/"&&i.push([p[3],!1]);F="",N=0,D=[];break;case"scientific-number":case"currency-symbol":case"fill-character":break;case"text-style":case"boolean-style":case"number-style":case"currency-style":case"percentage-style":case"date-style":case"time-style":if(p[1]==="/"){var Ne=Pt.lastIndex;ef(a.slice(c,Pt.lastIndex),r,re),Pt.lastIndex=Ne}else p[0].charAt(p[0].length-2)!=="/"&&(c=Pt.lastIndex-p[0].length);break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":{var de=xe(p[0],!1);de.family=="table-cell"&&re[de["data-style-name"]]&&(Ee[de.name]=re[de["data-style-name"]])}break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":break;case"boolean":break;case"text":if(p[0].slice(-2)==="/>")break;if(p[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":l+=a.slice(f,p.index);break}else f=p.index+p[0].length;break;case"named-range":o=xe(p[0],!1),be=Gs(o["cell-range-address"]);var et={Name:o.name,Ref:be[0]+"!"+be[1]};C&&(et.Sheet=x.length),Ue.Names.push(et);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"\u7535\u5B50\u8868\u683C":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":switch(o=xe(p[0],!1),o["date-value"]){case"1904-01-01":Ue.WBProps.date1904=!0;break}break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"\u6587\u672C\u4E32":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(p[1]==="/"&&(!w||!w["string-value"])){var ct=_v(a.slice(N,p.index),j);F=(F.length>0?F+`
`:"")+ct[0]}else p[0].slice(-2)=="/>"?F+=`
`:(j=xe(p[0],!1),N=p.index+p[0].length);break;case"s":break;case"database-range":if(p[1]==="/")break;try{be=Gs(xe(p[0])["target-range-address"]),u[be[0]]["!autofilter"]={ref:be[1]}}catch{}break;case"date":break;case"object":break;case"title":case"\u6807\u9898":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"filter-set-item":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(p[1]!=="/"){if(we=xe(p[0],!1),!we.href)break;we.Target=ze(we.href),delete we.href,we.Target.charAt(0)=="#"&&we.Target.indexOf(".")>-1?(be=Gs(we.Target.slice(1)),we.Target="#"+be[0]+"!"+be[1]):we.Target.match(/^\.\.[\\\/]/)&&(we.Target=we.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(p[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"\u8868:":case"\u5B57:":break;default:if(n.WTF)throw new Error(p)}}var _t={Sheets:u,SheetNames:x,Workbook:Ue};return n.bookSheets&&delete _t.Sheets,_t}function Fc(e,r){r=r||{},Or(e,"META-INF/manifest.xml")&&Wd(Ot(e,"META-INF/manifest.xml"),r);var t=cr(e,"styles.xml"),n=t&&ef(ft(t),r),a=cr(e,"content.xml");if(!a)throw new Error("Missing content.xml in ODS / UOF file");var i=tf(ft(a),r,n);return Or(e,"meta.xml")&&(i.Props=ml(Ot(e,"meta.xml"))),i.bookType="ods",i}function Ac(e,r){var t=tf(e,r);return t.bookType="fods",t}var Xt=(function(){try{return typeof Uint8Array>"u"||typeof Uint8Array.prototype.subarray>"u"?"slice":typeof Buffer<"u"?typeof Buffer.prototype.subarray>"u"?"slice":(typeof Buffer.from=="function"?Buffer.from([72,62]):new Buffer([72,62]))instanceof Uint8Array?"subarray":"slice":"subarray"}catch{return"slice"}})();function $a(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function fa(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):ft(on(e))}function rf(e){for(var r=0,t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),a=0;for(t=0;t<e.length;++t){var i=e[t],s=i.length;if(s<250)for(var o=0;o<s;++o)n[a++]=i[o];else n.set(i,a),a+=s}return n}function Wa(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function vv(e,r){for(var t=(e[r+15]&127)<<7|e[r+14]>>1,n=e[r+14]&1,a=r+13;a>=r;--a)n=n*256+e[a];return(e[r+15]&128?-n:n)*Math.pow(10,t-6176)}function es(e,r){var t=r.l,n=e[t]&127;e:if(e[t++]>=128&&(n|=(e[t]&127)<<7,e[t++]<128||(n|=(e[t]&127)<<14,e[t++]<128)||(n|=(e[t]&127)<<21,e[t++]<128)||(n+=(e[t]&127)*Math.pow(2,28),++t,e[t++]<128)||(n+=(e[t]&127)*Math.pow(2,35),++t,e[t++]<128)||(n+=(e[t]&127)*Math.pow(2,42),++t,e[t++]<128)))break e;return r.l=t,n}function $e(e){var r=0,t=e[r]&127;return e[r++]<128||(t|=(e[r]&127)<<7,e[r++]<128)||(t|=(e[r]&127)<<14,e[r++]<128)||(t|=(e[r]&127)<<21,e[r++]<128)||(t|=(e[r]&15)<<28),t}function Be(e){for(var r=[],t={l:0};t.l<e.length;){var n=t.l,a=es(e,t),i=a&7;a=a/8|0;var s,o=t.l;switch(i){case 0:{for(;e[o++]>=128;);s=e[Xt](t.l,o),t.l=o}break;case 1:s=e[Xt](o,o+8),t.l=o+8;break;case 2:{var c=es(e,t);s=e[Xt](t.l,t.l+c),t.l+=c}break;case 5:s=e[Xt](o,o+4),t.l=o+4;break;default:throw new Error("PB Type ".concat(i," for Field ").concat(a," at offset ").concat(n))}var l={data:s,type:i};r[a]==null&&(r[a]=[]),r[a].push(l)}return r}function ls(e,r){return e?.map(function(t){return r(t.data)})||[]}function wv(e){for(var r,t=[],n={l:0};n.l<e.length;){var a=es(e,n),i=Be(e[Xt](n.l,n.l+a));n.l+=a;var s={id:$e(i[1][0].data),messages:[]};i[2].forEach(function(o){var c=Be(o.data),l=$e(c[3][0].data);s.messages.push({meta:c,data:e[Xt](n.l,n.l+l)}),n.l+=l}),(r=i[3])!=null&&r[0]&&(s.merge=$e(i[3][0].data)>>>0>0),t.push(s)}return t}function yv(e,r){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var t={l:0},n=es(r,t),a=[],i=t.l;i<r.length;){var s=r[i]&3;if(s==0){var o=r[i++]>>2;if(o<60)++o;else{var c=o-59;o=r[i],c>1&&(o|=r[i+1]<<8),c>2&&(o|=r[i+2]<<16),c>3&&(o|=r[i+3]<<24),o>>>=0,o++,i+=c}a.push(r[Xt](i,i+o)),i+=o;continue}else{var l=0,f=0;if(s==1?(f=(r[i]>>2&7)+4,l=(r[i++]&224)<<3,l|=r[i++]):(f=(r[i++]>>2)+1,s==2?(l=r[i]|r[i+1]<<8,i+=2):(l=(r[i]|r[i+1]<<8|r[i+2]<<16|r[i+3]<<24)>>>0,i+=4)),l==0)throw new Error("Invalid offset 0");for(var d=a.length-1,h=l;d>=0&&h>=a[d].length;)h-=a[d].length,--d;if(d<0)if(h==0)h=a[d=0].length;else throw new Error("Invalid offset beyond length");if(f<h)a.push(a[d][Xt](a[d].length-h,a[d].length-h+f));else{for(h>0&&(a.push(a[d][Xt](a[d].length-h)),f-=h),++d;f>=a[d].length;)a.push(a[d]),f-=a[d].length,++d;f&&a.push(a[d][Xt](0,f))}a.length>25&&(a=[rf(a)])}}for(var u=0,x=0;x<a.length;++x)u+=a[x].length;if(u!=n)throw new Error("Unexpected length: ".concat(u," != ").concat(n));return a}function Sv(e){Array.isArray(e)&&(e=new Uint8Array(e));for(var r=[],t=0;t<e.length;){var n=e[t++],a=e[t]|e[t+1]<<8|e[t+2]<<16;t+=3,r.push.apply(r,yv(n,e[Xt](t,t+a))),t+=a}if(t!==e.length)throw new Error("data is not a valid framed stream!");return r.length==1?r[0]:rf(r)}var kv=function(){return{sst:[],rsst:[],ofmt:[],nfmt:[],fmla:[],ferr:[],cmnt:[]}};function nf(e,r,t,n,a){var i,s,o,c,l=r&255,f=r>>8,d=f>=5?a:n;e:if(t&(f>4?8:4)&&e.t=="n"&&l==7){var h=(i=d[7])!=null&&i[0]?$e(d[7][0].data):-1;if(h==-1)break e;var u=(s=d[15])!=null&&s[0]?$e(d[15][0].data):-1,x=(o=d[16])!=null&&o[0]?$e(d[16][0].data):-1,g=(c=d[40])!=null&&c[0]?$e(d[40][0].data):-1,p=e.v,m=p;t:if(g){if(p==0){u=x=2;break t}p>=604800?u=1:p>=86400?u=2:p>=3600?u=4:p>=60?u=8:p>=1?u=16:u=32,Math.floor(p)!=p?x=32:p%60?x=16:p%3600?x=8:p%86400?x=4:p%604800&&(x=2),x<u&&(x=u)}if(u==-1||x==-1)break e;var w=[],_=[];u==1&&(m=p/604800,x==1?_.push('d"d"'):(m|=0,p-=604800*m),w.push(m+(h==2?" week"+(m==1?"":"s"):h==1?"w":""))),u<=2&&x>=2&&(m=p/86400,x>2&&(m|=0,p-=86400*m),_.push('d"d"'),w.push(m+(h==2?" day"+(m==1?"":"s"):h==1?"d":""))),u<=4&&x>=4&&(m=p/3600,x>4&&(m|=0,p-=3600*m),_.push((u>=4?"[h]":"h")+'"h"'),w.push(m+(h==2?" hour"+(m==1?"":"s"):h==1?"h":""))),u<=8&&x>=8&&(m=p/60,x>8&&(m|=0,p-=60*m),_.push((u>=8?"[m]":"m")+'"m"'),h==0?w.push((u==8&&x==8||m>=10?"":"0")+m):w.push(m+(h==2?" minute"+(m==1?"":"s"):h==1?"m":""))),u<=16&&x>=16&&(m=p,x>16&&(m|=0,p-=m),_.push((u>=16?"[s]":"s")+'"s"'),h==0?w.push((x==16&&u==16||m>=10?"":"0")+m):w.push(m+(h==2?" second"+(m==1?"":"s"):h==1?"s":""))),x>=32&&(m=Math.round(1e3*p),u<32&&_.push('.000"ms"'),h==0?w.push((m>=100?"":m>=10?"0":"00")+m):w.push(m+(h==2?" millisecond"+(m==1?"":"s"):h==1?"ms":""))),e.w=w.join(h==0?":":" "),e.z=_.join(h==0?'":"':" "),h==0&&(e.w=e.w.replace(/:(\d\d\d)$/,".$1"))}}function Ev(e,r,t,n){var a=$a(e),i=a.getUint32(4,!0),s=-1,o=-1,c=-1,l=NaN,f=0,d=new Date(Date.UTC(2001,0,1)),h=t>1?12:8;i&2&&(c=a.getUint32(h,!0),h+=4),h+=Wa(i&(t>1?3468:396))*4,i&512&&(s=a.getUint32(h,!0),h+=4),h+=Wa(i&(t>1?12288:4096))*4,i&16&&(o=a.getUint32(h,!0),h+=4),i&32&&(l=a.getFloat64(h,!0),h+=8),i&64&&(d.setTime(d.getTime()+(f=a.getFloat64(h,!0))*1e3),h+=8),t>1&&(i=a.getUint32(8,!0)>>>16,i&255&&(c==-1&&(c=a.getUint32(h,!0)),h+=4));var u,x=e[t>=4?1:2];switch(x){case 0:return;case 2:u={t:"n",v:l};break;case 3:u={t:"s",v:r.sst[o]};break;case 5:n?.cellDates?u={t:"d",v:d}:u={t:"n",v:f/86400+35430,z:De[14]};break;case 6:u={t:"b",v:l>0};break;case 7:u={t:"n",v:l};break;case 8:u={t:"e",v:0};break;case 9:if(s>-1){var g=r.rsst[s];u={t:"s",v:g.v},g.l&&(u.l={Target:g.l})}else throw new Error("Unsupported cell type ".concat(e[Xt](0,4)));break;default:throw new Error("Unsupported cell type ".concat(e[Xt](0,4)))}return c>-1&&nf(u,x|t<<8,i,r.ofmt[c],r.nfmt[c]),x==7&&(u.v/=86400),u}function Cv(e,r,t){var n=$a(e),a=n.getUint32(4,!0),i=n.getUint32(8,!0),s=12,o=-1,c=-1,l=-1,f=NaN,d=NaN,h=0,u=new Date(Date.UTC(2001,0,1)),x=-1,g=-1;i&1&&(f=vv(e,s),s+=16),i&2&&(d=n.getFloat64(s,!0),s+=8),i&4&&(u.setTime(u.getTime()+(h=n.getFloat64(s,!0))*1e3),s+=8),i&8&&(c=n.getUint32(s,!0),s+=4),i&16&&(o=n.getUint32(s,!0),s+=4),s+=Wa(i&480)*4,i&512&&(g=n.getUint32(s,!0),s+=4),s+=Wa(i&1024)*4,i&2048&&(x=n.getUint32(s,!0),s+=4);var p,m=e[1];switch(m){case 0:p={t:"z"};break;case 2:p={t:"n",v:f};break;case 3:p={t:"s",v:r.sst[c]};break;case 5:t?.cellDates?p={t:"d",v:u}:p={t:"n",v:h/86400+35430,z:De[14]};break;case 6:p={t:"b",v:d>0};break;case 7:p={t:"n",v:d};break;case 8:p={t:"e",v:0};break;case 9:if(o>-1){var w=r.rsst[o];p={t:"s",v:w.v},w.l&&(p.l={Target:w.l})}else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e[Xt](0,4)));break;case 10:p={t:"n",v:f};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e[Xt](0,4)))}if(s+=Wa(i&4096)*4,i&516096&&(l==-1&&(l=n.getUint32(s,!0)),s+=4),i&524288){var _=n.getUint32(s,!0);s+=4,r.cmnt[_]&&(p.c=Av(r.cmnt[_]))}return l>-1&&nf(p,m|1280,i>>13,r.ofmt[l],r.nfmt[l]),m==7&&(p.v/=86400),p}function Tv(e,r,t){switch(e[0]){case 0:case 1:case 2:case 3:case 4:return Ev(e,r,e[0],t);case 5:return Cv(e,r,t);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Wt(e){var r=Be(e);return $e(r[1][0].data)}function Rn(e,r){var t=Be(r.data),n=$e(t[1][0].data),a=t[3],i=[];return(a||[]).forEach(function(s){var o,c,l=Be(s.data);if(l[1]){var f=$e(l[1][0].data)>>>0;switch(n){case 1:i[f]=fa(l[3][0].data);break;case 8:{var d=e[Wt(l[9][0].data)][0],h=Be(d.data),u=e[Wt(h[1][0].data)][0],x=$e(u.meta[1][0].data);if(x!=2001)throw new Error("2000 unexpected reference to ".concat(x));var g=Be(u.data),p={v:g[3].map(function(_){return fa(_.data)}).join("")};i[f]=p;e:if((o=g?.[11])!=null&&o[0]){var m=(c=Be(g[11][0].data))==null?void 0:c[1];if(!m)break e;m.forEach(function(_){var F,N,j,O=Be(_.data);if((F=O[2])!=null&&F[0]){var P=e[Wt((N=O[2])==null?void 0:N[0].data)][0],D=$e(P.meta[1][0].data);switch(D){case 2032:var W=Be(P.data);(j=W?.[2])!=null&&j[0]&&!p.l&&(p.l=fa(W[2][0].data));break;case 2039:break;default:console.log("unrecognized ObjectAttribute type ".concat(D))}}})}}break;case 2:i[f]=Be(l[6][0].data);break;case 3:i[f]=Be(l[5][0].data);break;case 10:{var w=e[Wt(l[10][0].data)][0];i[f]=af(e,w.data)}break;default:throw n}}}),i}function bv(e,r){var t,n,a,i,s,o,c,l,f,d,h,u,x,g,p=Be(e),m=$e(p[1][0].data)>>>0,w=$e(p[2][0].data)>>>0,_=((n=(t=p[8])==null?void 0:t[0])==null?void 0:n.data)&&$e(p[8][0].data)>0||!1,F,N;if((i=(a=p[7])==null?void 0:a[0])!=null&&i.data&&r!=0)F=(o=(s=p[7])==null?void 0:s[0])==null?void 0:o.data,N=(l=(c=p[6])==null?void 0:c[0])==null?void 0:l.data;else if((d=(f=p[4])==null?void 0:f[0])!=null&&d.data&&r!=1)F=(u=(h=p[4])==null?void 0:h[0])==null?void 0:u.data,N=(g=(x=p[3])==null?void 0:x[0])==null?void 0:g.data;else throw"NUMBERS Tile missing ".concat(r," cell storage");for(var j=_?4:1,O=$a(F),P=[],D=0;D<F.length/2;++D){var W=O.getUint16(D*2,!0);W<65535&&P.push([D,W])}if(P.length!=w)throw"Expected ".concat(w," cells, found ").concat(P.length);var B=[];for(D=0;D<P.length-1;++D)B[P[D][0]]=N[Xt](P[D][1]*j,P[D+1][1]*j);return P.length>=1&&(B[P[P.length-1][0]]=N[Xt](P[P.length-1][1]*j)),{R:m,cells:B}}function Fv(e,r){var t,n=Be(r.data),a=-1;(t=n?.[7])!=null&&t[0]&&($e(n[7][0].data)>>>0?a=1:a=0);var i=ls(n[5],function(s){return bv(s,a)});return{nrows:$e(n[4][0].data)>>>0,data:i.reduce(function(s,o){return s[o.R]||(s[o.R]=[]),o.cells.forEach(function(c,l){if(s[o.R][l])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(l));s[o.R][l]=c}),s},[])}}function af(e,r){var t,n,a,i,s,o,c,l,f,d,h={t:"",a:""},u=Be(r);if((n=(t=u?.[1])==null?void 0:t[0])!=null&&n.data&&(h.t=fa((i=(a=u?.[1])==null?void 0:a[0])==null?void 0:i.data)||""),(o=(s=u?.[3])==null?void 0:s[0])!=null&&o.data){var x=e[Wt((l=(c=u?.[3])==null?void 0:c[0])==null?void 0:l.data)][0],g=Be(x.data);(d=(f=g[1])==null?void 0:f[0])!=null&&d.data&&(h.a=fa(g[1][0].data))}return u?.[4]&&(h.replies=[],u[4].forEach(function(p){var m=e[Wt(p.data)][0];h.replies.push(af(e,m.data))})),h}function Av(e){var r=[];return r.push({t:e.t||"",a:e.a,T:e.replies&&e.replies.length>0}),e.replies&&e.replies.forEach(function(t){r.push({t:t.t||"",a:t.a,T:!0})}),r}function Dv(e,r,t,n){var a,i,s,o,c,l,f,d,h,u,x,g,p,m,w=Be(r.data),_={s:{r:0,c:0},e:{r:0,c:0}};if(_.e.r=($e(w[6][0].data)>>>0)-1,_.e.r<0)throw new Error("Invalid row varint ".concat(w[6][0].data));if(_.e.c=($e(w[7][0].data)>>>0)-1,_.e.c<0)throw new Error("Invalid col varint ".concat(w[7][0].data));t["!ref"]=Xe(_);var F=t["!data"]!=null,N=t,j=Be(w[4][0].data),O=kv();(a=j[4])!=null&&a[0]&&(O.sst=Rn(e,e[Wt(j[4][0].data)][0])),(i=j[6])!=null&&i[0]&&(O.fmla=Rn(e,e[Wt(j[6][0].data)][0])),(s=j[11])!=null&&s[0]&&(O.ofmt=Rn(e,e[Wt(j[11][0].data)][0])),(o=j[12])!=null&&o[0]&&(O.ferr=Rn(e,e[Wt(j[12][0].data)][0])),(c=j[17])!=null&&c[0]&&(O.rsst=Rn(e,e[Wt(j[17][0].data)][0])),(l=j[19])!=null&&l[0]&&(O.cmnt=Rn(e,e[Wt(j[19][0].data)][0])),(f=j[22])!=null&&f[0]&&(O.nfmt=Rn(e,e[Wt(j[22][0].data)][0]));var P=Be(j[3][0].data),D=0;if(!((d=j[9])!=null&&d[0]))throw"NUMBERS file missing row tree";var W=Be(j[9][0].data)[1].map(function(re){return Be(re.data)});if(W.forEach(function(re){D=$e(re[1][0].data);var Ee=$e(re[2][0].data),te=P[1][Ee];if(!te)throw"NUMBERS missing tile "+Ee;var ve=Be(te.data),Te=e[Wt(ve[2][0].data)][0],se=$e(Te.meta[1][0].data);if(se!=6002)throw new Error("6001 unexpected reference to ".concat(se));var Pe=Fv(e,Te);Pe.data.forEach(function(J,ke){J.forEach(function(ge,Ue){var we=Tv(ge,O,n);we&&(F?(N["!data"][D+ke]||(N["!data"][D+ke]=[]),N["!data"][D+ke][Ue]=we):t[qe(Ue)+at(D+ke)]=we)})}),D+=Pe.nrows}),(h=j[13])!=null&&h[0]){var B=e[Wt(j[13][0].data)][0],U=$e(B.meta[1][0].data);if(U!=6144)throw new Error("Expected merge type 6144, found ".concat(U));t["!merges"]=(u=Be(B.data))==null?void 0:u[1].map(function(re){var Ee=Be(re.data),te=$a(Be(Ee[1][0].data)[1][0].data),ve=$a(Be(Ee[2][0].data)[1][0].data);return{s:{r:te.getUint16(0,!0),c:te.getUint16(2,!0)},e:{r:te.getUint16(0,!0)+ve.getUint16(0,!0)-1,c:te.getUint16(2,!0)+ve.getUint16(2,!0)-1}}})}if(!((x=t["!merges"])!=null&&x.length)&&((g=w[47])!=null&&g[0])){var K=Be(w[47][0].data);if((p=K[2])!=null&&p[0]){var he=Be(K[2][0].data);(m=he[3])!=null&&m[0]&&(t["!merges"]=ls(he[3],function(re){var Ee,te,ve,Te,se,Pe=Be(re),J=Be(Pe[2][0].data),ke=Be(J[1][0].data);if((Ee=ke[1])!=null&&Ee[0]){var ge=Be(ke[1][0].data),Ue=$e(ge[1][0].data);if(Ue==67){var we=Be(ge[40][0].data);if(!(!((te=we[3])!=null&&te[0])||!((ve=we[4])!=null&&ve[0]))){var be=Be(we[3][0].data),b=Be(we[4][0].data),I=$e(be[1][0].data),R=(Te=be[2])!=null&&Te[0]?$e(be[2][0].data):I,A=$e(b[1][0].data),q=(se=b[2])!=null&&se[0]?$e(b[2][0].data):A;return{s:{r:A,c:I},e:{r:q,c:R}}}}}}).filter(function(re){return re!=null}))}}}function Rv(e,r,t){var n=Be(r.data),a={"!ref":"A1"};t?.dense&&(a["!data"]=[]);var i=e[Wt(n[2][0].data)],s=$e(i[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return Dv(e,i[0],a,t),a}function Ov(e,r,t){var n,a=Be(r.data),i={name:(n=a[1])!=null&&n[0]?fa(a[1][0].data):"",sheets:[]},s=ls(a[2],Wt);return s.forEach(function(o){e[o].forEach(function(c){var l=$e(c.meta[1][0].data);l==6e3&&i.sheets.push(Rv(e,c,t))})}),i}function Pv(e,r,t){var n,a=Ro();a.Workbook={WBProps:{date1904:!0}};var i=Be(r.data);if((n=i[2])!=null&&n[0])throw new Error("Keynote presentations are not supported");var s=ls(i[1],Wt);if(s.forEach(function(o){e[o].forEach(function(c){var l=$e(c.meta[1][0].data);if(l==2){var f=Ov(e,c,t);f.sheets.forEach(function(d,h){ei(a,d,h==0?f.name:f.name+"_"+h,!0)})}})}),a.SheetNames.length==0)throw new Error("Empty NUMBERS file");return a.bookType="numbers",a}function $s(e,r){var t,n,a,i,s,o,c,l={},f=[];if(e.FullPaths.forEach(function(h){if(h.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(h){if(h.name.match(/\.iwa$/)&&h.content[0]==0){var u;try{u=Sv(h.content)}catch(g){return console.log("?? "+h.content.length+" "+(g.message||g))}var x;try{x=wv(u)}catch(g){return console.log("## "+(g.message||g))}x.forEach(function(g){l[g.id]=g.messages,f.push(g.id)})}}),!f.length)throw new Error("File has no messages");if((a=(n=(t=l?.[1])==null?void 0:t[0].meta)==null?void 0:n[1])!=null&&a[0].data&&$e(l[1][0].meta[1][0].data)==1e4)throw new Error("Pages documents are not supported");var d=((c=(o=(s=(i=l?.[1])==null?void 0:i[0])==null?void 0:s.meta)==null?void 0:o[1])==null?void 0:c[0].data)&&$e(l[1][0].meta[1][0].data)==1&&l[1][0];if(d||f.forEach(function(h){l[h].forEach(function(u){var x=$e(u.meta[1][0].data)>>>0;if(x==1)if(!d)d=u;else throw new Error("Document has multiple roots")})}),!d)throw new Error("Cannot find Document root");return Pv(l,d,r)}function Nv(e){return function(t){for(var n=0;n!=e.length;++n){var a=e[n];t[a[0]]===void 0&&(t[a[0]]=a[1]),a[2]==="n"&&(t[a[0]]=Number(t[a[0]]))}}}function Ao(e){Nv([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function Iv(e){return en.WS.indexOf(e)>-1?"sheet":en.CS&&e==en.CS?"chart":en.DS&&e==en.DS?"dialog":en.MS&&e==en.MS?"macro":e&&e.length?e:"sheet"}function Mv(e,r){if(!e)return 0;try{e=r.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,Iv(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function Bv(e,r,t,n,a,i,s,o){if(!(!e||!e["!legdrawel"])){var c=oa(e["!legdrawel"].Target,n),l=cr(t,c,!0);l&&Xm(ft(l),e,o||[])}}function Lv(e,r,t,n,a,i,s,o,c,l,f,d){try{i[n]=Na(cr(e,t,!0),r);var h=Ot(e,r),u;switch(o){case"sheet":u=V_(h,r,a,c,i[n],l,f,d);break;case"chart":if(u=H_(h,r,a,c,i[n],l,f,d),!u||!u["!drawel"])break;var x=oa(u["!drawel"].Target,r),g=Qs(x),p=zm(cr(e,x,!0),Na(cr(e,g,!0),x)),m=oa(p,x),w=Qs(m);u=E_(cr(e,m,!0),m,c,Na(cr(e,w,!0),m),l,u);break;case"macro":u=z_(h,r,a,c,i[n],l,f,d);break;case"dialog":u=X_(h,r,a,c,i[n],l,f,d);break;default:throw new Error("Unrecognized sheet type "+o)}s[n]=u;var _=[],F=[];i&&i[n]&&Pr(i[n]).forEach(function(N){var j="";if(i[n][N].Type==en.CMNT){if(j=oa(i[n][N].Target,r),_=$_(Ot(e,j,!0),j,c),!_||!_.length)return;xc(u,_,!1)}i[n][N].Type==en.TCMNT&&(j=oa(i[n][N].Target,r),F=F.concat(jm(Ot(e,j,!0),c)))}),F&&F.length&&xc(u,F,!0,c.people||[]),Bv(u,o,e,r,a,c,l,_)}catch(N){if(c.WTF)throw N}}function Dr(e){return e.charAt(0)=="/"?e.slice(1):e}function Uv(e,r){if(zc(),r=r||{},Ao(r),Or(e,"META-INF/manifest.xml")||Or(e,"objectdata.xml"))return Fc(e,r);if(Or(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof $s<"u"){if(e.FileIndex)return $s(e,r);var t=je.utils.cfb_new();return H0(e).forEach(function(re){Vh(t,re,Kc(e,re))}),$s(t,r)}throw new Error("Unsupported NUMBERS file")}if(!Or(e,"[Content_Types].xml")){if(Or(e,"index.xml.gz"))throw new Error("Unsupported NUMBERS 08 file");if(Or(e,"index.xml"))throw new Error("Unsupported NUMBERS 09 file");var n=je.find(e,"Index.zip");if(n)return r=Nt(r),delete r.type,typeof n.content=="string"&&(r.type="binary"),typeof Bun<"u"&&Buffer.isBuffer(n.content)?Bn(new Uint8Array(n.content),r):Bn(n.content,r);throw new Error("Unsupported ZIP file")}var a=H0(e),i=Ld(cr(e,"[Content_Types].xml")),s=!1,o,c;if(i.workbooks.length===0&&(c="xl/workbook.xml",Ot(e,c,!0)&&i.workbooks.push(c)),i.workbooks.length===0){if(c="xl/workbook.bin",!Ot(e,c,!0))throw new Error("Could not find workbook");i.workbooks.push(c),s=!0}i.workbooks[0].slice(-3)=="bin"&&(s=!0);var l={},f={};if(!r.bookSheets&&!r.bookProps){if(Ba=[],i.sst)try{Ba=j_(Ot(e,Dr(i.sst)),i.sst,r)}catch(re){if(r.WTF)throw re}r.cellStyles&&i.themes.length&&(l=Il(cr(e,i.themes[0].replace(/^\//,""),!0)||"",r)),i.style&&(f=G_(Ot(e,Dr(i.style)),i.style,l,r))}i.links.map(function(re){try{var Ee=Na(cr(e,Qs(Dr(re))),re);return K_(Ot(e,Dr(re)),Ee,re,r)}catch{}});var d=W_(Ot(e,Dr(i.workbooks[0])),i.workbooks[0],r),h={},u="";i.coreprops.length&&(u=Ot(e,Dr(i.coreprops[0]),!0),u&&(h=ml(u)),i.extprops.length!==0&&(u=Ot(e,Dr(i.extprops[0]),!0),u&&Hd(u,h,r)));var x={};(!r.bookSheets||r.bookProps)&&i.custprops.length!==0&&(u=cr(e,Dr(i.custprops[0]),!0),u&&(x=Xd(u,r)));var g={};if((r.bookSheets||r.bookProps)&&(d.Sheets?o=d.Sheets.map(function(Ee){return Ee.name}):h.Worksheets&&h.SheetNames.length>0&&(o=h.SheetNames),r.bookProps&&(g.Props=h,g.Custprops=x),r.bookSheets&&typeof o<"u"&&(g.SheetNames=o),r.bookSheets?g.SheetNames:r.bookProps))return g;o={};var p={};r.bookDeps&&i.calcchain&&(p=Y_(Ot(e,Dr(i.calcchain)),i.calcchain,r));var m=0,w={},_,F;{var N=d.Sheets;h.Worksheets=N.length,h.SheetNames=[];for(var j=0;j!=N.length;++j)h.SheetNames[j]=N[j].name}var O=s?"bin":"xml",P=i.workbooks[0].lastIndexOf("/"),D=(i.workbooks[0].slice(0,P+1)+"_rels/"+i.workbooks[0].slice(P+1)+".rels").replace(/^\//,"");Or(e,D)||(D="xl/_rels/workbook."+O+".rels");var W=Na(cr(e,D,!0),D.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(r.xlmeta=Z_(Ot(e,Dr(i.metadata[0])),i.metadata[0],r)),(i.people||[]).length>=1&&(r.people=$m(Ot(e,Dr(i.people[0])),r)),W&&(W=Mv(W,d.Sheets));var B=Ot(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(m=0;m!=h.Worksheets;++m){var U="sheet";if(W&&W[m]?(_="xl/"+W[m][1].replace(/[\/]?xl\//,""),Or(e,_)||(_=W[m][1]),Or(e,_)||(_=D.replace(/_rels\/[\S\s]*$/,"")+W[m][1]),U=W[m][2]):(_="xl/worksheets/sheet"+(m+1-B)+"."+O,_=_.replace(/sheet0\./,"sheet.")),F=_.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),r&&r.sheets!=null)switch(typeof r.sheets){case"number":if(m!=r.sheets)continue e;break;case"string":if(h.SheetNames[m].toLowerCase()!=r.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(r.sheets)){for(var K=!1,he=0;he!=r.sheets.length;++he)typeof r.sheets[he]=="number"&&r.sheets[he]==m&&(K=1),typeof r.sheets[he]=="string"&&r.sheets[he].toLowerCase()==h.SheetNames[m].toLowerCase()&&(K=1);if(!K)continue e}}Lv(e,_,F,h.SheetNames[m],m,w,o,U,r,d,l,f)}return g={Directory:i,Workbook:d,Props:h,Custprops:x,Deps:p,Sheets:o,SheetNames:h.SheetNames,Strings:Ba,Styles:f,Themes:l,SSF:Nt(De)},r&&r.bookFiles&&(e.files?(g.keys=a,g.files=e.files):(g.keys=[],g.files={},e.FullPaths.forEach(function(re,Ee){re=re.replace(/^Root Entry[\/]/,""),g.keys.push(re),g.files[re]=e.FileIndex[Ee]}))),r&&r.bookVBA&&(i.vba.length>0?g.vbaraw=Ot(e,Dr(i.vba[0]),!0):i.defaults&&i.defaults.bin===qm&&(g.vbaraw=Ot(e,"xl/vbaProject.bin",!0))),g.bookType=s?"xlsb":"xlsx",g}function Wv(e,r){var t=r||{},n="Workbook",a=je.find(e,n);try{if(n="/!DataSpaces/Version",a=je.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(Bp(a.content),n="/!DataSpaces/DataSpaceMap",a=je.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=Up(a.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=je.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=Wp(a.content);if(s.length!=1||s[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=je.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);Hp(a.content)}catch{}if(n="/EncryptionInfo",a=je.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=zp(a.content);if(n="/EncryptedPackage",a=je.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],a.content,t.password||"",t);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],a.content,t.password||"",t);throw new Error("File is password-protected")}function Do(e,r){var t="";switch((r||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":t=Sr(e.slice(0,12));break;case"binary":t=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(r&&r.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function Vv(e,r){return je.find(e,"EncryptedPackage")?Wv(e,r):ql(e,r)}function Hv(e,r){var t,n=e,a=r||{};return a.type||(a.type=He&&Buffer.isBuffer(e)?"buffer":"base64"),t=Zc(n,a),Uv(t,a)}function sf(e,r){var t=0;e:for(;t<e.length;)switch(e.charCodeAt(t)){case 10:case 13:case 32:++t;break;case 60:return to(e.slice(t),r);default:break e}return Xa.to_workbook(e,r)}function zv(e,r){var t="",n=Do(e,r);switch(r.type){case"base64":t=Sr(e);break;case"binary":t=e;break;case"buffer":t=e.toString("binary");break;case"array":t=Un(e);break;default:throw new Error("Unrecognized type "+r.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(t=ft(t)),r.type="binary",sf(t,r)}function Xv(e,r){var t=e;return r.type=="base64"&&(t=Sr(t)),typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer&&(t=new Uint8Array(e)),t=typeof Le<"u"?Le.utils.decode(1200,t.slice(2),"str"):He&&Buffer.isBuffer(e)?e.slice(2).toString("utf16le"):typeof Uint8Array<"u"&&t instanceof Uint8Array?typeof TextDecoder<"u"?new TextDecoder("utf-16le").decode(t.slice(2)):Ku(t.slice(2)):Pc(t.slice(2)),r.type="binary",sf(t,r)}function Gv(e){return e.match(/[^\x00-\x7F]/)?Aa(e):e}function Ys(e,r,t,n){return n?(t.type="string",Xa.to_workbook(e,t)):Xa.to_workbook(r,t)}function Bn(e,r){Oc();var t=r||{};if(t.codepage&&typeof Le>"u"&&console.error("Codepage tables are not loaded.  Non-ASCII characters may not give expected results"),typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Bn(new Uint8Array(e),(t=Nt(t),t.type="array",t));if(typeof Int8Array<"u"&&e instanceof Int8Array)return Bn(new Uint8Array(e.buffer,e.byteOffset,e.length),t);typeof Uint8Array<"u"&&e instanceof Uint8Array&&!t.type&&(t.type=typeof Deno<"u"?"buffer":"array");var n=e,a=[0,0,0,0],i=!1;if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),la={},t.dateNF&&(la.dateNF=t.dateNF),t.type||(t.type=He&&Buffer.isBuffer(e)?"buffer":"base64"),t.type=="file"&&(t.type=He?"buffer":"binary",n=kh(e),typeof Uint8Array<"u"&&!He&&(t.type="array")),t.type=="string"&&(i=!0,t.type="binary",t.codepage=65001,n=Gv(e)),t.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var s=new ArrayBuffer(3),o=new Uint8Array(s);if(o.foo="bar",!o.foo)return t=Nt(t),t.type="array",Bn(so(n),t)}switch((a=Do(n,t))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return Vv(je.read(n,t),t);break;case 9:if(a[1]<=8)return ql(n,t);break;case 60:return to(n,t);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return Tp(n,t);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return Ep.to_workbook(n,t);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?Hv(n,t):Ys(e,n,t,i);case 239:return a[3]===60?to(n,t):Ys(e,n,t,i);case 255:if(a[1]===254)return Xv(n,t);if(a[1]===0&&a[2]===2&&a[3]===0)return Ma.to_workbook(n,t);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return Ma.to_workbook(n,t);break;case 3:case 131:case 139:case 140:return mc.to_workbook(n,t);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return rm(n,t);break;case 10:case 13:case 32:return zv(n,t);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break;case 8:if(a[1]===231)throw new Error("Unsupported Multiplan 1.x file!");break;case 12:if(a[1]===236)throw new Error("Unsupported Multiplan 2.x file!");if(a[1]===237)throw new Error("Unsupported Multiplan 3.x file!");break}return Sp.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?mc.to_workbook(n,t):Ys(e,n,t,i)}function jv(e,r,t,n,a,i,s){var o=at(t),c=s.defval,l=s.raw||!Object.prototype.hasOwnProperty.call(s,"raw"),f=!0,d=e["!data"]!=null,h=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:t,enumerable:!1})}catch{h.__rowNum__=t}else h.__rowNum__=t;if(!d||e["!data"][t])for(var u=r.s.c;u<=r.e.c;++u){var x=d?(e["!data"][t]||[])[u]:e[n[u]+o];if(x==null||x.t===void 0){if(c===void 0)continue;i[u]!=null&&(h[i[u]]=c);continue}var g=x.v;switch(x.t){case"z":if(g==null)break;continue;case"e":g=g==0?null:void 0;break;case"s":case"b":case"n":if(!x.z||!Xr(x.z)||(g=gn(g),typeof g=="number"))break;case"d":s&&(s.UTC||s.raw===!1)||(g=Wn(new Date(g)));break;default:throw new Error("unrecognized type "+x.t)}if(i[u]!=null){if(g==null)if(x.t=="e"&&g===null)h[i[u]]=null;else if(c!==void 0)h[i[u]]=c;else if(l&&g===null)h[i[u]]=null;else continue;else h[i[u]]=(x.t==="n"&&typeof s.rawNumbers=="boolean"?s.rawNumbers:l)?g:vn(x,g,s);g!=null&&(f=!1)}}return{row:h,isempty:f}}function no(e,r){if(e==null||e["!ref"]==null)return[];var t={t:"n",v:0},n=0,a=1,i=[],s=0,o="",c={s:{r:0,c:0},e:{r:0,c:0}},l=r||{},f=l.range!=null?l.range:e["!ref"];switch(l.header===1?n=1:l.header==="A"?n=2:Array.isArray(l.header)?n=3:l.header==null&&(n=0),typeof f){case"string":c=Ct(f);break;case"number":c=Ct(e["!ref"]),c.s.r=f;break;default:c=f}n>0&&(a=0);var d=at(c.s.r),h=[],u=[],x=0,g=0,p=e["!data"]!=null,m=c.s.r,w=0,_={};p&&!e["!data"][m]&&(e["!data"][m]=[]);var F=l.skipHidden&&e["!cols"]||[],N=l.skipHidden&&e["!rows"]||[];for(w=c.s.c;w<=c.e.c;++w)if(!(F[w]||{}).hidden)switch(h[w]=qe(w),t=p?e["!data"][m][w]:e[h[w]+d],n){case 1:i[w]=w-c.s.c;break;case 2:i[w]=h[w];break;case 3:i[w]=l.header[w-c.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),o=s=vn(t,null,l),g=_[s]||0,!g)_[s]=1;else{do o=s+"_"+g++;while(_[o]);_[s]=g,_[o]=1}i[w]=o}for(m=c.s.r+a;m<=c.e.r;++m)if(!(N[m]||{}).hidden){var j=jv(e,c,m,h,n,i,l);(j.isempty===!1||(n===1?l.blankrows!==!1:l.blankrows))&&(u[x++]=j.row)}return u.length=x,u}var Dc=/"/g;function $v(e,r,t,n,a,i,s,o,c){for(var l=!0,f=[],d="",h=at(t),u=e["!data"]!=null,x=u&&e["!data"][t]||[],g=r.s.c;g<=r.e.c;++g)if(n[g]){var p=u?x[g]:e[n[g]+h];if(p==null)d="";else if(p.v!=null){l=!1,d=""+(c.rawNumbers&&p.t=="n"?p.v:vn(p,null,c));for(var m=0,w=0;m!==d.length;++m)if((w=d.charCodeAt(m))===a||w===i||w===34||c.forceQuotes){d='"'+d.replace(Dc,'""')+'"';break}d=="ID"&&o==0&&f.length==0&&(d='"ID"')}else p.f!=null&&!p.F?(l=!1,d="="+p.f,d.indexOf(",")>=0&&(d='"'+d.replace(Dc,'""')+'"')):d="";f.push(d)}if(c.strip)for(;f[f.length-1]==="";)--f.length;return c.blankrows===!1&&l?null:f.join(s)}function of(e,r){var t=[],n=r??{};if(e==null||e["!ref"]==null)return"";for(var a=Ct(e["!ref"]),i=n.FS!==void 0?n.FS:",",s=i.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,c=o.charCodeAt(0),l="",f=[],d=n.skipHidden&&e["!cols"]||[],h=n.skipHidden&&e["!rows"]||[],u=a.s.c;u<=a.e.c;++u)(d[u]||{}).hidden||(f[u]=qe(u));for(var x=0,g=a.s.r;g<=a.e.r;++g)(h[g]||{}).hidden||(l=$v(e,a,g,f,s,c,i,x,n),l!=null&&(l||n.blankrows!==!1)&&t.push((x++?o:"")+l));return t.join("")}function Yv(e,r){r||(r={}),r.FS="	",r.RS=`
`;var t=of(e,r);if(typeof Le>"u"||r.type=="string")return t;var n=Le.utils.encode(1200,t,"str");return"\xFF\xFE"+n}function Kv(e,r){var t="",n,a="";if(e==null||e["!ref"]==null)return[];var i=Ct(e["!ref"]),s="",o=[],c,l=[],f=e["!data"]!=null;for(c=i.s.c;c<=i.e.c;++c)o[c]=qe(c);for(var d=i.s.r;d<=i.e.r;++d)for(s=at(d),c=i.s.c;c<=i.e.c;++c)if(t=o[c]+s,n=f?(e["!data"][d]||[])[c]:e[t],a="",n!==void 0){if(n.F!=null){if(t=n.F,!n.f)continue;a=n.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(n.f!=null)a=n.f;else{if(r&&r.values===!1)continue;if(n.t=="z")continue;if(n.t=="n"&&n.v!=null)a=""+n.v;else if(n.t=="b")a=n.v?"TRUE":"FALSE";else if(n.w!==void 0)a="'"+n.w;else{if(n.v===void 0)continue;n.t=="s"?a="'"+n.v:a=""+n.v}}l[l.length]=t+"="+a}return l}function cf(e,r,t){var n=t||{},a=e?e["!data"]!=null:n.dense;Et!=null&&a==null&&(a=Et);var i=+!n.skipHeader,s=e||{};!e&&a&&(s["!data"]=[]);var o=0,c=0;if(s&&n.origin!=null)if(typeof n.origin=="number")o=n.origin;else{var l=typeof n.origin=="string"?rr(n.origin):n.origin;o=l.r,c=l.c}var f={s:{c:0,r:0},e:{c,r:o+r.length-1+i}};if(s["!ref"]){var d=Ct(s["!ref"]);f.e.c=Math.max(f.e.c,d.e.c),f.e.r=Math.max(f.e.r,d.e.r),o==-1&&(o=d.e.r+1,f.e.r=o+r.length-1+i)}else o==-1&&(o=0,f.e.r=r.length-1+i);var h=n.header||[],u=0,x=[];r.forEach(function(p,m){a&&!s["!data"][o+m+i]&&(s["!data"][o+m+i]=[]),a&&(x=s["!data"][o+m+i]),Pr(p).forEach(function(w){(u=h.indexOf(w))==-1&&(h[u=h.length]=w);var _=p[w],F="z",N="",j=a?"":qe(c+u)+at(o+m+i),O=a?x[c+u]:s[j];_&&typeof _=="object"&&!(_ instanceof Date)?a?x[c+u]=_:s[j]=_:(typeof _=="number"?F="n":typeof _=="boolean"?F="b":typeof _=="string"?F="s":_ instanceof Date?(F="d",n.UTC||(_=ts(_)),n.cellDates||(F="n",_=Mt(_)),N=O!=null&&O.z&&Xr(O.z)?O.z:n.dateNF||De[14]):_===null&&n.nullError&&(F="e",_=0),O?(O.t=F,O.v=_,delete O.w,delete O.R,N&&(O.z=N)):a?x[c+u]=O={t:F,v:_}:s[j]=O={t:F,v:_},N&&(O.z=N))})}),f.e.c=Math.max(f.e.c,c+h.length-1);var g=at(o);if(a&&!s["!data"][o]&&(s["!data"][o]=[]),i)for(u=0;u<h.length;++u)a?s["!data"][o][u+c]={t:"s",v:h[u]}:s[qe(u+c)+g]={t:"s",v:h[u]};return s["!ref"]=Xe(f),s}function Zv(e,r){return cf(null,e,r)}function Ya(e,r,t){if(typeof r=="string"){if(e["!data"]!=null){var n=rr(r);return e["!data"][n.r]||(e["!data"][n.r]=[]),e["!data"][n.r][n.c]||(e["!data"][n.r][n.c]={t:"z"})}return e[r]||(e[r]={t:"z"})}return typeof r!="number"?Ya(e,Ye(r)):Ya(e,qe(t||0)+at(r))}function qv(e,r){if(typeof r=="number"){if(r>=0&&e.SheetNames.length>r)return r;throw new Error("Cannot find sheet # "+r)}else if(typeof r=="string"){var t=e.SheetNames.indexOf(r);if(t>-1)return t;throw new Error("Cannot find sheet name |"+r+"|")}else throw new Error("Cannot find sheet |"+r+"|")}function Ro(e,r){var t={SheetNames:[],Sheets:{}};return e&&ei(t,e,r||"Sheet1"),t}function ei(e,r,t,n){var a=1;if(!t)for(;a<=65535&&e.SheetNames.indexOf(t="Sheet"+a)!=-1;++a,t=void 0);if(!t||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(t)>=0&&t.length<32){var i=t.match(/\d+$/);a=i&&+i[0]||0;var s=i&&t.slice(0,i.index)||t;for(++a;a<=65535&&e.SheetNames.indexOf(t=s+a)!=-1;++a);}if(O_(t),e.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return e.SheetNames.push(t),e.Sheets[t]=r,t}function Jv(e,r,t){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=qv(e,r);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}e.Workbook.Sheets[n].Hidden=t}function Qv(e,r){return e.z=r,e}function lf(e,r,t){return r?(e.l={Target:r},t&&(e.l.Tooltip=t)):delete e.l,e}function e2(e,r,t){return lf(e,"#"+r,t)}function t2(e,r,t){e.c||(e.c=[]),e.c.push({t:r,a:t||"SheetJS"})}function r2(e,r,t,n){for(var a=typeof r!="string"?r:Ct(r),i=typeof r=="string"?r:Xe(r),s=a.s.r;s<=a.e.r;++s)for(var o=a.s.c;o<=a.e.c;++o){var c=Ya(e,s,o);c.t="n",c.F=i,delete c.v,s==a.s.r&&o==a.s.c&&(c.f=t,n&&(c.D=!0))}var l=Hn(e["!ref"]);return l.s.r>a.s.r&&(l.s.r=a.s.r),l.s.c>a.s.c&&(l.s.c=a.s.c),l.e.r<a.e.r&&(l.e.r=a.e.r),l.e.c<a.e.c&&(l.e.c=a.e.c),e["!ref"]=Xe(l),e}var ff={encode_col:qe,encode_row:at,encode_cell:Ye,encode_range:Xe,decode_col:wo,decode_row:vo,split_cell:md,decode_cell:rr,decode_range:Hn,format_cell:vn,sheet_new:gd,sheet_add_aoa:fl,sheet_add_json:cf,sheet_add_dom:Jl,aoa_to_sheet:ma,json_to_sheet:Zv,table_to_sheet:Ql,table_to_book:xv,sheet_to_csv:of,sheet_to_txt:Yv,sheet_to_json:no,sheet_to_html:mv,sheet_to_formulae:Kv,sheet_to_row_object_array:no,sheet_get_cell:Ya,book_new:Ro,book_append_sheet:ei,book_set_sheet_visibility:Jv,cell_set_number_format:Qv,cell_set_hyperlink:lf,cell_set_internal_link:e2,cell_add_comment:t2,sheet_set_array_formula:r2,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};var ly=Rc.version;var fs=class e{studentsChange=di();selectedFileName=Ie("");async onFileSelected(r){let t=r.target;if(t.files&&t.files.length>0){let n=t.files[0];this.selectedFileName.set(n.name);let a=await n.arrayBuffer(),i=Bn(a,{type:"array"}),s=i.Sheets[i.SheetNames[0]],c=ff.sheet_to_json(s,{defval:""}).map(f=>Qe(Ae({},f),{PreferredName:f.Nickname?f.Nickname:f.Name})).map((f,d,h)=>Qe(Ae({},f),{DisplayName:h.filter(u=>u.PreferredName===f.PreferredName).length===1?f.PreferredName:`${f.PreferredName} ${f.Surname?.[0]}`.trim(),HouseMates:h.filter(u=>u!==f&&!!u.Address&&u.Address===f.Address).map(u=>u.uid),StopId:f.Stop}));i.Workbook=Qe(Ae({},i.Workbook),{Names:[...i.Workbook?.Names??[],{Name:n.name,Ref:"StudentEntries!A1"}]});let l=c.map(f=>({student:{id:f.uid,name:`${f.Name} ${f.Surname}`,displayName:f.DisplayName,address:f.Address,contact:{name:f["Contact Name"],phone:f["Contact Phone"]},grade:f.Grade=="0"?"K":f.Grade,school:{},housemateIds:f.HouseMates},stopId:f.StopId||""}));console.log("Imported students with stop",l),this.studentsChange.emit(l)}}static \u0275fac=function(t){return new(t||e)};static \u0275cmp=Ke({type:e,selectors:[["app-import-sheet"]],outputs:{studentsChange:"studentsChange"},decls:14,vars:1,consts:[[1,"file-upload-group"],["for","file-upload",1,"file-upload-label"],["type","file","id","file-upload","accept",".xlsx,.ods,.csv",1,"visually-hidden",3,"change"],["for","file-upload",1,"custom-file-btn"],["id","file-upload-filename",1,"file-upload-filename"],[1,"instructions"]],template:function(t,n){t&1&&(Cr(0,"div",0)(1,"label",1),Y(2,"Upload File:"),Ur(),Cr(3,"input",2),c0("change",function(i){return n.onFileSelected(i)}),Ur(),Cr(4,"label",3),Y(5,"Choose File"),Ur(),Cr(6,"span",4),Y(7),Ur(),Cr(8,"div",5)(9,"ul")(10,"li"),Y(11,"File types supported: .xlsx, .ods, .csv"),Ur(),Cr(12,"li"),Y(13,"Columns supported: Name, Surname, Nickname, Address, Grade, Stop, uid"),Ur()()()()),t&2&&(G(7),vt(n.selectedFileName()||"No file chosen"))},styles:[".visually-hidden[_ngcontent-%COMP%]{position:absolute!important;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}.file-upload-group[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem}.custom-file-btn[_ngcontent-%COMP%]{display:inline-block;padding:var(--space-xs) var(--space-sm);background:var(--color-primary);color:#fff;border:none;border-radius:4px;cursor:pointer;font-size:1rem;transition:background .2s}.custom-file-btn[_ngcontent-%COMP%]:hover, .custom-file-btn[_ngcontent-%COMP%]:focus{background:#115293}.file-upload-filename[_ngcontent-%COMP%]{font-size:1rem;color:var(--color-text)}"]})};var a2=()=>["../seating"],i2=(e,r)=>r.id;function s2(e,r){if(e&1&&(M(0,"span",3),Y(1),L()),e&2){let t=Q().$implicit,n=Q();G(),Ve("(Stop: ",n.getStopId(t.id),")")}}function o2(e,r){if(e&1&&(M(0,"li"),Y(1),tt(2,s2,2,1,"span",3),L()),e&2){let t=r.$implicit,n=Q();G(),Ve(" ",t.displayName," "),G(),rt(n.getStopId(t.id)?2:-1)}}var us=class e{transportationPlanService=ce(Dt);router=ce(hn);students=Ie([]);constructor(){yt(()=>{let t=(this.transportationPlanService.currentPlan()?.students??[]).sort((n,a)=>n.displayName.localeCompare(a.displayName));this.students.set(t)})}onStudentsImported(r){let t=this.transportationPlanService.currentPlan();if(t){let n=r.map(s=>s.student),a=r.filter(s=>s.stopId).map(s=>({stop:{id:s.stopId},student:s.student})),i=Qe(Ae({},t),{students:n,roster:Qe(Ae({},t.roster),{stopAssignments:a})});this.transportationPlanService.updatePlan(i),n.sort((s,o)=>s.displayName.localeCompare(o.displayName)),this.students.set(n)}}getStopId(r){return this.transportationPlanService.currentPlan()?.roster?.stopAssignments?.find(a=>a.student.id===r)?.stop?.id}static \u0275fac=function(t){return new(t||e)};static \u0275cmp=Ke({type:e,selectors:[["app-student-step"]],decls:11,vars:3,consts:[[3,"studentsChange"],[1,"student-list"],[1,"wizard-nav",3,"routerLink","disabled"],[2,"color","var(--bb-gray)","font-size","0.95em"]],template:function(t,n){t&1&&(M(0,"h2"),Y(1,"Add Students"),L(),M(2,"app-import-sheet",0),Se("studentsChange",function(i){return n.onStudentsImported(i)}),L(),M(3,"div",1)(4,"h3"),Y(5,"Imported Students"),L(),M(6,"ul"),ut(7,o2,3,2,"li",null,i2),L()(),M(9,"button",2),Y(10,"Next"),L()),t&2&&(G(7),ht(n.students()),G(2),We("routerLink",Bt(2,a2))("disabled",n.students().length===0))},dependencies:[fs,Lt],styles:[".student-list[_ngcontent-%COMP%]{margin-top:1rem}.wizard-nav[_ngcontent-%COMP%]{margin-top:2rem;display:flex;gap:1rem}"]})};var c2=["busSeat",""];function l2(e,r){if(e&1&&(Mr(),Cr(0,"text",0),Y(1),Cr(2,"title"),Y(3),Ur()()),e&2){let t=r,n=Q().$implicit,a=At(0),i=Q();o0("title",i.title()),Kt("font-size",t+"px")("y",(i.labelFragments().length-1)*a*t-(i.labelFragments().length-1)*t/3),G(),Ve(" ",n," "),G(2),vt(i.title())}}function f2(e,r){if(e&1&&(Qr(0),tt(1,l2,4,5,":svg:text",0),Zt(2,"async")),e&2){let t,n=r.$index;Q();let a=At(3);_r(n),G(),rt((t=Wr(2,2,a))?1:-1,t)}}var Oo=class e{async transform(r,t){let a=document.createElement("span"),i=a.style;i.setProperty("color","transparent"),i.setProperty("position","fixed"),i.setProperty("bottom","0"),i.setProperty("right","0"),i.fontSize="100px",i.whiteSpace="pre",a.textContent=r.replaceAll(/\s/g,`
`),document.body.appendChild(a),await new Promise(f=>setTimeout(f,0));let s=a.getBoundingClientRect(),o=Math.max(s.width,s.height),l=t/o*100*.9;return a.remove(),l}static \u0275fac=function(t){return new(t||e)};static \u0275pipe=fi({name:"labelFontSize",type:e,pure:!0})},hs=class e{label=qt.required();title=qt();size=qt.required();labelFragments=Me(()=>this.label().split(/\s|\n/g));static \u0275fac=function(t){return new(t||e)};static \u0275cmp=Ke({type:e,selectors:[["g","busSeat",""]],inputs:{label:[1,"label"],title:[1,"title"],size:[1,"size"]},attrs:c2,decls:7,vars:6,consts:[["text-anchor","middle","alignment-baseline","middle",3,"title"]],template:function(t,n){t&1&&(Mr(),Cr(0,"circle")(1,"title"),Y(2),Ur()(),Qr(3),Zt(4,"labelFontSize"),ut(5,f2,3,4,null,null,ea)),t&2&&(Kt("r",n.size()/2),G(2),vt(n.title()),G(),_r(Dn(4,2,n.label(),n.size())),G(2),ht(n.labelFragments()))},dependencies:[Oo,m0],styles:["[_nghost-%COMP%]{cursor:pointer}circle[_ngcontent-%COMP%]{stroke:#000;fill:#fff}"]})};var Po=()=>[],u2=(e,r)=>r[0];function h2(e,r){if(e&1&&(Mr(),M(0,"text",4),Y(1),L()),e&2){let t=r.$implicit,n=r.$index,a=Q(),s=(n<a.ridersPerBench()?"left":"right")==="left"?a.centerX()-a.benchWidth()+a.seatDiameter()*n:a.centerX()+a.seatDiameter()*(n-a.ridersPerBench()+1);Kt("x",s)("y",a.headerHeight()+a.marginPx()-a.seatRadius()/2),G(),Ve(" ",t," ")}}function d2(e,r){if(e&1){let t=gt();Qr(0)(1),Mr(),dt(2,"rect",7),M(3,"g",8),Se("click",function(){pe(t);let a=At(0),i=At(1),s=Q(3);return me(s.seatClick.emit({seatId:a,rider:i}))}),M(4,"title"),Y(5),L()()}if(e&2){let t,n;Q();let a=At(0),i=At(1);Q();let s=At(0),o=At(1),c=Q(),l=i+c.benchWidth()/4-c.seatRadius(),f=_r(s+1+c.rowSeatNames()[a*c.ridersPerBench()]);G();let d=_r(c.seatAssignments()[f]),h=d?c.students()[d]:null,u=d===void 0?"\u274C":(h==null?null:h.displayName)??f,x=h?h.name+`
grade: `+h.grade+`
housemates: `+(((t=c.housemateIndex()[h.id])==null?null:t.join(", "))??""):f;G(),Is("width",c.benchWidth()/2+"px"),Kt("x",i-c.seatRadius())("y",o-c.seatRadius()),G(),Ms(Ea("grade-",(h==null?null:h.grade)||"unknown")),ta("unoccupied",d===null)("unavailable",d===void 0)("hasHousemates",h?((n=c.housemateIndex()[h.id])==null?null:n.length)??!1:!1),We("label",u)("size",c.seatDiameter())("title",x),Kt("transform","translate("+l+","+o+")"),G(2),vt(x)}}function p2(e,r){if(e&1){let t=gt();Qr(0)(1),Mr(),M(2,"g",8),Se("click",function(){pe(t);let a=At(0),i=At(1),s=Q(4);return me(s.seatClick.emit({seatId:a,rider:i}))}),M(3,"title"),Y(4),L()()}if(e&2){let t,n,a=r.$index;Q(2);let i=At(0),s=At(1);Q();let o=At(0),c=At(1),l=Q(),f=a,d=f+i*l.ridersPerBench(),h=s+f*l.seatDiameter(),u=_r(o+1+l.rowSeatNames()[d]);G();let x=_r(l.seatAssignments()[u]),g=x?l.students()[x]:null,p=x===void 0?"\u274C":(g==null?null:g.displayName)??u,m=g?g.name+`
grade: `+g.grade+`
housemates: `+(((t=l.housemateIndex()[g.id])==null?null:t.join(", "))??""):u;G(),Ms(Ea("grade-",(g==null?null:g.grade)||"unknown")),ta("unoccupied",x===null)("unavailable",x===void 0)("hasHousemates",g?((n=l.housemateIndex()[g.id])==null?null:n.length)??!1:!1),We("label",p)("size",l.seatDiameter())("title",m),Kt("transform","translate("+h+","+c+")"),G(2),vt(m)}}function m2(e,r){if(e&1&&(Mr(),dt(0,"rect",7),ut(1,p2,5,16,":svg:g",9,ea)),e&2){Q();let t=At(1);Q();let n=At(1),a=Q();Kt("x",t-a.seatRadius())("y",n-a.seatRadius()),G(),ht(Bt(2,Po).constructor(a.ridersPerBench()))}}function x2(e,r){if(e&1&&(Qr(0)(1),tt(2,d2,6,20)(3,m2,3,3)),e&2){let t=r.$index;Q();let n=At(0),a=Q(),i=_r(t);G(),_r(i===0?a.centerX()-a.benchWidth():a.centerX()+a.seatDiameter()),G(),rt(a.shortRearBench()&&i===0&&n===a.rows()-1?2:3)}}function g2(e,r){if(e&1&&(Qr(0)(1),Mr(),M(2,"text",6),Y(3),L(),M(4,"text",1),Y(5),L(),ut(6,x2,4,3,null,null,ea)),e&2){let t=r.$index,n=Q(),a=_r(t);G();let i=_r(n.marginPx()+n.headerHeight()+n.seatRadius()+a*(n.rowSpacingPx()+n.seatDiameter()));G(),Kt("x",n.centerX()-n.benchWidth()-n.seatRadius()*1.25)("y",i),G(),Ve(" ",a+1," "),G(),Kt("x",n.centerX()+n.benchWidth()+n.seatRadius()*1.25)("y",i),G(),Ve(" ",a+1," "),G(),ht(Bt(8,Po).constructor(n.benchesPerRow()))}}function _2(e,r){if(e&1&&(Mr(),M(0,"text",10),Y(1),L(),M(2,"text",2),Y(3),L()),e&2){let t=r.$implicit,n=r.$index,a=Q(),o=At(15)+n*a.indexFontSize()*1.2;Kt("x",a.widthPx()-a.marginPx()-a.indexWidthPx()+10)("y",o),G(),Ve(" ",t[0],": "),G(),Kt("x",a.widthPx()-a.marginPx())("y",o),G(),Ve(" ",t[1]," ")}}var ds=class e{title=qt.required();rows=qt.required();ridersPerBench=qt.required();shortRearBench=qt(!1);students=qt({});seatAssignments=qt({});colorCoded=qt(!1);get _colorCoded(){return this.colorCoded()}seatClick=di();now=Ie(new Date);diagramSizeIn=Ie({width:8.5,height:11});marginSizeIn=Ie(.5);rowSpacingIn=Ie(.0625);headerFontSize=Ie(25);dpi=Ie(96);benchesPerRow=Ie(2);indexWidthIn=Ie(1.125);indexFontSize=Ie(9.25);ridersPerRow=Me(()=>this.ridersPerBench()*this.benchesPerRow());rowSeatNames=Me(()=>{let r=this.ridersPerRow(),t=[];for(let n=0;n<r;n++)t.push(String.fromCharCode(65+n));return t});headerHeight=Me(()=>this.headerFontSize()*1.5);widthPx=Me(()=>this.dpi()*this.diagramSizeIn().width*.99);heightPx=Me(()=>this.dpi()*this.diagramSizeIn().height*.99);marginPx=Me(()=>this.dpi()*this.marginSizeIn());rowSpacingPx=Me(()=>this.dpi()*this.rowSpacingIn());indexWidthPx=Me(()=>this.dpi()*this.indexWidthIn());availableHeight=Me(()=>this.heightPx()-this.marginPx()*2-this.headerHeight());availableWidth=Me(()=>this.widthPx()-this.marginPx()*2-this.indexWidthPx());seatDiameter=Me(()=>Math.min(this.availableHeight()/this.rows()-this.rowSpacingPx(),this.availableWidth()/(this.ridersPerRow()+3)));seatRadius=Me(()=>this.seatDiameter()/2);seatLabelFontSize=Me(()=>this.seatRadius()*.6);centerX=Me(()=>(this.widthPx()-this.indexWidthPx())/2);benchWidth=Me(()=>this.ridersPerBench()*this.seatDiameter());riderIndex=Me(()=>{let r=this.seatAssignments(),t=this.students();return console.log(t),Object.keys(r).filter(n=>!!r[n]).map(n=>[t[r[n]]?.displayName,n]).sort(([n],[a])=>n.localeCompare(a))});housemateIndex=Me(()=>{let r=this.students();return Object.values(r).reduce((t,n)=>(n.housemateIds?.forEach(a=>{t[n.id]=t[n.id]||[],t[n.id].push(r[a]?.displayName)}),t),{})});constructor(){yt(()=>console.log(this.riderIndex()))}static \u0275fac=function(t){return new(t||e)};static \u0275cmp=Ke({type:e,selectors:[["app-seating-diagram"]],hostVars:2,hostBindings:function(t,n){t&2&&ta("colorCoded",n._colorCoded)},inputs:{title:[1,"title"],rows:[1,"rows"],ridersPerBench:[1,"ridersPerBench"],shortRearBench:[1,"shortRearBench"],students:[1,"students"],seatAssignments:[1,"seatAssignments"],colorCoded:[1,"colorCoded"]},outputs:{seatClick:"seatClick"},decls:18,vars:22,consts:[["xmlns","http://www.w3.org/2000/svg",1,"page"],["text-anchor","start",1,"header"],["text-anchor","end"],["id","diagram"],["text-anchor","middle",1,"header"],["id","index"],["text-anchor","end",1,"header"],[1,"bench"],["busSeat","",3,"click","label","size","title"],["busSeat","",3,"label","size","class","unoccupied","unavailable","hasHousemates","title"],["text-anchor","start"]],template:function(t,n){t&1&&(Mr(),M(0,"svg",0)(1,"defs")(2,"style"),Y(3),L()(),M(4,"text",1),Y(5),L(),M(6,"text",2),Y(7),Zt(8,"date"),L(),M(9,"g",3),ut(10,h2,2,3,":svg:text",4,ui),ut(12,g2,8,9,null,null,ea),L(),M(14,"g",5),Qr(15),ut(16,_2,4,6,null,null,u2),L()()),t&2&&(ta("colorCoded",n.colorCoded()),Kt("width",n.widthPx())("height",n.heightPx())("viewBox","0 0 "+n.widthPx()+" "+n.heightPx()),G(3),f0(" .header { font-weight: bold; fill: #222; alignment-baseline: middle; font-size: ",n.headerFontSize(),"px; } .row-label { font-weight: bold; fill: #333; } .bench { width: ",n.ridersPerBench()*n.seatDiameter(),"px; height: ",n.seatDiameter(),"px; rx: ",n.seatRadius()/4,"px; ry: ",n.seatRadius()/4,"px; stroke: black; fill: none; } g.unoccupied { opacity: .3; } g.unavailable { opacity: .1; } #index text { font-weight: bold; fill: #222; font-size: ",n.indexFontSize(),"px; } "),G(),Kt("x",n.marginPx())("y",n.marginPx()),G(),Ve(" ",n.title()," "),G(),Kt("x",n.widthPx()-n.marginPx())("y",n.marginPx()),G(),Ve(" Created: ",Dn(8,17,n.now(),"shortDate")," "),G(3),ht(n.rowSeatNames()),G(2),ht(Bt(21,Po).constructor(n.rows())),G(3),_r(n.marginPx()+n.headerHeight()-n.seatRadius()/2),G(),ht(n.riderIndex()))},dependencies:[hs,ra],styles:[".colorCoded[_ngcontent-%COMP%]   .hasHousemates[_ngcontent-%COMP%]{fill:#00f}.colorCoded[_ngcontent-%COMP%]   .grade-K[_ngcontent-%COMP%]{stroke:red}.colorCoded[_ngcontent-%COMP%]   .grade-1[_ngcontent-%COMP%]{stroke:orange}.colorCoded[_ngcontent-%COMP%]   .grade-2[_ngcontent-%COMP%]{stroke:#ff0}.colorCoded[_ngcontent-%COMP%]   .grade-3[_ngcontent-%COMP%]{stroke:green}.colorCoded[_ngcontent-%COMP%]   .grade-4[_ngcontent-%COMP%]{stroke:#00f}.colorCoded[_ngcontent-%COMP%]   .grade-5[_ngcontent-%COMP%]{stroke:purple}.colorCoded[_ngcontent-%COMP%]   .grade-6[_ngcontent-%COMP%]{stroke:red}.colorCoded[_ngcontent-%COMP%]   .grade-7[_ngcontent-%COMP%]{stroke:orange}.colorCoded[_ngcontent-%COMP%]   .grade-8[_ngcontent-%COMP%]{stroke:#ff0}.colorCoded[_ngcontent-%COMP%]   .grade-9[_ngcontent-%COMP%]{stroke:green}.colorCoded[_ngcontent-%COMP%]   .grade-10[_ngcontent-%COMP%]{stroke:#00f}.colorCoded[_ngcontent-%COMP%]   .grade-11[_ngcontent-%COMP%]{stroke:purple}.colorCoded[_ngcontent-%COMP%]   .grade-12[_ngcontent-%COMP%]{stroke:brown}.colorCoded[_ngcontent-%COMP%]   .grade-K[_ngcontent-%COMP%]:not(.hasHousemates){fill:#fff}.page[_ngcontent-%COMP%]{background-color:#fff;box-shadow:0 0 5px #0000004d}@media print{.page[_ngcontent-%COMP%]{box-shadow:none}}"]})};var v2=(e,r)=>r.id;function w2(e,r){if(e&1&&(M(0,"div")(1,"h3"),Y(2),L(),M(3,"p"),Y(4),L()()),e&2){let t,n,a=Q();G(2),Ve("Selected Student: ",(t=a.selectedStudent())==null?null:t.displayName),G(2),Ve("Click a seat to assign ",(n=a.selectedStudent())==null?null:n.displayName," to that seat, or click their name below to unselect them.")}}function y2(e,r){if(e&1){let t=gt();M(0,"div",12),Se("click",function(){let a=pe(t).$implicit,i=Q();return me(i.selectedStudent.set(a))}),Y(1),L()}if(e&2){let t=r.$implicit;We("title",t.name+" ("+t.grade+")"),G(),hi("",t.displayName," (",t.grade,")")}}function S2(e,r){e&1&&(M(0,"div"),Y(1,"No unassigned students"),L())}var ps=class e{planService=ce(Dt);colorCoded=Ie(!1);selectedStudent=Ie(void 0);ridersPerBench=Ze(this.planService.currentPlan()?.ridersPerBench??3);planTitle=Me(()=>this.planService.currentPlan()?.name??"Seating Chart");busRows=Me(()=>this.planService.currentPlan()?.bus?.rows??13);shortRearBench=Me(()=>this.planService.currentPlan()?.bus?.shortRearBench??!0);seatAssignmentsMap=Me(()=>{let r=this.planService.currentPlan();return r?.seatAssignments?r.seatAssignments.reduce((t,n)=>(t[n.seatId]=n.studentId,t),{}):{}});studentMap=Me(()=>{let r=this.planService.currentPlan();return r?.students?r.students.reduce((t,n)=>(t[n.id]=n,t),{}):{}});assignedStudents=Me(()=>{let r=this.studentMap(),t=this.seatAssignmentsMap(),n=Object.values(t).filter(a=>a!=null);return Object.values(r).filter(a=>n.includes(a.id))});unassignedStudents=Me(()=>{let r=this.studentMap(),t=this.assignedStudents();return Object.values(r).filter(n=>!t.find(a=>a.id===n.id)).sort((n,a)=>n.displayName.localeCompare(a.displayName))});trackStudent(r,t){return t.id}constructor(){yt(()=>{let r=this.ridersPerBench(),t=this.planService.currentPlan();t&&t.ridersPerBench!==r&&this.planService.updatePlan(Qe(Ae({},t),{ridersPerBench:r}))})}clearSeatAssignments(){let r=this.planService.currentPlan();r&&this.planService.updatePlan(Qe(Ae({},r),{seatAssignments:[]}))}onSeatClick(r){if(!r||!this.planService.currentPlan())return;let n=this.selectedStudent(),a;r.rider&&(a=this.studentMap()[r.rider],this.updateSeat(r.seatId,null)),n&&this.updateSeat(r.seatId,n.id),this.selectedStudent.set(a)}updateSeat(r,t){let n=this.planService.currentPlan();if(!n)return;let a=n.seatAssignments??[];a=a.filter(i=>i.seatId!==r),t&&a.push({seatId:r,studentId:t}),this.planService.updatePlan(Qe(Ae({},n),{seatAssignments:a}))}static \u0275fac=function(t){return new(t||e)};static \u0275cmp=Ke({type:e,selectors:[["app-seating-step"]],inputs:{ridersPerBench:[1,"ridersPerBench"]},outputs:{ridersPerBench:"ridersPerBenchChange"},decls:25,vars:12,consts:[[1,"print-seating-diagram"],[1,"screen-only"],[1,"seating-form","screen-only"],["type","number","min","1","max","4","name","ridersPerBench","required","",3,"ngModelChange","ngModel"],[1,"seating-columns"],[1,"diagram-column"],[3,"seatClick","title","rows","ridersPerBench","shortRearBench","seatAssignments","students","colorCoded"],[1,"controls-column","screen-only"],[3,"click"],["type","checkbox","name","colorCoded","id","colorCoded",3,"ngModelChange","ngModel"],["for","colorCoded"],[1,"available-student",3,"title"],[1,"available-student",3,"click","title"]],template:function(t,n){t&1&&(M(0,"div",0)(1,"h3",1),Y(2,"Seating Assignments Step"),L(),M(3,"form",2)(4,"label"),Y(5,"Riders per bench: "),M(6,"input",3),ot("ngModelChange",function(i){return st(n.ridersPerBench,i)||(n.ridersPerBench=i),i}),L()()(),M(7,"div",4)(8,"div",5)(9,"app-seating-diagram",6),Se("seatClick",function(i){return n.onSeatClick(i)}),L()(),M(10,"div",7)(11,"div")(12,"button",8),Se("click",function(){return n.clearSeatAssignments()}),Y(13,"Delete All Seat Assignments"),L()(),M(14,"div")(15,"input",9),ot("ngModelChange",function(i){return st(n.colorCoded,i)||(n.colorCoded=i),i}),L(),M(16,"label",10),Y(17,"color-code seats"),L()(),tt(18,w2,5,2,"div"),M(19,"div")(20,"h3"),Y(21),L(),ut(22,y2,2,3,"div",11,v2,!1,S2,2,0,"div"),L()()()()),t&2&&(G(6),it("ngModel",n.ridersPerBench),G(3),We("title",n.planTitle())("rows",n.busRows())("ridersPerBench",n.ridersPerBench())("shortRearBench",n.shortRearBench())("seatAssignments",n.seatAssignmentsMap())("students",n.studentMap())("colorCoded",n.colorCoded()),G(6),it("ngModel",n.colorCoded),G(3),rt(n.selectedStudent()?18:-1),G(3),Ve("Unassigned Students (",n.unassignedStudents().length,")"),G(),ht(n.unassignedStudents()))},dependencies:[Ar,Yr,Tr,wi,dn,br,jr,Kr,b0,T0,Fr,$r,ds],styles:["@media print{@page{size:letter portrait}app-seating-diagram[_ngcontent-%COMP%]{position:absolute;top:0;left:0}}.seating-form[_ngcontent-%COMP%]{max-width:400px;display:flex;flex-direction:column;gap:12px}.seating-columns[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex-wrap:wrap;gap:2rem;align-items:flex-start;margin-top:2rem}.diagram-column[_ngcontent-%COMP%]{min-width:0}.controls-column[_ngcontent-%COMP%]{min-width:250px;max-width:350px;display:flex;flex-direction:column;gap:1.5rem}.edit-seat[_ngcontent-%COMP%]{margin-top:1.5rem}.available-student[_ngcontent-%COMP%]{cursor:pointer;padding:.25rem}"]})};var k2=()=>["../bus"];function E2(e,r){if(e&1&&(M(0,"div",3),Y(1),L()),e&2){let t=Q();G(),vt(t.errorMsg())}}var ms=class e{planService=ce(Dt);router=ce(hn);activatedRoute=ce(xi);currentPlan=this.planService.currentPlan;planName=Ze("");planDescription=Ze("");errorMsg=Ie("");constructor(){yt(()=>{let r=this.currentPlan()?.name??"";r&&this.planName()!==r&&this.planName.set(r)})}save(){this.errorMsg.set("");let r=this.currentPlan();r&&(r.name=this.planName().trim(),r.description=this.planDescription().trim(),this.planService.updatePlan(r))}static \u0275fac=function(t){return new(t||e)};static \u0275cmp=Ke({type:e,selectors:[["app-name-step"]],inputs:{planName:[1,"planName"],planDescription:[1,"planDescription"]},outputs:{planName:"planNameChange",planDescription:"planDescriptionChange"},decls:12,vars:5,consts:[["name","planName","required","",3,"ngModelChange","input","ngModel"],["name","planDescription","rows","3",3,"ngModelChange","input","ngModel"],[3,"routerLink"],[2,"color","red","margin-top","1em"]],template:function(t,n){t&1&&(M(0,"div")(1,"h3"),Y(2,"Name Your Transportation Plan"),L(),M(3,"label"),Y(4,"Plan Name: "),M(5,"input",0),ot("ngModelChange",function(i){return st(n.planName,i)||(n.planName=i),i}),Se("input",function(){return n.save()}),L()(),M(6,"label"),Y(7,"Description: "),M(8,"textarea",1),ot("ngModelChange",function(i){return st(n.planDescription,i)||(n.planDescription=i),i}),Se("input",function(){return n.save()}),L()(),M(9,"button",2),Y(10,"Next"),L(),tt(11,E2,2,1,"div",3),L()),t&2&&(G(5),it("ngModel",n.planName),G(3),it("ngModel",n.planDescription),G(),We("routerLink",Bt(4,k2)),G(2),rt(n.errorMsg()?11:-1))},dependencies:[Ar,Tr,br,Kr,Fr,Lt],encapsulation:2})};var Bs={path:"plans/:id",component:bi,data:{title:()=>{let e=ce(Dt);return Me(()=>{let r=e.currentPlan();return r?.name?r.name:"Transportation Plan"})}},children:[{path:"name",component:ms},{path:"bus",component:Di},{path:"schools",component:Ai,data:{displayName:"Schools & Grades"}},{path:"stops",component:Ri},{path:"routes",component:Oi,data:{displayName:"Route Schedules"}},{path:"students",component:us},{path:"seating",component:ps},{path:"checklist",component:(await import("./chunk-LZAMCDIN.js")).ChecklistStepComponent,data:{displayName:"Checklist"}},{path:"",redirectTo:"name",pathMatch:"full"}]},uf=[{path:"",component:Ti,pathMatch:"full",title:"Transportation Plans"},Bs];var xs=class e extends _i{updateTitle=()=>{};buildTitle=()=>"";getResolvedTitleForRoute=()=>"";static \u0275fac=(()=>{let r;return function(n){return(r||(r=ya(e)))(n||e)}})();static \u0275prov=Je({token:e,factory:e.\u0275fac,providedIn:"root"})};var No="Service workers are disabled or not supported by this browser",xa=class{serviceWorker;worker;registration;events;constructor(r,t){if(this.serviceWorker=r,!r)this.worker=this.events=this.registration=new Kn(n=>n.error(new bn(5601,!1)));else{let n=null,a=new ur;this.worker=new Kn(l=>(n!==null&&l.next(n),a.subscribe(f=>l.next(f))));let i=()=>{let{controller:l}=r;l!==null&&(n=l,a.next(n))};r.addEventListener("controllerchange",i),i(),this.registration=this.worker.pipe(qn(()=>r.getRegistration().then(l=>{if(!l)throw new bn(5601,!1);return l})));let s=new ur;this.events=s.asObservable();let o=l=>{let{data:f}=l;f?.type&&s.next(f)};r.addEventListener("message",o),t?.get(un,null,{optional:!0})?.onDestroy(()=>{r.removeEventListener("controllerchange",i),r.removeEventListener("message",o)})}}postMessage(r,t){return new Promise(n=>{this.worker.pipe(Zn(1)).subscribe(a=>{a.postMessage(Ae({action:r},t)),n()})})}postMessageWithOperation(r,t,n){let a=this.waitForOperationCompleted(n),i=this.postMessage(r,t);return Promise.all([i,a]).then(([,s])=>s)}generateNonce(){return Math.round(Math.random()*1e7)}eventsOfType(r){let t;return typeof r=="string"?t=n=>n.type===r:t=n=>r.includes(n.type),this.events.pipe(Tn(t))}nextEventOfType(r){return this.eventsOfType(r).pipe(Zn(1))}waitForOperationCompleted(r){return new Promise((t,n)=>{this.eventsOfType("OPERATION_COMPLETED").pipe(Tn(a=>a.nonce===r),Zn(1),Cn(a=>{if(a.result!==void 0)return a.result;throw new Error(a.error)})).subscribe({next:t,error:n})})}get isEnabled(){return!!this.serviceWorker}},C2=(()=>{class e{sw;messages;notificationClicks;notificationCloses;pushSubscriptionChanges;subscription;get isEnabled(){return this.sw.isEnabled}pushManager=null;subscriptionChanges=new ur;constructor(t){if(this.sw=t,!t.isEnabled){this.messages=fn,this.notificationClicks=fn,this.notificationCloses=fn,this.pushSubscriptionChanges=fn,this.subscription=fn;return}this.messages=this.sw.eventsOfType("PUSH").pipe(Cn(a=>a.data)),this.notificationClicks=this.sw.eventsOfType("NOTIFICATION_CLICK").pipe(Cn(a=>a.data)),this.notificationCloses=this.sw.eventsOfType("NOTIFICATION_CLOSE").pipe(Cn(a=>a.data)),this.pushSubscriptionChanges=this.sw.eventsOfType("PUSH_SUBSCRIPTION_CHANGE").pipe(Cn(a=>a.data)),this.pushManager=this.sw.registration.pipe(Cn(a=>a.pushManager));let n=this.pushManager.pipe(qn(a=>a.getSubscription()));this.subscription=new Kn(a=>{let i=n.subscribe(a),s=this.subscriptionChanges.subscribe(a);return()=>{i.unsubscribe(),s.unsubscribe()}})}requestSubscription(t){if(!this.sw.isEnabled||this.pushManager===null)return Promise.reject(new Error(No));let n={userVisibleOnly:!0},a=this.decodeBase64(t.serverPublicKey.replace(/_/g,"/").replace(/-/g,"+")),i=new Uint8Array(new ArrayBuffer(a.length));for(let s=0;s<a.length;s++)i[s]=a.charCodeAt(s);return n.applicationServerKey=i,new Promise((s,o)=>{this.pushManager.pipe(qn(c=>c.subscribe(n)),Zn(1)).subscribe({next:c=>{this.subscriptionChanges.next(c),s(c)},error:o})})}unsubscribe(){if(!this.sw.isEnabled)return Promise.reject(new Error(No));let t=n=>{if(n===null)throw new bn(5602,!1);return n.unsubscribe().then(a=>{if(!a)throw new bn(5603,!1);this.subscriptionChanges.next(null)})};return new Promise((n,a)=>{this.subscription.pipe(Zn(1),qn(t)).subscribe({next:n,error:a})})}decodeBase64(t){return atob(t)}static \u0275fac=function(n){return new(n||e)(Ps(xa))};static \u0275prov=Je({token:e,factory:e.\u0275fac})}return e})(),T2=(()=>{class e{sw;versionUpdates;unrecoverable;get isEnabled(){return this.sw.isEnabled}ongoingCheckForUpdate=null;constructor(t){if(this.sw=t,!t.isEnabled){this.versionUpdates=fn,this.unrecoverable=fn;return}this.versionUpdates=this.sw.eventsOfType(["VERSION_DETECTED","VERSION_INSTALLATION_FAILED","VERSION_READY","NO_NEW_VERSION_DETECTED","VERSION_FAILED"]),this.unrecoverable=this.sw.eventsOfType("UNRECOVERABLE_STATE")}checkForUpdate(){if(!this.sw.isEnabled)return Promise.reject(new Error(No));if(this.ongoingCheckForUpdate)return this.ongoingCheckForUpdate;let t=this.sw.generateNonce();return this.ongoingCheckForUpdate=this.sw.postMessageWithOperation("CHECK_FOR_UPDATES",{nonce:t},t).finally(()=>{this.ongoingCheckForUpdate=null}),this.ongoingCheckForUpdate}activateUpdate(){if(!this.sw.isEnabled)return Promise.reject(new bn(5601,!1));let t=this.sw.generateNonce();return this.sw.postMessageWithOperation("ACTIVATE_UPDATE",{nonce:t},t)}static \u0275fac=function(n){return new(n||e)(Ps(xa))};static \u0275prov=Je({token:e,factory:e.\u0275fac})}return e})();var mf=new Jn("");function b2(){let e=ce(ti);if(!("serviceWorker"in navigator&&e.enabled!==!1))return;let r=ce(mf),t=ce(Lr),n=ce(un);t.runOutsideAngular(()=>{let a=navigator.serviceWorker,i=()=>a.controller?.postMessage({action:"INITIALIZE"});a.addEventListener("controllerchange",i),n.onDestroy(()=>{a.removeEventListener("controllerchange",i)})}),t.runOutsideAngular(()=>{let a,{registrationStrategy:i}=e;if(typeof i=="function")a=new Promise(s=>i().subscribe(()=>s()));else{let[s,...o]=(i||"registerWhenStable:30000").split(":");switch(s){case"registerImmediately":a=Promise.resolve();break;case"registerWithDelay":a=hf(+o[0]||0);break;case"registerWhenStable":a=Promise.race([n.whenStable(),hf(+o[0])]);break;default:throw new bn(5600,!1)}}a.then(()=>{n.destroyed||navigator.serviceWorker.register(r,{scope:e.scope,updateViaCache:e.updateViaCache,type:e.type}).catch(s=>console.error(qo(5604,!1)))})})}function hf(e){return new Promise(r=>setTimeout(r,e))}function F2(e,r){return new xa(e.enabled!==!1?navigator.serviceWorker:void 0,r)}var ti=class{enabled;updateViaCache;type;scope;registrationStrategy};function xf(e,r={}){return Jo([C2,T2,{provide:mf,useValue:e},{provide:ti,useValue:r},{provide:xa,useFactory:F2,deps:[ti,gr]},s0(b2)])}var gf={providers:[e0(),h0(),{provide:_i,useClass:xs},w0(uf,y0()),E0(),xf("ngsw-worker.js",{enabled:!d0(),registrationStrategy:"registerWhenStable:30000"}),{provide:Window,useValue:window}]};var _f="BetterBus",gs=class e{titleService=ce(_0);routeSignalService=ce(C0);injector=ce(gr);title=Me(()=>{let r=this.routeSignalService.currentRoute();return r?Qo(this.injector,()=>this.getTitle(r.snapshot)):""});constructor(){yt(()=>{let r=this.title();this.titleService.setTitle(r?`${r} | ${_f}`:_f)})}getTitle(r){let t=r?.root??null,n=[];for(;t;){let a=t.routeConfig?.data?.title??t.routeConfig?.title;if(a){if(typeof a=="string")n.push(a);else if(typeof a=="function"){let i=a(t);typeof i=="string"?n.push(i):typeof i=="function"&&n.push(i())}else if(typeof a=="object"&&"resolve"in a)try{let s=ce(a).resolve(t);typeof s=="string"&&n.push(s)}catch{}}t=t.firstChild}return n.join(" > ")}static \u0275fac=function(t){return new(t||e)};static \u0275prov=Je({token:e,factory:e.\u0275fac,providedIn:"root"})};var Io;try{Io=typeof Intl<"u"&&Intl.v8BreakIterator}catch{Io=!1}var jn=(()=>{class e{_platformId=ce(r0);isBrowser=this._platformId?x0(this._platformId):typeof document=="object"&&!!document;EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent);TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent);BLINK=this.isBrowser&&!!(window.chrome||Io)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT;WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT;IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window);FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent);ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT;SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT;constructor(){}static \u0275fac=function(n){return new(n||e)};static \u0275prov=Je({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function Mo(e){return e.composedPath?e.composedPath()[0]:e.target}function Bo(){return typeof __karma__<"u"&&!!__karma__||typeof jasmine<"u"&&!!jasmine||typeof jest<"u"&&!!jest||typeof Mocha<"u"&&!!Mocha}var _s=new WeakMap,Lo=(()=>{class e{_appRef;_injector=ce(gr);_environmentInjector=ce(Qn);load(t){let n=this._appRef=this._appRef||this._injector.get(un),a=_s.get(n);a||(a={loaders:new Set,refs:[]},_s.set(n,a),n.onDestroy(()=>{_s.get(n)?.refs.forEach(i=>i.destroy()),_s.delete(n)})),a.loaders.has(t)||(a.loaders.add(t),a.refs.push(pi(t,{environmentInjector:this._environmentInjector})))}static \u0275fac=function(n){return new(n||e)};static \u0275prov=Je({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function Tt(e){return e==null?"":typeof e=="string"?e:`${e}px`}function Uo(e){return Array.isArray(e)?e:[e]}function vf(e){return e instanceof Fn?e.nativeElement:e}var A2=new Jn("cdk-dir-doc",{providedIn:"root",factory:D2});function D2(){return ce(Br)}var R2=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Adlm|Arab|Hebr|Nkoo|Rohg|Thaa))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i;function O2(e){let r=e?.toLowerCase()||"";return r==="auto"&&typeof navigator<"u"&&navigator?.language?R2.test(navigator.language)?"rtl":"ltr":r==="rtl"?"rtl":"ltr"}var wf=(()=>{class e{get value(){return this.valueSignal()}valueSignal=Ie("ltr");change=new ci;constructor(){let t=ce(A2,{optional:!0});if(t){let n=t.body?t.body.dir:null,a=t.documentElement?t.documentElement.dir:null;this.valueSignal.set(O2(n||a||"ltr"))}}ngOnDestroy(){this.change.complete()}static \u0275fac=function(n){return new(n||e)};static \u0275prov=Je({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var $n;function yf(){if($n==null){if(typeof document!="object"||!document||typeof Element!="function"||!Element)return $n=!1,$n;if(document.documentElement?.style&&"scrollBehavior"in document.documentElement.style)$n=!0;else{let e=Element.prototype.scrollTo;e?$n=!/\{\s*\[native code\]\s*\}/.test(e.toString()):$n=!1}}return $n}var M2=20,Wo=(()=>{class e{_ngZone=ce(Lr);_platform=ce(jn);_renderer=ce(An).createRenderer(null,null);_cleanupGlobalListener;constructor(){}_scrolled=new ur;_scrolledCount=0;scrollContainers=new Map;register(t){this.scrollContainers.has(t)||this.scrollContainers.set(t,t.elementScrolled().subscribe(()=>this._scrolled.next(t)))}deregister(t){let n=this.scrollContainers.get(t);n&&(n.unsubscribe(),this.scrollContainers.delete(t))}scrolled(t=M2){return this._platform.isBrowser?new Kn(n=>{this._cleanupGlobalListener||(this._cleanupGlobalListener=this._ngZone.runOutsideAngular(()=>this._renderer.listen("document","scroll",()=>this._scrolled.next())));let a=t>0?this._scrolled.pipe(Os(t)).subscribe(n):this._scrolled.subscribe(n);return this._scrolledCount++,()=>{a.unsubscribe(),this._scrolledCount--,this._scrolledCount||(this._cleanupGlobalListener?.(),this._cleanupGlobalListener=void 0)}}):Zo()}ngOnDestroy(){this._cleanupGlobalListener?.(),this._cleanupGlobalListener=void 0,this.scrollContainers.forEach((t,n)=>this.deregister(n)),this._scrolled.complete()}ancestorScrolled(t,n){let a=this.getAncestorScrollContainers(t);return this.scrolled(n).pipe(Tn(i=>!i||a.indexOf(i)>-1))}getAncestorScrollContainers(t){let n=[];return this.scrollContainers.forEach((a,i)=>{this._scrollableContainsElement(i,t)&&n.push(i)}),n}_scrollableContainsElement(t,n){let a=vf(n),i=t.getElementRef().nativeElement;do if(a==i)return!0;while(a=a.parentElement);return!1}static \u0275fac=function(n){return new(n||e)};static \u0275prov=Je({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var B2=20,ri=(()=>{class e{_platform=ce(jn);_listeners;_viewportSize;_change=new ur;_document=ce(Br);constructor(){let t=ce(Lr),n=ce(An).createRenderer(null,null);t.runOutsideAngular(()=>{if(this._platform.isBrowser){let a=i=>this._change.next(i);this._listeners=[n.listen("window","resize",a),n.listen("window","orientationchange",a)]}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){this._listeners?.forEach(t=>t()),this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();let t={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),t}getViewportRect(){let t=this.getViewportScrollPosition(),{width:n,height:a}=this.getViewportSize();return{top:t.top,left:t.left,bottom:t.top+a,right:t.left+n,height:a,width:n}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};let t=this._document,n=this._getWindow(),a=t.documentElement,i=a.getBoundingClientRect(),s=-i.top||t.body.scrollTop||n.scrollY||a.scrollTop||0,o=-i.left||t.body.scrollLeft||n.scrollX||a.scrollLeft||0;return{top:s,left:o}}change(t=B2){return t>0?this._change.pipe(Os(t)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){let t=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:t.innerWidth,height:t.innerHeight}:{width:0,height:0}}static \u0275fac=function(n){return new(n||e)};static \u0275prov=Je({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var ni=class{_attachedHost;attach(r){return this._attachedHost=r,r.attach(this)}detach(){let r=this._attachedHost;r!=null&&(this._attachedHost=null,r.detach())}get isAttached(){return this._attachedHost!=null}setAttachedHost(r){this._attachedHost=r}},Vo=class extends ni{component;viewContainerRef;injector;projectableNodes;constructor(r,t,n,a){super(),this.component=r,this.viewContainerRef=t,this.injector=n,this.projectableNodes=a}},ga=class extends ni{templateRef;viewContainerRef;context;injector;constructor(r,t,n,a){super(),this.templateRef=r,this.viewContainerRef=t,this.context=n,this.injector=a}get origin(){return this.templateRef.elementRef}attach(r,t=this.context){return this.context=t,super.attach(r)}detach(){return this.context=void 0,super.detach()}},Ho=class extends ni{element;constructor(r){super(),this.element=r instanceof Fn?r.nativeElement:r}},zo=class{_attachedPortal;_disposeFn;_isDisposed=!1;hasAttached(){return!!this._attachedPortal}attach(r){if(r instanceof Vo)return this._attachedPortal=r,this.attachComponentPortal(r);if(r instanceof ga)return this._attachedPortal=r,this.attachTemplatePortal(r);if(this.attachDomPortal&&r instanceof Ho)return this._attachedPortal=r,this.attachDomPortal(r)}attachDomPortal=null;detach(){this._attachedPortal&&(this._attachedPortal.setAttachedHost(null),this._attachedPortal=null),this._invokeDisposeFn()}dispose(){this.hasAttached()&&this.detach(),this._invokeDisposeFn(),this._isDisposed=!0}setDisposeFn(r){this._disposeFn=r}_invokeDisposeFn(){this._disposeFn&&(this._disposeFn(),this._disposeFn=null)}},vs=class extends zo{outletElement;_appRef;_defaultInjector;constructor(r,t,n){super(),this.outletElement=r,this._appRef=t,this._defaultInjector=n}attachComponentPortal(r){let t;if(r.viewContainerRef){let n=r.injector||r.viewContainerRef.injector,a=n.get(a0,null,{optional:!0})||void 0;t=r.viewContainerRef.createComponent(r.component,{index:r.viewContainerRef.length,injector:n,ngModuleRef:a,projectableNodes:r.projectableNodes||void 0}),this.setDisposeFn(()=>t.destroy())}else{let n=this._appRef,a=r.injector||this._defaultInjector||gr.NULL,i=a.get(Qn,n.injector);t=pi(r.component,{elementInjector:a,environmentInjector:i,projectableNodes:r.projectableNodes||void 0}),n.attachView(t.hostView),this.setDisposeFn(()=>{n.viewCount>0&&n.detachView(t.hostView),t.destroy()})}return this.outletElement.appendChild(this._getComponentRootNode(t)),this._attachedPortal=r,t}attachTemplatePortal(r){let t=r.viewContainerRef,n=t.createEmbeddedView(r.templateRef,r.context,{injector:r.injector});return n.rootNodes.forEach(a=>this.outletElement.appendChild(a)),n.detectChanges(),this.setDisposeFn(()=>{let a=t.indexOf(n);a!==-1&&t.remove(a)}),this._attachedPortal=r,n}attachDomPortal=r=>{let t=r.element;t.parentNode;let n=this.outletElement.ownerDocument.createComment("dom-portal");t.parentNode.insertBefore(n,t),this.outletElement.appendChild(t),this._attachedPortal=r,super.setDisposeFn(()=>{n.parentNode&&n.parentNode.replaceChild(t,n)})};dispose(){super.dispose(),this.outletElement.remove()}_getComponentRootNode(r){return r.hostView.rootNodes[0]}};var Xo={},kf=(()=>{class e{_appId=ce(t0);getId(t){return this._appId!=="ng"&&(t+=this._appId),Xo.hasOwnProperty(t)||(Xo[t]=0),`${t}${Xo[t]++}`}static \u0275fac=function(n){return new(n||e)};static \u0275prov=Je({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var Ef=yf();function Rf(e){return new ws(e.get(ri),e.get(Br))}var ws=class{_viewportRuler;_previousHTMLStyles={top:"",left:""};_previousScrollPosition;_isEnabled=!1;_document;constructor(r,t){this._viewportRuler=r,this._document=t}attach(){}enable(){if(this._canBeEnabled()){let r=this._document.documentElement;this._previousScrollPosition=this._viewportRuler.getViewportScrollPosition(),this._previousHTMLStyles.left=r.style.left||"",this._previousHTMLStyles.top=r.style.top||"",r.style.left=Tt(-this._previousScrollPosition.left),r.style.top=Tt(-this._previousScrollPosition.top),r.classList.add("cdk-global-scrollblock"),this._isEnabled=!0}}disable(){if(this._isEnabled){let r=this._document.documentElement,t=this._document.body,n=r.style,a=t.style,i=n.scrollBehavior||"",s=a.scrollBehavior||"";this._isEnabled=!1,n.left=this._previousHTMLStyles.left,n.top=this._previousHTMLStyles.top,r.classList.remove("cdk-global-scrollblock"),Ef&&(n.scrollBehavior=a.scrollBehavior="auto"),window.scroll(this._previousScrollPosition.left,this._previousScrollPosition.top),Ef&&(n.scrollBehavior=i,a.scrollBehavior=s)}}_canBeEnabled(){if(this._document.documentElement.classList.contains("cdk-global-scrollblock")||this._isEnabled)return!1;let t=this._document.documentElement,n=this._viewportRuler.getViewportSize();return t.scrollHeight>n.height||t.scrollWidth>n.width}};function Of(e,r){return new ys(e.get(Wo),e.get(Lr),e.get(ri),r)}var ys=class{_scrollDispatcher;_ngZone;_viewportRuler;_config;_scrollSubscription=null;_overlayRef;_initialScrollPosition;constructor(r,t,n,a){this._scrollDispatcher=r,this._ngZone=t,this._viewportRuler=n,this._config=a}attach(r){this._overlayRef,this._overlayRef=r}enable(){if(this._scrollSubscription)return;let r=this._scrollDispatcher.scrolled(0).pipe(Tn(t=>!t||!this._overlayRef.overlayElement.contains(t.getElementRef().nativeElement)));this._config&&this._config.threshold&&this._config.threshold>1?(this._initialScrollPosition=this._viewportRuler.getViewportScrollPosition().top,this._scrollSubscription=r.subscribe(()=>{let t=this._viewportRuler.getViewportScrollPosition().top;Math.abs(t-this._initialScrollPosition)>this._config.threshold?this._detach():this._overlayRef.updatePosition()})):this._scrollSubscription=r.subscribe(this._detach)}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}_detach=()=>{this.disable(),this._overlayRef.hasAttached()&&this._ngZone.run(()=>this._overlayRef.detach())}};var ai=class{enable(){}disable(){}attach(){}};function Go(e,r){return r.some(t=>{let n=e.bottom<t.top,a=e.top>t.bottom,i=e.right<t.left,s=e.left>t.right;return n||a||i||s})}function Cf(e,r){return r.some(t=>{let n=e.top<t.top,a=e.bottom>t.bottom,i=e.left<t.left,s=e.right>t.right;return n||a||i||s})}function Pf(e,r){return new Ss(e.get(Wo),e.get(ri),e.get(Lr),r)}var Ss=class{_scrollDispatcher;_viewportRuler;_ngZone;_config;_scrollSubscription=null;_overlayRef;constructor(r,t,n,a){this._scrollDispatcher=r,this._viewportRuler=t,this._ngZone=n,this._config=a}attach(r){this._overlayRef,this._overlayRef=r}enable(){if(!this._scrollSubscription){let r=this._config?this._config.scrollThrottle:0;this._scrollSubscription=this._scrollDispatcher.scrolled(r).subscribe(()=>{if(this._overlayRef.updatePosition(),this._config&&this._config.autoClose){let t=this._overlayRef.overlayElement.getBoundingClientRect(),{width:n,height:a}=this._viewportRuler.getViewportSize();Go(t,[{width:n,height:a,bottom:a,right:n,top:0,left:0}])&&(this.disable(),this._ngZone.run(()=>this._overlayRef.detach()))}})}}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}},Nf=(()=>{class e{_injector=ce(gr);constructor(){}noop=()=>new ai;close=t=>Of(this._injector,t);block=()=>Rf(this._injector);reposition=t=>Pf(this._injector,t);static \u0275fac=function(n){return new(n||e)};static \u0275prov=Je({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),ks=class{positionStrategy;scrollStrategy=new ai;panelClass="";hasBackdrop=!1;backdropClass="cdk-overlay-dark-backdrop";disableAnimations;width;height;minWidth;minHeight;maxWidth;maxHeight;direction;disposeOnNavigation=!1;constructor(r){if(r){let t=Object.keys(r);for(let n of t)r[n]!==void 0&&(this[n]=r[n])}}};var Es=class{connectionPair;scrollableViewProperties;constructor(r,t){this.connectionPair=r,this.scrollableViewProperties=t}};var If=(()=>{class e{_attachedOverlays=[];_document=ce(Br);_isAttached;constructor(){}ngOnDestroy(){this.detach()}add(t){this.remove(t),this._attachedOverlays.push(t)}remove(t){let n=this._attachedOverlays.indexOf(t);n>-1&&this._attachedOverlays.splice(n,1),this._attachedOverlays.length===0&&this.detach()}static \u0275fac=function(n){return new(n||e)};static \u0275prov=Je({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),Mf=(()=>{class e extends If{_ngZone=ce(Lr);_renderer=ce(An).createRenderer(null,null);_cleanupKeydown;add(t){super.add(t),this._isAttached||(this._ngZone.runOutsideAngular(()=>{this._cleanupKeydown=this._renderer.listen("body","keydown",this._keydownListener)}),this._isAttached=!0)}detach(){this._isAttached&&(this._cleanupKeydown?.(),this._isAttached=!1)}_keydownListener=t=>{let n=this._attachedOverlays;for(let a=n.length-1;a>-1;a--)if(n[a]._keydownEvents.observers.length>0){this._ngZone.run(()=>n[a]._keydownEvents.next(t));break}};static \u0275fac=(()=>{let t;return function(a){return(t||(t=ya(e)))(a||e)}})();static \u0275prov=Je({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),Bf=(()=>{class e extends If{_platform=ce(jn);_ngZone=ce(Lr);_renderer=ce(An).createRenderer(null,null);_cursorOriginalValue;_cursorStyleIsSet=!1;_pointerDownEventTarget;_cleanups;add(t){if(super.add(t),!this._isAttached){let n=this._document.body,a={capture:!0},i=this._renderer;this._cleanups=this._ngZone.runOutsideAngular(()=>[i.listen(n,"pointerdown",this._pointerDownListener,a),i.listen(n,"click",this._clickListener,a),i.listen(n,"auxclick",this._clickListener,a),i.listen(n,"contextmenu",this._clickListener,a)]),this._platform.IOS&&!this._cursorStyleIsSet&&(this._cursorOriginalValue=n.style.cursor,n.style.cursor="pointer",this._cursorStyleIsSet=!0),this._isAttached=!0}}detach(){this._isAttached&&(this._cleanups?.forEach(t=>t()),this._cleanups=void 0,this._platform.IOS&&this._cursorStyleIsSet&&(this._document.body.style.cursor=this._cursorOriginalValue,this._cursorStyleIsSet=!1),this._isAttached=!1)}_pointerDownListener=t=>{this._pointerDownEventTarget=Mo(t)};_clickListener=t=>{let n=Mo(t),a=t.type==="click"&&this._pointerDownEventTarget?this._pointerDownEventTarget:n;this._pointerDownEventTarget=null;let i=this._attachedOverlays.slice();for(let s=i.length-1;s>-1;s--){let o=i[s];if(o._outsidePointerEvents.observers.length<1||!o.hasAttached())continue;if(Tf(o.overlayElement,n)||Tf(o.overlayElement,a))break;let c=o._outsidePointerEvents;this._ngZone?this._ngZone.run(()=>c.next(t)):c.next(t)}};static \u0275fac=(()=>{let t;return function(a){return(t||(t=ya(e)))(a||e)}})();static \u0275prov=Je({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function Tf(e,r){let t=typeof ShadowRoot<"u"&&ShadowRoot,n=r;for(;n;){if(n===e)return!0;n=t&&n instanceof ShadowRoot?n.host:n.parentNode}return!1}var Lf=(()=>{class e{static \u0275fac=function(n){return new(n||e)};static \u0275cmp=Ke({type:e,selectors:[["ng-component"]],hostAttrs:["cdk-overlay-style-loader",""],decls:0,vars:0,template:function(n,a){},styles:[`.cdk-overlay-container,.cdk-global-overlay-wrapper{pointer-events:none;top:0;left:0;height:100%;width:100%}.cdk-overlay-container{position:fixed}@layer cdk-overlay{.cdk-overlay-container{z-index:1000}}.cdk-overlay-container:empty{display:none}.cdk-global-overlay-wrapper{display:flex;position:absolute}@layer cdk-overlay{.cdk-global-overlay-wrapper{z-index:1000}}.cdk-overlay-pane{position:absolute;pointer-events:auto;box-sizing:border-box;display:flex;max-width:100%;max-height:100%}@layer cdk-overlay{.cdk-overlay-pane{z-index:1000}}.cdk-overlay-backdrop{position:absolute;top:0;bottom:0;left:0;right:0;pointer-events:auto;-webkit-tap-highlight-color:rgba(0,0,0,0);opacity:0;touch-action:manipulation}@layer cdk-overlay{.cdk-overlay-backdrop{z-index:1000;transition:opacity 400ms cubic-bezier(0.25, 0.8, 0.25, 1)}}@media(prefers-reduced-motion){.cdk-overlay-backdrop{transition-duration:1ms}}.cdk-overlay-backdrop-showing{opacity:1}@media(forced-colors: active){.cdk-overlay-backdrop-showing{opacity:.6}}@layer cdk-overlay{.cdk-overlay-dark-backdrop{background:rgba(0,0,0,.32)}}.cdk-overlay-transparent-backdrop{transition:visibility 1ms linear,opacity 1ms linear;visibility:hidden;opacity:1}.cdk-overlay-transparent-backdrop.cdk-overlay-backdrop-showing,.cdk-high-contrast-active .cdk-overlay-transparent-backdrop{opacity:0;visibility:visible}.cdk-overlay-backdrop-noop-animation{transition:none}.cdk-overlay-connected-position-bounding-box{position:absolute;display:flex;flex-direction:column;min-width:1px;min-height:1px}@layer cdk-overlay{.cdk-overlay-connected-position-bounding-box{z-index:1000}}.cdk-global-scrollblock{position:fixed;width:100%;overflow-y:scroll}
`],encapsulation:2,changeDetection:0})}return e})(),Uf=(()=>{class e{_platform=ce(jn);_containerElement;_document=ce(Br);_styleLoader=ce(Lo);constructor(){}ngOnDestroy(){this._containerElement?.remove()}getContainerElement(){return this._loadStyles(),this._containerElement||this._createContainer(),this._containerElement}_createContainer(){let t="cdk-overlay-container";if(this._platform.isBrowser||Bo()){let a=this._document.querySelectorAll(`.${t}[platform="server"], .${t}[platform="test"]`);for(let i=0;i<a.length;i++)a[i].remove()}let n=this._document.createElement("div");n.classList.add(t),Bo()?n.setAttribute("platform","test"):this._platform.isBrowser||n.setAttribute("platform","server"),this._document.body.appendChild(n),this._containerElement=n}_loadStyles(){this._styleLoader.load(Lf)}static \u0275fac=function(n){return new(n||e)};static \u0275prov=Je({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),jo=class{_renderer;_ngZone;element;_cleanupClick;_cleanupTransitionEnd;_fallbackTimeout;constructor(r,t,n,a){this._renderer=t,this._ngZone=n,this.element=r.createElement("div"),this.element.classList.add("cdk-overlay-backdrop"),this._cleanupClick=t.listen(this.element,"click",a)}detach(){this._ngZone.runOutsideAngular(()=>{let r=this.element;clearTimeout(this._fallbackTimeout),this._cleanupTransitionEnd?.(),this._cleanupTransitionEnd=this._renderer.listen(r,"transitionend",this.dispose),this._fallbackTimeout=setTimeout(this.dispose,500),r.style.pointerEvents="none",r.classList.remove("cdk-overlay-backdrop-showing")})}dispose=()=>{clearTimeout(this._fallbackTimeout),this._cleanupClick?.(),this._cleanupTransitionEnd?.(),this._cleanupClick=this._cleanupTransitionEnd=this._fallbackTimeout=void 0,this.element.remove()}},Cs=class{_portalOutlet;_host;_pane;_config;_ngZone;_keyboardDispatcher;_document;_location;_outsideClickDispatcher;_animationsDisabled;_injector;_renderer;_backdropClick=new ur;_attachments=new ur;_detachments=new ur;_positionStrategy;_scrollStrategy;_locationChanges=oi.EMPTY;_backdropRef=null;_detachContentMutationObserver;_detachContentAfterRenderRef;_previousHostParent;_keydownEvents=new ur;_outsidePointerEvents=new ur;_afterNextRenderRef;constructor(r,t,n,a,i,s,o,c,l,f=!1,d,h){this._portalOutlet=r,this._host=t,this._pane=n,this._config=a,this._ngZone=i,this._keyboardDispatcher=s,this._document=o,this._location=c,this._outsideClickDispatcher=l,this._animationsDisabled=f,this._injector=d,this._renderer=h,a.scrollStrategy&&(this._scrollStrategy=a.scrollStrategy,this._scrollStrategy.attach(this)),this._positionStrategy=a.positionStrategy}get overlayElement(){return this._pane}get backdropElement(){return this._backdropRef?.element||null}get hostElement(){return this._host}attach(r){!this._host.parentElement&&this._previousHostParent&&this._previousHostParent.appendChild(this._host);let t=this._portalOutlet.attach(r);return this._positionStrategy&&this._positionStrategy.attach(this),this._updateStackingOrder(),this._updateElementSize(),this._updateElementDirection(),this._scrollStrategy&&this._scrollStrategy.enable(),this._afterNextRenderRef?.destroy(),this._afterNextRenderRef=li(()=>{this.hasAttached()&&this.updatePosition()},{injector:this._injector}),this._togglePointerEvents(!0),this._config.hasBackdrop&&this._attachBackdrop(),this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!0),this._attachments.next(),this._completeDetachContent(),this._keyboardDispatcher.add(this),this._config.disposeOnNavigation&&(this._locationChanges=this._location.subscribe(()=>this.dispose())),this._outsideClickDispatcher.add(this),typeof t?.onDestroy=="function"&&t.onDestroy(()=>{this.hasAttached()&&this._ngZone.runOutsideAngular(()=>Promise.resolve().then(()=>this.detach()))}),t}detach(){if(!this.hasAttached())return;this.detachBackdrop(),this._togglePointerEvents(!1),this._positionStrategy&&this._positionStrategy.detach&&this._positionStrategy.detach(),this._scrollStrategy&&this._scrollStrategy.disable();let r=this._portalOutlet.detach();return this._detachments.next(),this._completeDetachContent(),this._keyboardDispatcher.remove(this),this._detachContentWhenEmpty(),this._locationChanges.unsubscribe(),this._outsideClickDispatcher.remove(this),r}dispose(){let r=this.hasAttached();this._positionStrategy&&this._positionStrategy.dispose(),this._disposeScrollStrategy(),this._backdropRef?.dispose(),this._locationChanges.unsubscribe(),this._keyboardDispatcher.remove(this),this._portalOutlet.dispose(),this._attachments.complete(),this._backdropClick.complete(),this._keydownEvents.complete(),this._outsidePointerEvents.complete(),this._outsideClickDispatcher.remove(this),this._host?.remove(),this._afterNextRenderRef?.destroy(),this._previousHostParent=this._pane=this._host=this._backdropRef=null,r&&this._detachments.next(),this._detachments.complete(),this._completeDetachContent()}hasAttached(){return this._portalOutlet.hasAttached()}backdropClick(){return this._backdropClick}attachments(){return this._attachments}detachments(){return this._detachments}keydownEvents(){return this._keydownEvents}outsidePointerEvents(){return this._outsidePointerEvents}getConfig(){return this._config}updatePosition(){this._positionStrategy&&this._positionStrategy.apply()}updatePositionStrategy(r){r!==this._positionStrategy&&(this._positionStrategy&&this._positionStrategy.dispose(),this._positionStrategy=r,this.hasAttached()&&(r.attach(this),this.updatePosition()))}updateSize(r){this._config=Ae(Ae({},this._config),r),this._updateElementSize()}setDirection(r){this._config=Qe(Ae({},this._config),{direction:r}),this._updateElementDirection()}addPanelClass(r){this._pane&&this._toggleClasses(this._pane,r,!0)}removePanelClass(r){this._pane&&this._toggleClasses(this._pane,r,!1)}getDirection(){let r=this._config.direction;return r?typeof r=="string"?r:r.value:"ltr"}updateScrollStrategy(r){r!==this._scrollStrategy&&(this._disposeScrollStrategy(),this._scrollStrategy=r,this.hasAttached()&&(r.attach(this),r.enable()))}_updateElementDirection(){this._host.setAttribute("dir",this.getDirection())}_updateElementSize(){if(!this._pane)return;let r=this._pane.style;r.width=Tt(this._config.width),r.height=Tt(this._config.height),r.minWidth=Tt(this._config.minWidth),r.minHeight=Tt(this._config.minHeight),r.maxWidth=Tt(this._config.maxWidth),r.maxHeight=Tt(this._config.maxHeight)}_togglePointerEvents(r){this._pane.style.pointerEvents=r?"":"none"}_attachBackdrop(){let r="cdk-overlay-backdrop-showing";this._backdropRef?.dispose(),this._backdropRef=new jo(this._document,this._renderer,this._ngZone,t=>{this._backdropClick.next(t)}),this._animationsDisabled&&this._backdropRef.element.classList.add("cdk-overlay-backdrop-noop-animation"),this._config.backdropClass&&this._toggleClasses(this._backdropRef.element,this._config.backdropClass,!0),this._host.parentElement.insertBefore(this._backdropRef.element,this._host),!this._animationsDisabled&&typeof requestAnimationFrame<"u"?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>this._backdropRef?.element.classList.add(r))}):this._backdropRef.element.classList.add(r)}_updateStackingOrder(){this._host.nextSibling&&this._host.parentNode.appendChild(this._host)}detachBackdrop(){this._animationsDisabled?(this._backdropRef?.dispose(),this._backdropRef=null):this._backdropRef?.detach()}_toggleClasses(r,t,n){let a=Uo(t||[]).filter(i=>!!i);a.length&&(n?r.classList.add(...a):r.classList.remove(...a))}_detachContentWhenEmpty(){let r=!1;try{this._detachContentAfterRenderRef=li(()=>{r=!0,this._detachContent()},{injector:this._injector})}catch(t){if(r)throw t;this._detachContent()}globalThis.MutationObserver&&this._pane&&(this._detachContentMutationObserver||=new globalThis.MutationObserver(()=>{this._detachContent()}),this._detachContentMutationObserver.observe(this._pane,{childList:!0}))}_detachContent(){(!this._pane||!this._host||this._pane.children.length===0)&&(this._pane&&this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!1),this._host&&this._host.parentElement&&(this._previousHostParent=this._host.parentElement,this._host.remove()),this._completeDetachContent())}_completeDetachContent(){this._detachContentAfterRenderRef?.destroy(),this._detachContentAfterRenderRef=void 0,this._detachContentMutationObserver?.disconnect()}_disposeScrollStrategy(){let r=this._scrollStrategy;r?.disable(),r?.detach?.()}},bf="cdk-overlay-connected-position-bounding-box",L2=/([A-Za-z%]+)$/;function Wf(e,r){return new Ts(r,e.get(ri),e.get(Br),e.get(jn),e.get(Uf))}var Ts=class{_viewportRuler;_document;_platform;_overlayContainer;_overlayRef;_isInitialRender;_lastBoundingBoxSize={width:0,height:0};_isPushed=!1;_canPush=!0;_growAfterOpen=!1;_hasFlexibleDimensions=!0;_positionLocked=!1;_originRect;_overlayRect;_viewportRect;_containerRect;_viewportMargin=0;_scrollables=[];_preferredPositions=[];_origin;_pane;_isDisposed;_boundingBox;_lastPosition;_lastScrollVisibility;_positionChanges=new ur;_resizeSubscription=oi.EMPTY;_offsetX=0;_offsetY=0;_transformOriginSelector;_appliedPanelClasses=[];_previousPushAmount;positionChanges=this._positionChanges;get positions(){return this._preferredPositions}constructor(r,t,n,a,i){this._viewportRuler=t,this._document=n,this._platform=a,this._overlayContainer=i,this.setOrigin(r)}attach(r){this._overlayRef&&this._overlayRef,this._validatePositions(),r.hostElement.classList.add(bf),this._overlayRef=r,this._boundingBox=r.hostElement,this._pane=r.overlayElement,this._isDisposed=!1,this._isInitialRender=!0,this._lastPosition=null,this._resizeSubscription.unsubscribe(),this._resizeSubscription=this._viewportRuler.change().subscribe(()=>{this._isInitialRender=!0,this.apply()})}apply(){if(this._isDisposed||!this._platform.isBrowser)return;if(!this._isInitialRender&&this._positionLocked&&this._lastPosition){this.reapplyLastPosition();return}this._clearPanelClasses(),this._resetOverlayElementStyles(),this._resetBoundingBoxStyles(),this._viewportRect=this._getNarrowedViewportRect(),this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();let r=this._originRect,t=this._overlayRect,n=this._viewportRect,a=this._containerRect,i=[],s;for(let o of this._preferredPositions){let c=this._getOriginPoint(r,a,o),l=this._getOverlayPoint(c,t,o),f=this._getOverlayFit(l,t,n,o);if(f.isCompletelyWithinViewport){this._isPushed=!1,this._applyPosition(o,c);return}if(this._canFitWithFlexibleDimensions(f,l,n)){i.push({position:o,origin:c,overlayRect:t,boundingBoxRect:this._calculateBoundingBoxRect(c,o)});continue}(!s||s.overlayFit.visibleArea<f.visibleArea)&&(s={overlayFit:f,overlayPoint:l,originPoint:c,position:o,overlayRect:t})}if(i.length){let o=null,c=-1;for(let l of i){let f=l.boundingBoxRect.width*l.boundingBoxRect.height*(l.position.weight||1);f>c&&(c=f,o=l)}this._isPushed=!1,this._applyPosition(o.position,o.origin);return}if(this._canPush){this._isPushed=!0,this._applyPosition(s.position,s.originPoint);return}this._applyPosition(s.position,s.originPoint)}detach(){this._clearPanelClasses(),this._lastPosition=null,this._previousPushAmount=null,this._resizeSubscription.unsubscribe()}dispose(){this._isDisposed||(this._boundingBox&&Yn(this._boundingBox.style,{top:"",left:"",right:"",bottom:"",height:"",width:"",alignItems:"",justifyContent:""}),this._pane&&this._resetOverlayElementStyles(),this._overlayRef&&this._overlayRef.hostElement.classList.remove(bf),this.detach(),this._positionChanges.complete(),this._overlayRef=this._boundingBox=null,this._isDisposed=!0)}reapplyLastPosition(){if(this._isDisposed||!this._platform.isBrowser)return;let r=this._lastPosition;if(r){this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._viewportRect=this._getNarrowedViewportRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();let t=this._getOriginPoint(this._originRect,this._containerRect,r);this._applyPosition(r,t)}else this.apply()}withScrollableContainers(r){return this._scrollables=r,this}withPositions(r){return this._preferredPositions=r,r.indexOf(this._lastPosition)===-1&&(this._lastPosition=null),this._validatePositions(),this}withViewportMargin(r){return this._viewportMargin=r,this}withFlexibleDimensions(r=!0){return this._hasFlexibleDimensions=r,this}withGrowAfterOpen(r=!0){return this._growAfterOpen=r,this}withPush(r=!0){return this._canPush=r,this}withLockedPosition(r=!0){return this._positionLocked=r,this}setOrigin(r){return this._origin=r,this}withDefaultOffsetX(r){return this._offsetX=r,this}withDefaultOffsetY(r){return this._offsetY=r,this}withTransformOriginOn(r){return this._transformOriginSelector=r,this}_getOriginPoint(r,t,n){let a;if(n.originX=="center")a=r.left+r.width/2;else{let s=this._isRtl()?r.right:r.left,o=this._isRtl()?r.left:r.right;a=n.originX=="start"?s:o}t.left<0&&(a-=t.left);let i;return n.originY=="center"?i=r.top+r.height/2:i=n.originY=="top"?r.top:r.bottom,t.top<0&&(i-=t.top),{x:a,y:i}}_getOverlayPoint(r,t,n){let a;n.overlayX=="center"?a=-t.width/2:n.overlayX==="start"?a=this._isRtl()?-t.width:0:a=this._isRtl()?0:-t.width;let i;return n.overlayY=="center"?i=-t.height/2:i=n.overlayY=="top"?0:-t.height,{x:r.x+a,y:r.y+i}}_getOverlayFit(r,t,n,a){let i=Af(t),{x:s,y:o}=r,c=this._getOffset(a,"x"),l=this._getOffset(a,"y");c&&(s+=c),l&&(o+=l);let f=0-s,d=s+i.width-n.width,h=0-o,u=o+i.height-n.height,x=this._subtractOverflows(i.width,f,d),g=this._subtractOverflows(i.height,h,u),p=x*g;return{visibleArea:p,isCompletelyWithinViewport:i.width*i.height===p,fitsInViewportVertically:g===i.height,fitsInViewportHorizontally:x==i.width}}_canFitWithFlexibleDimensions(r,t,n){if(this._hasFlexibleDimensions){let a=n.bottom-t.y,i=n.right-t.x,s=Ff(this._overlayRef.getConfig().minHeight),o=Ff(this._overlayRef.getConfig().minWidth),c=r.fitsInViewportVertically||s!=null&&s<=a,l=r.fitsInViewportHorizontally||o!=null&&o<=i;return c&&l}return!1}_pushOverlayOnScreen(r,t,n){if(this._previousPushAmount&&this._positionLocked)return{x:r.x+this._previousPushAmount.x,y:r.y+this._previousPushAmount.y};let a=Af(t),i=this._viewportRect,s=Math.max(r.x+a.width-i.width,0),o=Math.max(r.y+a.height-i.height,0),c=Math.max(i.top-n.top-r.y,0),l=Math.max(i.left-n.left-r.x,0),f=0,d=0;return a.width<=i.width?f=l||-s:f=r.x<this._viewportMargin?i.left-n.left-r.x:0,a.height<=i.height?d=c||-o:d=r.y<this._viewportMargin?i.top-n.top-r.y:0,this._previousPushAmount={x:f,y:d},{x:r.x+f,y:r.y+d}}_applyPosition(r,t){if(this._setTransformOrigin(r),this._setOverlayElementStyles(t,r),this._setBoundingBoxStyles(t,r),r.panelClass&&this._addPanelClasses(r.panelClass),this._positionChanges.observers.length){let n=this._getScrollVisibility();if(r!==this._lastPosition||!this._lastScrollVisibility||!U2(this._lastScrollVisibility,n)){let a=new Es(r,n);this._positionChanges.next(a)}this._lastScrollVisibility=n}this._lastPosition=r,this._isInitialRender=!1}_setTransformOrigin(r){if(!this._transformOriginSelector)return;let t=this._boundingBox.querySelectorAll(this._transformOriginSelector),n,a=r.overlayY;r.overlayX==="center"?n="center":this._isRtl()?n=r.overlayX==="start"?"right":"left":n=r.overlayX==="start"?"left":"right";for(let i=0;i<t.length;i++)t[i].style.transformOrigin=`${n} ${a}`}_calculateBoundingBoxRect(r,t){let n=this._viewportRect,a=this._isRtl(),i,s,o;if(t.overlayY==="top")s=r.y,i=n.height-s+this._viewportMargin;else if(t.overlayY==="bottom")o=n.height-r.y+this._viewportMargin*2,i=n.height-o+this._viewportMargin;else{let u=Math.min(n.bottom-r.y+n.top,r.y),x=this._lastBoundingBoxSize.height;i=u*2,s=r.y-u,i>x&&!this._isInitialRender&&!this._growAfterOpen&&(s=r.y-x/2)}let c=t.overlayX==="start"&&!a||t.overlayX==="end"&&a,l=t.overlayX==="end"&&!a||t.overlayX==="start"&&a,f,d,h;if(l)h=n.width-r.x+this._viewportMargin*2,f=r.x-this._viewportMargin;else if(c)d=r.x,f=n.right-r.x;else{let u=Math.min(n.right-r.x+n.left,r.x),x=this._lastBoundingBoxSize.width;f=u*2,d=r.x-u,f>x&&!this._isInitialRender&&!this._growAfterOpen&&(d=r.x-x/2)}return{top:s,left:d,bottom:o,right:h,width:f,height:i}}_setBoundingBoxStyles(r,t){let n=this._calculateBoundingBoxRect(r,t);!this._isInitialRender&&!this._growAfterOpen&&(n.height=Math.min(n.height,this._lastBoundingBoxSize.height),n.width=Math.min(n.width,this._lastBoundingBoxSize.width));let a={};if(this._hasExactPosition())a.top=a.left="0",a.bottom=a.right=a.maxHeight=a.maxWidth="",a.width=a.height="100%";else{let i=this._overlayRef.getConfig().maxHeight,s=this._overlayRef.getConfig().maxWidth;a.height=Tt(n.height),a.top=Tt(n.top),a.bottom=Tt(n.bottom),a.width=Tt(n.width),a.left=Tt(n.left),a.right=Tt(n.right),t.overlayX==="center"?a.alignItems="center":a.alignItems=t.overlayX==="end"?"flex-end":"flex-start",t.overlayY==="center"?a.justifyContent="center":a.justifyContent=t.overlayY==="bottom"?"flex-end":"flex-start",i&&(a.maxHeight=Tt(i)),s&&(a.maxWidth=Tt(s))}this._lastBoundingBoxSize=n,Yn(this._boundingBox.style,a)}_resetBoundingBoxStyles(){Yn(this._boundingBox.style,{top:"0",left:"0",right:"0",bottom:"0",height:"",width:"",alignItems:"",justifyContent:""})}_resetOverlayElementStyles(){Yn(this._pane.style,{top:"",left:"",bottom:"",right:"",position:"",transform:""})}_setOverlayElementStyles(r,t){let n={},a=this._hasExactPosition(),i=this._hasFlexibleDimensions,s=this._overlayRef.getConfig();if(a){let f=this._viewportRuler.getViewportScrollPosition();Yn(n,this._getExactOverlayY(t,r,f)),Yn(n,this._getExactOverlayX(t,r,f))}else n.position="static";let o="",c=this._getOffset(t,"x"),l=this._getOffset(t,"y");c&&(o+=`translateX(${c}px) `),l&&(o+=`translateY(${l}px)`),n.transform=o.trim(),s.maxHeight&&(a?n.maxHeight=Tt(s.maxHeight):i&&(n.maxHeight="")),s.maxWidth&&(a?n.maxWidth=Tt(s.maxWidth):i&&(n.maxWidth="")),Yn(this._pane.style,n)}_getExactOverlayY(r,t,n){let a={top:"",bottom:""},i=this._getOverlayPoint(t,this._overlayRect,r);if(this._isPushed&&(i=this._pushOverlayOnScreen(i,this._overlayRect,n)),r.overlayY==="bottom"){let s=this._document.documentElement.clientHeight;a.bottom=`${s-(i.y+this._overlayRect.height)}px`}else a.top=Tt(i.y);return a}_getExactOverlayX(r,t,n){let a={left:"",right:""},i=this._getOverlayPoint(t,this._overlayRect,r);this._isPushed&&(i=this._pushOverlayOnScreen(i,this._overlayRect,n));let s;if(this._isRtl()?s=r.overlayX==="end"?"left":"right":s=r.overlayX==="end"?"right":"left",s==="right"){let o=this._document.documentElement.clientWidth;a.right=`${o-(i.x+this._overlayRect.width)}px`}else a.left=Tt(i.x);return a}_getScrollVisibility(){let r=this._getOriginRect(),t=this._pane.getBoundingClientRect(),n=this._scrollables.map(a=>a.getElementRef().nativeElement.getBoundingClientRect());return{isOriginClipped:Cf(r,n),isOriginOutsideView:Go(r,n),isOverlayClipped:Cf(t,n),isOverlayOutsideView:Go(t,n)}}_subtractOverflows(r,...t){return t.reduce((n,a)=>n-Math.max(a,0),r)}_getNarrowedViewportRect(){let r=this._document.documentElement.clientWidth,t=this._document.documentElement.clientHeight,n=this._viewportRuler.getViewportScrollPosition();return{top:n.top+this._viewportMargin,left:n.left+this._viewportMargin,right:n.left+r-this._viewportMargin,bottom:n.top+t-this._viewportMargin,width:r-2*this._viewportMargin,height:t-2*this._viewportMargin}}_isRtl(){return this._overlayRef.getDirection()==="rtl"}_hasExactPosition(){return!this._hasFlexibleDimensions||this._isPushed}_getOffset(r,t){return t==="x"?r.offsetX==null?this._offsetX:r.offsetX:r.offsetY==null?this._offsetY:r.offsetY}_validatePositions(){}_addPanelClasses(r){this._pane&&Uo(r).forEach(t=>{t!==""&&this._appliedPanelClasses.indexOf(t)===-1&&(this._appliedPanelClasses.push(t),this._pane.classList.add(t))})}_clearPanelClasses(){this._pane&&(this._appliedPanelClasses.forEach(r=>{this._pane.classList.remove(r)}),this._appliedPanelClasses=[])}_getOriginRect(){let r=this._origin;if(r instanceof Fn)return r.nativeElement.getBoundingClientRect();if(r instanceof Element)return r.getBoundingClientRect();let t=r.width||0,n=r.height||0;return{top:r.y,bottom:r.y+n,left:r.x,right:r.x+t,height:n,width:t}}};function Yn(e,r){for(let t in r)r.hasOwnProperty(t)&&(e[t]=r[t]);return e}function Ff(e){if(typeof e!="number"&&e!=null){let[r,t]=e.split(L2);return!t||t==="px"?parseFloat(r):null}return e||null}function Af(e){return{top:Math.floor(e.top),right:Math.floor(e.right),bottom:Math.floor(e.bottom),left:Math.floor(e.left),width:Math.floor(e.width),height:Math.floor(e.height)}}function U2(e,r){return e===r?!0:e.isOriginClipped===r.isOriginClipped&&e.isOriginOutsideView===r.isOriginOutsideView&&e.isOverlayClipped===r.isOverlayClipped&&e.isOverlayOutsideView===r.isOverlayOutsideView}var Df="cdk-global-overlay-wrapper";function Vf(e){return new bs}var bs=class{_overlayRef;_cssPosition="static";_topOffset="";_bottomOffset="";_alignItems="";_xPosition="";_xOffset="";_width="";_height="";_isDisposed=!1;attach(r){let t=r.getConfig();this._overlayRef=r,this._width&&!t.width&&r.updateSize({width:this._width}),this._height&&!t.height&&r.updateSize({height:this._height}),r.hostElement.classList.add(Df),this._isDisposed=!1}top(r=""){return this._bottomOffset="",this._topOffset=r,this._alignItems="flex-start",this}left(r=""){return this._xOffset=r,this._xPosition="left",this}bottom(r=""){return this._topOffset="",this._bottomOffset=r,this._alignItems="flex-end",this}right(r=""){return this._xOffset=r,this._xPosition="right",this}start(r=""){return this._xOffset=r,this._xPosition="start",this}end(r=""){return this._xOffset=r,this._xPosition="end",this}width(r=""){return this._overlayRef?this._overlayRef.updateSize({width:r}):this._width=r,this}height(r=""){return this._overlayRef?this._overlayRef.updateSize({height:r}):this._height=r,this}centerHorizontally(r=""){return this.left(r),this._xPosition="center",this}centerVertically(r=""){return this.top(r),this._alignItems="center",this}apply(){if(!this._overlayRef||!this._overlayRef.hasAttached())return;let r=this._overlayRef.overlayElement.style,t=this._overlayRef.hostElement.style,n=this._overlayRef.getConfig(),{width:a,height:i,maxWidth:s,maxHeight:o}=n,c=(a==="100%"||a==="100vw")&&(!s||s==="100%"||s==="100vw"),l=(i==="100%"||i==="100vh")&&(!o||o==="100%"||o==="100vh"),f=this._xPosition,d=this._xOffset,h=this._overlayRef.getConfig().direction==="rtl",u="",x="",g="";c?g="flex-start":f==="center"?(g="center",h?x=d:u=d):h?f==="left"||f==="end"?(g="flex-end",u=d):(f==="right"||f==="start")&&(g="flex-start",x=d):f==="left"||f==="start"?(g="flex-start",u=d):(f==="right"||f==="end")&&(g="flex-end",x=d),r.position=this._cssPosition,r.marginLeft=c?"0":u,r.marginTop=l?"0":this._topOffset,r.marginBottom=this._bottomOffset,r.marginRight=c?"0":x,t.justifyContent=g,t.alignItems=l?"flex-start":this._alignItems}dispose(){if(this._isDisposed||!this._overlayRef)return;let r=this._overlayRef.overlayElement.style,t=this._overlayRef.hostElement,n=t.style;t.classList.remove(Df),n.justifyContent=n.alignItems=r.marginTop=r.marginBottom=r.marginLeft=r.marginRight=r.position="",this._overlayRef=null,this._isDisposed=!0}},Hf=(()=>{class e{_injector=ce(gr);constructor(){}global(){return Vf()}flexibleConnectedTo(t){return Wf(this._injector,t)}static \u0275fac=function(n){return new(n||e)};static \u0275prov=Je({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function zf(e,r){e.get(Lo).load(Lf);let t=e.get(Uf),n=e.get(Br),a=e.get(kf),i=e.get(un),s=e.get(wf),o=n.createElement("div"),c=n.createElement("div");c.id=a.getId("cdk-overlay-"),c.classList.add("cdk-overlay-pane"),o.appendChild(c),t.getContainerElement().appendChild(o);let l=new vs(c,i,e),f=new ks(r),d=e.get(Ns,null,{optional:!0})||e.get(An).createRenderer(null,null);return f.direction=f.direction||s.value,new Cs(l,o,c,f,e.get(Lr),e.get(Mf),n,e.get(p0),e.get(Bf),r?.disableAnimations??e.get(n0,null,{optional:!0})==="NoopAnimations",e.get(Qn),d)}var $o=(()=>{class e{scrollStrategies=ce(Nf);_positionBuilder=ce(Hf);_injector=ce(gr);constructor(){}create(t){return zf(this._injector,t)}position(){return this._positionBuilder}static \u0275fac=function(n){return new(n||e)};static \u0275prov=Je({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var Fs=class e{dbName=ce(k0);async export(r){return new Promise((t,n)=>{let a=indexedDB.open(this.dbName);a.onerror=()=>n(a.error),a.onsuccess=()=>{let i=a.result,s=i.transaction(i.objectStoreNames,"readonly"),o={},c=0;for(let l of i.objectStoreNames){let d=s.objectStore(l).openCursor();o[l]=[],d.onerror=()=>n(d.error),d.onsuccess=()=>{let h=d.result;if(h)o[l].push({key:h.key,value:h.value}),h.continue();else if(c++,c===i.objectStoreNames.length){let u=new Blob([JSON.stringify(o)],{type:"application/json"}),x=new File([u],r,{type:"application/json"});t(x)}}}}})}async import(r){let t=await r.text(),n=JSON.parse(t);return new Promise((a,i)=>{let s=indexedDB.open(this.dbName);s.onerror=()=>i(s.error),s.onsuccess=()=>{let o=s.result,c=o.transaction(o.objectStoreNames,"readwrite");for(let l of Object.keys(n)){if(!o.objectStoreNames.contains(l)){console.warn(`Skipping unknown store: ${l}`);continue}let f=c.objectStore(l);for(let{key:d,value:h}of n[l])f.put(h,d)}c.oncomplete=()=>a(),c.onerror=()=>i(c.error)}})}static \u0275fac=function(t){return new(t||e)};static \u0275prov=Je({token:e,factory:e.\u0275fac,providedIn:"root"})};var W2=()=>["/"];function V2(e,r){if(e&1){let t=gt();M(0,"div",10)(1,"button",11),Se("click",function(){pe(t);let a=ka(6),i=Q();return me(i.load(a))}),dt(2,"span",12),M(3,"span"),Y(4,"Load..."),L()(),dt(5,"input",13,2),M(7,"button",11),Se("click",function(){pe(t);let a=ka(12),i=Q();return me(i.save(a))}),dt(8,"span",14),M(9,"span"),Y(10,"Save..."),L()(),dt(11,"a",15,3),L()}}var As=class e{titleService=ce(gs);overlay=ce($o);vcr=ce(Sa);menuRef=Ie(void 0);importExportDataService=ce(Fs);busService=ce(aa);window=ce(Window);toggleImportExportMenu(r,t){if(this.menuRef())this.closeMenu();else{let n=this.overlay.position().flexibleConnectedTo(t).withPositions([{originX:"end",originY:"bottom",overlayX:"end",overlayY:"top"}]),a=this.overlay.create({positionStrategy:n,hasBackdrop:!0});a.backdropClick().subscribe(()=>this.closeMenu()),a.attach(new ga(r,this.vcr)),this.menuRef.set(a)}}closeMenu(){this.menuRef()?.dispose(),this.menuRef.set(void 0)}async load(r){let t=await new Promise((n,a)=>{r.addEventListener("input",i=>r.files?.length?n(r.files[0]):a()),r.click()});this.closeMenu(),await this.importExportDataService.import(t),this.window.location.reload()}async save(r){let t=this.busService.buses()[0],n=t?`bus-${t.number}`:"better-bus",i=await this.importExportDataService.export(n+".buspak"),s=URL.createObjectURL(i);r.href=s,r.download=i.name,r.click(),this.closeMenu()}static \u0275fac=function(t){return new(t||e)};static \u0275cmp=Ke({type:e,selectors:[["app-root"]],decls:14,vars:3,consts:[["menuTarget",""],["menu",""],["input",""],["output",""],[1,"screen-only","app-navbar"],[1,"app-name",3,"routerLink"],["src","icon.png",1,"icon"],[1,"page-title"],[1,"subtle",3,"click"],[1,"fas","fa-ellipsis-vertical"],[1,"menu"],[3,"click"],[1,"fas","fa-folder"],["type","file",1,"hidden"],[1,"fas","fa-save"],[1,"hidden"]],template:function(t,n){if(t&1){let a=gt();M(0,"nav",4)(1,"a",5),dt(2,"img",6),M(3,"span"),Y(4,"BetterBus"),L()(),M(5,"span",7),Y(6),L(),M(7,"button",8,0),Se("click",function(){pe(a);let s=ka(8),o=ka(13);return me(n.toggleImportExportMenu(o,s))}),dt(9,"span",9),L()(),M(10,"section"),dt(11,"router-outlet"),L(),i0(12,V2,13,0,"ng-template",null,1,u0)}t&2&&(G(),We("routerLink",Bt(2,W2)),G(5),vt(n.titleService.title()))},dependencies:[gi,Lt],styles:[".app-navbar[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:space-between;gap:1rem;background:#e5e7eb;padding:.5rem 2rem;box-shadow:0 2px 8px #0000001a}.app-name[_ngcontent-%COMP%]{color:#000;display:flex;flex-direction:row;align-items:center;gap:.5rem;text-decoration:none;font-weight:700;font-size:1.5rem;border-radius:8px}.app-name[_ngcontent-%COMP%]:visited{color:#000}.icon[_ngcontent-%COMP%]{width:2rem;height:2rem}.page-title[_ngcontent-%COMP%]{flex:1;text-align:center;font-size:1.4rem;font-weight:600;color:#222;letter-spacing:.02em}.hide[_ngcontent-%COMP%]{visibility:hidden}.hide.show[_ngcontent-%COMP%]{visibility:visible}button.subtle[_ngcontent-%COMP%]{background-color:transparent;color:#000}button.subtle[_ngcontent-%COMP%]:hover{background-color:#aaa;opacity:.5}.menu[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:flex;gap:.5rem}.menu[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.125rem}.hidden[_ngcontent-%COMP%]{display:none}"]})};g0(As,gf).catch(e=>console.error(e));
